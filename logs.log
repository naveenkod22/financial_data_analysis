updated script; time
News, Blogs, Calendar, Insider Trades; 2023-03-10 09:59:03.206574
All Signal Screener; 2023-03-10 10:12:29.105443
News, Blogs, Calendar, Insider Trades; 2023-03-10 10:59:03.144360
News, Blogs, Calendar, Insider Trades; 2023-03-10 11:59:03.127075
All Signal Screener; 2023-03-10 12:14:03.310432
News, Blogs, Calendar, Insider Trades; 2023-03-10 12:59:04.626580
News, Blogs, Calendar, Insider Trades; 2023-03-10 13:59:02.416626
All Signal Screener; 2023-03-10 14:12:45.060087
News, Blogs, Calendar, Insider Trades; 2023-03-10 14:59:02.624858
News, Blogs, Calendar, Insider Trades; 2023-03-10 15:59:03.571490
All Signal Screener; 2023-03-10 16:13:39.664220
News, Blogs, Calendar, Insider Trades; 2023-03-10 16:59:02.883649
News, Blogs, Calendar, Insider Trades; 2023-03-10 17:59:04.475549
All Signal Screener; 2023-03-10 18:13:48.552205
News, Blogs, Calendar, Insider Trades; 2023-03-10 18:59:03.394902
News, Blogs, Calendar, Insider Trades; 2023-03-10 19:59:03.198746
All Signal Screener; 2023-03-10 20:16:35.308183
Ticker Data; 2023-03-10 20:40:32.430028
News, Blogs, Calendar, Insider Trades; 2023-03-10 20:59:03.279895
News, Blogs, Calendar, Insider Trades; 2023-03-10 21:59:03.544560
All Signal Screener; 2023-03-10 22:16:36.014502
News, Blogs, Calendar, Insider Trades; 2023-03-10 22:59:03.013591
News, Blogs, Calendar, Insider Trades; 2023-03-10 23:59:03.338907
All Signal Screener; 2023-03-11 00:17:11.290161
News, Blogs, Calendar, Insider Trades; 2023-03-11 00:59:03.580917
News, Blogs, Calendar, Insider Trades; 2023-03-11 01:59:03.430248
All Signal Screener; 2023-03-11 02:13:23.184336
News, Blogs, Calendar, Insider Trades; 2023-03-11 02:59:02.747318
News, Blogs, Calendar, Insider Trades; 2023-03-11 03:59:03.357477
All Signal Screener; 2023-03-11 04:13:11.721457
News, Blogs, Calendar, Insider Trades; 2023-03-11 04:59:03.362123
News, Blogs, Calendar, Insider Trades; 2023-03-11 05:59:03.004631
All Signal Screener; 2023-03-11 06:13:14.300415
News, Blogs, Calendar, Insider Trades; 2023-03-11 06:59:03.206771
News, Blogs, Calendar, Insider Trades; 2023-03-11 07:59:02.769433
All Signal Screener; 2023-03-11 08:12:49.014391
News, Blogs, Calendar, Insider Trades; 2023-03-11 08:59:02.948921
News, Blogs, Calendar, Insider Trades; 2023-03-11 09:59:04.543701
All Signal Screener; 2023-03-11 10:13:33.072619
News, Blogs, Calendar, Insider Trades; 2023-03-11 10:59:03.114705
News, Blogs, Calendar, Insider Trades; 2023-03-11 11:59:02.746536
All Signal Screener; 2023-03-11 12:13:15.976378
News, Blogs, Calendar, Insider Trades; 2023-03-11 12:59:03.064601
News, Blogs, Calendar, Insider Trades; 2023-03-11 13:59:02.781248
All Signal Screener; 2023-03-11 14:13:05.074254
News, Blogs, Calendar, Insider Trades; 2023-03-11 14:59:02.554602
News, Blogs, Calendar, Insider Trades; 2023-03-11 15:59:03.274939
All Signal Screener; 2023-03-11 16:13:16.981583
News, Blogs, Calendar, Insider Trades; 2023-03-11 16:59:02.707624
News, Blogs, Calendar, Insider Trades; 2023-03-11 17:59:03.263696
All Signal Screener; 2023-03-11 18:12:37.826996
News, Blogs, Calendar, Insider Trades; 2023-03-11 18:59:02.422053
News, Blogs, Calendar, Insider Trades; 2023-03-11 19:59:03.046227
All Signal Screener; 2023-03-11 20:13:03.824723
News, Blogs, Calendar, Insider Trades; 2023-03-11 20:59:02.489936
News, Blogs, Calendar, Insider Trades; 2023-03-11 21:59:03.078733
All Signal Screener; 2023-03-11 22:12:39.209793
News, Blogs, Calendar, Insider Trades; 2023-03-11 22:59:02.769399
News, Blogs, Calendar, Insider Trades; 2023-03-11 23:59:03.633943
All Signal Screener; 2023-03-12 00:12:36.058074
News, Blogs, Calendar, Insider Trades; 2023-03-12 00:59:02.623707
News, Blogs, Calendar, Insider Trades; 2023-03-12 01:59:03.154648
News, Blogs, Calendar, Insider Trades; 2023-03-12 03:59:02.791192
All Signal Screener; 2023-03-12 04:12:30.106600
News, Blogs, Calendar, Insider Trades; 2023-03-12 04:59:03.038702
News, Blogs, Calendar, Insider Trades; 2023-03-12 05:59:02.779082
All Signal Screener; 2023-03-12 06:12:22.368722
News, Blogs, Calendar, Insider Trades; 2023-03-12 06:59:02.930986
News, Blogs, Calendar, Insider Trades; 2023-03-12 07:59:02.494970
All Signal Screener; 2023-03-12 08:12:56.808395
News, Blogs, Calendar, Insider Trades; 2023-03-12 08:59:02.500950
News, Blogs, Calendar, Insider Trades; 2023-03-12 09:59:02.980701
All Signal Screener; 2023-03-12 10:12:32.057644
News, Blogs, Calendar, Insider Trades; 2023-03-12 10:59:02.644950
News, Blogs, Calendar, Insider Trades; 2023-03-12 11:59:03.276892
All Signal Screener; 2023-03-12 12:12:27.891059
News, Blogs, Calendar, Insider Trades; 2023-03-12 12:59:02.549645
News, Blogs, Calendar, Insider Trades; 2023-03-12 13:59:03.062595
All Signal Screener; 2023-03-12 14:12:01.280269
News, Blogs, Calendar, Insider Trades; 2023-03-12 14:59:02.808167
News, Blogs, Calendar, Insider Trades; 2023-03-12 15:59:02.356866
All Signal Screener; 2023-03-12 16:12:43.513446
News, Blogs, Calendar, Insider Trades; 2023-03-12 16:59:03.100644
News, Blogs, Calendar, Insider Trades; 2023-03-12 17:59:03.550787
All Signal Screener; 2023-03-12 18:13:06.493784
News, Blogs, Calendar, Insider Trades; 2023-03-12 18:59:03.168193
News, Blogs, Calendar, Insider Trades; 2023-03-12 19:59:02.774847
All Signal Screener; 2023-03-12 20:12:54.867011
News, Blogs, Calendar, Insider Trades; 2023-03-12 20:59:02.837447
News, Blogs, Calendar, Insider Trades; 2023-03-12 21:59:02.889500
All Signal Screener; 2023-03-12 22:13:37.770365
News, Blogs, Calendar, Insider Trades; 2023-03-12 22:59:02.928189
News, Blogs, Calendar, Insider Trades; 2023-03-12 23:59:03.050083
All Signal Screener; 2023-03-13 00:13:32.289750
News, Blogs, Calendar, Insider Trades; 2023-03-13 00:59:03.252894
News, Blogs, Calendar, Insider Trades; 2023-03-13 01:59:02.955870
All Signal Screener; 2023-03-13 02:12:38.210560
News, Blogs, Calendar, Insider Trades; 2023-03-13 02:59:03.139025
News, Blogs, Calendar, Insider Trades; 2023-03-13 03:59:02.727992
All Signal Screener; 2023-03-13 04:12:19.003497
News, Blogs, Calendar, Insider Trades; 2023-03-13 04:59:02.817790
News, Blogs, Calendar, Insider Trades; 2023-03-13 05:59:02.629373
All Signal Screener; 2023-03-13 06:12:49.958921
News, Blogs, Calendar, Insider Trades; 2023-03-13 06:59:02.580603
News, Blogs, Calendar, Insider Trades; 2023-03-13 07:59:03.219981
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "-"
LINE 1: ..., 20.67,  -26.12, 2.34, 1.77, NULL,  -41.5, NULL, '-',  -10....
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 553, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "-"
LINE 1: ..., 20.67,  -26.12, 2.34, 1.77, NULL,  -41.5, NULL, '-',  -10....
                                                             ^

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'EUDA', 'market_cap': 29290000.0, 'p_e': None, 'price': 2.02, 'change_percentage': 0.542, 'volume': 13873516.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -0.14, 'insider_own_percentage': 13.7, 'shs_outstand': 11070000.0, 'perf_week_percentage': 50.75, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 7070000.0, 'perf_month_percentage': 37.41, 'income': -1500000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 35.3, 'perf_quarter_percentage': -17.89, 'sales': 10100000.0, 'p_s': 2.9, 'eps_this_y_percentage': None, 'inst_trans_percentage': 1.05, 'short_interest': 20000.0, 'perf_half_y_percentage': -79.68, 'book_sh': 7.43, 'p_b': 0.27, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -1.7, 'target_price': None, 'perf_year_percentage': None, 'cash_sh': 0.02, 'p_c': 97.63, 'eps_next_5y_percentage': None, 'roe_percentage': -1.8, 'range_from_52w': 1.05, 'range_to_52w': '10.50', 'perf_ytd_percentage': 22.6, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -80.76, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 17.4, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 92.36, 'atr': '0.45', 'employees': None, 'current_ratio': 17.4, 'sales_q_q_percentage': -14.2, 'oper_margin_percentage': None, 'rsi_14': 59.93, 'volatility_w_percentage': 68.73, 'volatility_m_percentage': 27.13, 'optionable': False, 'debt_eq': 0.01, 'eps_q_q_percentage': 506.0, 'profit_margin_percentage': None, 'rel_volume': '103.96', 'prev_close': '1.31', 'shortable': False, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 358280.0, 'recom': None, 'sma20_percentage': 45.42, 'sma50_percentage': 27.41, 'sma200_percentage': -70.14, 'short_float_percentage': 0.33, 'short_float_ratio': 0.06, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'CZOO', 'market_cap': 76110000.0, 'p_e': None, 'price': 2.62, 'change_percentage': 0.3232, 'volume': 5256822.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -21.63, 'insider_own_percentage': 31.8, 'shs_outstand': 37970000.0, 'perf_week_percentage': 22.43, 'forward_p_e': None, 'eps_next_y': -4.85, 'insider_trans_percentage': 0.0, 'shs_float': 25960000.0, 'perf_month_percentage': -34.53, 'income': -816100000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 39.4, 'perf_quarter_percentage': -44.26, 'sales': 1250000000.0, 'p_s': 0.06, 'eps_this_y_percentage': -474.3, 'inst_trans_percentage': -61.67, 'short_interest': 640000.0, 'perf_half_y_percentage': -81.07, 'book_sh': 16.39, 'p_b': 0.16, 'eps_next_y_percentage_percentage': 52.4, 'roa_percentage': None, 'target_price': 406.64, 'perf_year_percentage': -95.13, 'cash_sh': 16.46, 'p_c': 0.16, 'eps_next_5y_percentage': -1.68, 'roe_percentage': None, 'range_from_52w': 1.93, 'range_to_52w': '65.20', 'perf_ytd_percentage': -16.45, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -31.2, 'high_52w_percentage': -95.98, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 1.6, 'low_52w_percentage': 35.75, 'atr': '0.42', 'employees': 3822.0, 'current_ratio': None, 'sales_q_q_percentage': 153.0, 'oper_margin_percentage': None, 'rsi_14': 45.77, 'volatility_w_percentage': 19.64, 'volatility_m_percentage': 13.83, 'optionable': True, 'debt_eq': 0.55, 'eps_q_q_percentage': -725.1, 'profit_margin_percentage': None, 'rel_volume': '36.62', 'prev_close': '1.98', 'shortable': False, 'lt_debt_eq': 0.12, 'payout_percentage': None, 'avg_volume': 227090.0, 'recom': 3.0, 'sma20_percentage': 1.93, 'sma50_percentage': -27.3, 'sma200_percentage': -73.86, 'short_float_percentage': 2.47, 'short_float_ratio': 2.82, 'earnings_date': datetime.datetime(2023, 1, 18, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'UNCY', 'market_cap': 31090000.0, 'p_e': None, 'price': 2.68, 'change_percentage': 0.301, 'volume': 70240424.0, 'signals': "['Most Active', 'Most Volatile', 'Multiple Bottom', 'New High', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 7, 'eps_ttm': -1.03, 'insider_own_percentage': 0.6, 'shs_outstand': 15060000.0, 'perf_week_percentage': 446.94, 'forward_p_e': None, 'eps_next_y': -1.06, 'insider_trans_percentage': 0.0, 'shs_float': 8840000.0, 'perf_month_percentage': 396.57, 'income': -15500000.0, 'peg': None, 'eps_next_q': -0.24, 'inst_own_percentage': 18.3, 'perf_quarter_percentage': 268.64, 'sales': 1000000.0, 'p_s': 31.09, 'eps_this_y_percentage': -327.7, 'inst_trans_percentage': -8.88, 'short_interest': 150000.0, 'perf_half_y_percentage': 272.22, 'book_sh': 0.31, 'p_b': 8.65, 'eps_next_y_percentage_percentage': 2.8, 'roa_percentage': -107.7, 'target_price': 9.1, 'perf_year_percentage': 95.62, 'cash_sh': 0.6, 'p_c': 4.44, 'eps_next_5y_percentage': None, 'roe_percentage': -139.9, 'range_from_52w': 0.4, 'range_to_52w': '2.24', 'perf_ytd_percentage': 396.3, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 19.64, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.8, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 569.33, 'atr': '0.28', 'employees': 9.0, 'current_ratio': 1.8, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 95.1, 'volatility_w_percentage': 38.09, 'volatility_m_percentage': 16.26, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -0.5, 'profit_margin_percentage': None, 'rel_volume': '15.19', 'prev_close': '2.06', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 5620000.0, 'recom': 2.0, 'sma20_percentage': 265.38, 'sma50_percentage': 334.5, 'sma200_percentage': 274.95, 'short_float_percentage': 1.67, 'short_float_ratio': 0.03, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'CING', 'market_cap': 16710000.0, 'p_e': None, 'price': 1.85, 'change_percentage': 0.25, 'volume': 4377216.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -1.51, 'insider_own_percentage': 2.3, 'shs_outstand': 11310000.0, 'perf_week_percentage': 37.04, 'forward_p_e': None, 'eps_next_y': -0.84, 'insider_trans_percentage': 200.84, 'shs_float': 7500000.0, 'perf_month_percentage': 92.41, 'income': -15700000.0, 'peg': None, 'eps_next_q': -0.32, 'inst_own_percentage': 2.3, 'perf_quarter_percentage': 90.72, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -695.2, 'inst_trans_percentage': -64.72, 'short_interest': 1070000.0, 'perf_half_y_percentage': 24.16, 'book_sh': 0.74, 'p_b': 2.5, 'eps_next_y_percentage_percentage': 12.5, 'roa_percentage': -153.1, 'target_price': 5.88, 'perf_year_percentage': 40.15, 'cash_sh': 1.09, 'p_c': 1.7, 'eps_next_5y_percentage': None, 'roe_percentage': -188.0, 'range_from_52w': 0.66, 'range_to_52w': '2.20', 'perf_ytd_percentage': 85.0, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -15.91, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.8, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 178.61, 'atr': '0.19', 'employees': 16.0, 'current_ratio': 1.8, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 67.69, 'volatility_w_percentage': 16.83, 'volatility_m_percentage': 13.9, 'optionable': False, 'debt_eq': 0.6, 'eps_q_q_percentage': 52.4, 'profit_margin_percentage': None, 'rel_volume': '5.10', 'prev_close': '1.48', 'shortable': False, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 856280.0, 'recom': 2.0, 'sma20_percentage': 41.28, 'sma50_percentage': 66.03, 'sma200_percentage': 51.55, 'short_float_percentage': 14.29, 'short_float_ratio': 1.25, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'EVOK', 'market_cap': 9900000.0, 'p_e': None, 'price': 3.6, 'change_percentage': 0.2121, 'volume': 78489.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -2.72, 'insider_own_percentage': 2.46, 'shs_outstand': 3340000.0, 'perf_week_percentage': 22.87, 'forward_p_e': None, 'eps_next_y': -1.38, 'insider_trans_percentage': 0.0, 'shs_float': 3260000.0, 'perf_month_percentage': -10.22, 'income': -8100000.0, 'peg': None, 'eps_next_q': -0.53, 'inst_own_percentage': 1.9, 'perf_quarter_percentage': 77.34, 'sales': 2100000.0, 'p_s': 4.71, 'eps_this_y_percentage': 48.6, 'inst_trans_percentage': -13.28, 'short_interest': 30000.0, 'perf_half_y_percentage': 50.53, 'book_sh': 1.66, 'p_b': 2.17, 'eps_next_y_percentage_percentage': 46.5, 'roa_percentage': -68.3, 'target_price': 7.0, 'perf_year_percentage': -42.88, 'cash_sh': 4.51, 'p_c': 0.8, 'eps_next_5y_percentage': 40.0, 'roe_percentage': -177.7, 'range_from_52w': 1.37, 'range_to_52w': '16.80', 'perf_ytd_percentage': 34.33, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 25.4, 'roi_percentage': -94.8, 'high_52w_percentage': -78.57, 'beta': 0.42, 'dividend_percentage': None, 'quick_ratio': 6.9, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 84.7, 'low_52w_percentage': 162.45, 'atr': '0.28', 'employees': 4.0, 'current_ratio': 7.1, 'sales_q_q_percentage': -11.1, 'oper_margin_percentage': None, 'rsi_14': 58.85, 'volatility_w_percentage': 8.08, 'volatility_m_percentage': 8.28, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': 17.1, 'profit_margin_percentage': None, 'rel_volume': '2.07', 'prev_close': '2.97', 'shortable': True, 'lt_debt_eq': 0.91, 'payout_percentage': None, 'avg_volume': 38580.0, 'recom': 2.0, 'sma20_percentage': 20.97, 'sma50_percentage': 6.92, 'sma200_percentage': 37.28, 'short_float_percentage': 0.8, 'short_float_ratio': 0.68, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'DTC', 'market_cap': 433490000.0, 'p_e': None, 'price': 5.49, 'change_percentage': 0.2119, 'volume': 3566447.0, 'signals': "['Channel Down', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -0.6, 'insider_own_percentage': 0.4, 'shs_outstand': 63470000.0, 'perf_week_percentage': 31.97, 'forward_p_e': 5.27, 'eps_next_y': 1.04, 'insider_trans_percentage': 1.78, 'shs_float': 63360000.0, 'perf_month_percentage': 22.82, 'income': -48500000.0, 'peg': None, 'eps_next_q': 0.1, 'inst_own_percentage': None, 'perf_quarter_percentage': 28.57, 'sales': 496900000.0, 'p_s': 0.87, 'eps_this_y_percentage': 145.2, 'inst_trans_percentage': -1.2, 'short_interest': 1490000.0, 'perf_half_y_percentage': 22.82, 'book_sh': 5.52, 'p_b': 0.99, 'eps_next_y_percentage_percentage': 18.01, 'roa_percentage': -5.2, 'target_price': 8.83, 'perf_year_percentage': -43.05, 'cash_sh': 0.22, 'p_c': 25.2, 'eps_next_5y_percentage': 7.5, 'roe_percentage': -12.7, 'range_from_52w': 3.39, 'range_to_52w': '10.74', 'perf_ytd_percentage': 47.58, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 13.7, 'high_52w_percentage': -48.88, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 0.9, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 62.8, 'low_52w_percentage': 61.95, 'atr': '0.38', 'employees': 300.0, 'current_ratio': 3.6, 'sales_q_q_percentage': 47.3, 'oper_margin_percentage': -0.3, 'rsi_14': 75.36, 'volatility_w_percentage': 14.91, 'volatility_m_percentage': 6.74, 'optionable': True, 'debt_eq': 0.49, 'eps_q_q_percentage': -384.2, 'profit_margin_percentage': -9.1, 'rel_volume': '14.76', 'prev_close': '4.53', 'shortable': True, 'lt_debt_eq': 0.48, 'payout_percentage': None, 'avg_volume': 294700.0, 'recom': 1.4, 'sma20_percentage': 32.42, 'sma50_percentage': 32.05, 'sma200_percentage': 25.75, 'short_float_percentage': 2.36, 'short_float_ratio': 5.07, 'earnings_date': datetime.datetime(2023, 3, 9, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'CYTO', 'market_cap': 1500000.0, 'p_e': None, 'price': 1.56, 'change_percentage': 0.20929999999999999, 'volume': 2519647.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -26.36, 'insider_own_percentage': 7.1, 'shs_outstand': 1170000.0, 'perf_week_percentage': -37.35, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 1090000.0, 'perf_month_percentage': -46.39, 'income': -19200000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 1.9, 'perf_quarter_percentage': -70.79, 'sales': 1400000.0, 'p_s': 1.07, 'eps_this_y_percentage': 3.7, 'inst_trans_percentage': 62.28, 'short_interest': 20000.0, 'perf_half_y_percentage': -77.06, 'book_sh': 10.62, 'p_b': 0.15, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -87.7, 'target_price': None, 'perf_year_percentage': -89.37, 'cash_sh': 0.42, 'p_c': 3.74, 'eps_next_5y_percentage': None, 'roe_percentage': -125.4, 'range_from_52w': 1.25, 'range_to_52w': '43.00', 'perf_ytd_percentage': -67.84, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -96.37, 'beta': 1.4, 'dividend_percentage': None, 'quick_ratio': 0.2, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 24.8, 'atr': '0.45', 'employees': 17.0, 'current_ratio': 0.2, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 29.11, 'volatility_w_percentage': 31.81, 'volatility_m_percentage': 18.62, 'optionable': True, 'debt_eq': 0.61, 'eps_q_q_percentage': 18.7, 'profit_margin_percentage': None, 'rel_volume': '4.88', 'prev_close': '1.29', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 541340.0, 'recom': None, 'sma20_percentage': -33.53, 'sma50_percentage': -55.48, 'sma200_percentage': -77.68, 'short_float_percentage': 2.21, 'short_float_ratio': 0.04, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'JFBR', 'market_cap': 9500000.0, 'p_e': None, 'price': 1.66, 'change_percentage': 0.1942, 'volume': 3518904.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.63, 'insider_own_percentage': 69.36, 'shs_outstand': 6860000.0, 'perf_week_percentage': 48.21, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 2100000.0, 'perf_month_percentage': 59.62, 'income': -2200000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 4.4, 'perf_quarter_percentage': 6.41, 'sales': 6900000.0, 'p_s': 1.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': 260000.0, 'perf_half_y_percentage': 10.67, 'book_sh': 0.24, 'p_b': 7.03, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': None, 'cash_sh': 0.02, 'p_c': 94.95, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 0.83, 'range_to_52w': '3.30', 'perf_ytd_percentage': 43.1, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -15.5, 'high_52w_percentage': -49.7, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 0.0, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 26.4, 'low_52w_percentage': 99.93, 'atr': '0.16', 'employees': None, 'current_ratio': 0.5, 'sales_q_q_percentage': 91.7, 'oper_margin_percentage': None, 'rsi_14': 76.5, 'volatility_w_percentage': 17.92, 'volatility_m_percentage': 13.31, 'optionable': False, 'debt_eq': 5.71, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '11.69', 'prev_close': '1.39', 'shortable': True, 'lt_debt_eq': 3.57, 'payout_percentage': None, 'avg_volume': 352910.0, 'recom': None, 'sma20_percentage': 55.54, 'sma50_percentage': 45.29, 'sma200_percentage': 29.9, 'short_float_percentage': 12.16, 'short_float_ratio': 0.72, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}  ... displaying 10 of 1861 total bound parameter sets ...  {'ticker': 'FJP', 'market_cap': None, 'p_e': None, 'price': 44.97, 'change_percentage': -0.0141, 'volume': 906.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': -0.7, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 2.26, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 7.0, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 11.43, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -6.58, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 36.88, 'range_to_52w': '49.47', 'perf_ytd_percentage': 5.92, 'dividend': 0.94, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -9.09, 'beta': None, 'dividend_percentage': 2.09, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 21.95, 'atr': '0.57', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 54.11, 'volatility_w_percentage': 0.89, 'volatility_m_percentage': 0.72, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.13', 'prev_close': '45.62', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 7080.0, 'recom': None, 'sma20_percentage': 0.87, 'sma50_percentage': 2.57, 'sma200_percentage': 7.23, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)}, {'ticker': 'AGZD', 'market_cap': None, 'p_e': None, 'price': 43.55, 'change_percentage': -0.0059, 'volume': 14367.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': -0.71, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': -0.75, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.0, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 0.75, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': 0.23, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 42.62, 'range_to_52w': '44.17', 'perf_ytd_percentage': 0.22, 'dividend': 1.25, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.4, 'beta': None, 'dividend_percentage': 2.87, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 2.18, 'atr': '0.17', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 36.17, 'volatility_w_percentage': 0.29, 'volatility_m_percentage': 0.34, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.13', 'prev_close': '43.81', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 107610.0, 'recom': None, 'sma20_percentage': -0.81, 'sma50_percentage': -0.5, 'sma200_percentage': 0.37, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 13, 8, 13)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
News, Blogs, Calendar, Insider Trades; 2023-03-13 08:59:03.375007
News, Blogs, Calendar, Insider Trades; 2023-03-13 09:59:03.049731
All Signal Screener; 2023-03-13 10:12:16.530315
News, Blogs, Calendar, Insider Trades; 2023-03-13 10:59:03.106180
News, Blogs, Calendar, Insider Trades; 2023-03-13 11:59:02.642231
All Signal Screener; 2023-03-13 12:14:05.892512
News, Blogs, Calendar, Insider Trades; 2023-03-13 12:59:02.480666
News, Blogs, Calendar, Insider Trades; 2023-03-13 13:59:03.222864
All Signal Screener; 2023-03-13 14:13:27.783665
News, Blogs, Calendar, Insider Trades; 2023-03-13 14:59:03.382686
News, Blogs, Calendar, Insider Trades; 2023-03-13 15:59:02.911106
All Signal Screener; 2023-03-13 16:13:52.847894
News, Blogs, Calendar, Insider Trades; 2023-03-13 16:59:02.548030
News, Blogs, Calendar, Insider Trades; 2023-03-13 17:59:03.220845
All Signal Screener; 2023-03-13 18:13:30.060165
News, Blogs, Calendar, Insider Trades; 2023-03-13 18:59:02.649662
News, Blogs, Calendar, Insider Trades; 2023-03-13 19:59:03.647883
All Signal Screener; 2023-03-13 20:13:52.395548
Ticker Data; 2023-03-13 20:40:27.861424
News, Blogs, Calendar, Insider Trades; 2023-03-13 20:59:02.899560
News, Blogs, Calendar, Insider Trades; 2023-03-13 21:59:03.067999
All Signal Screener; 2023-03-13 22:14:05.607711
News, Blogs, Calendar, Insider Trades; 2023-03-13 22:59:03.323734
News, Blogs, Calendar, Insider Trades; 2023-03-13 23:59:02.971261
All Signal Screener; 2023-03-14 00:13:43.055070
News, Blogs, Calendar, Insider Trades; 2023-03-14 00:59:02.560345
News, Blogs, Calendar, Insider Trades; 2023-03-14 01:59:03.199625
All Signal Screener; 2023-03-14 02:13:02.564862
News, Blogs, Calendar, Insider Trades; 2023-03-14 02:59:03.053220
News, Blogs, Calendar, Insider Trades; 2023-03-14 03:59:02.693678
All Signal Screener; 2023-03-14 04:13:03.325286
News, Blogs, Calendar, Insider Trades; 2023-03-14 04:59:03.153884
News, Blogs, Calendar, Insider Trades; 2023-03-14 05:59:02.756700
All Signal Screener; 2023-03-14 06:13:15.267722
News, Blogs, Calendar, Insider Trades; 2023-03-14 06:59:02.886772
News, Blogs, Calendar, Insider Trades; 2023-03-14 07:59:02.539920
All Signal Screener; 2023-03-14 08:13:39.911946
News, Blogs, Calendar, Insider Trades; 2023-03-14 08:59:02.817715
News, Blogs, Calendar, Insider Trades; 2023-03-14 09:59:02.457739
All Signal Screener; 2023-03-14 10:11:23.817182
News, Blogs, Calendar, Insider Trades; 2023-03-14 10:59:02.945256
News, Blogs, Calendar, Insider Trades; 2023-03-14 11:59:02.600981
All Signal Screener; 2023-03-14 12:12:28.408973
News, Blogs, Calendar, Insider Trades; 2023-03-14 12:59:03.107922
News, Blogs, Calendar, Insider Trades; 2023-03-14 13:59:02.889668
All Signal Screener; 2023-03-14 14:13:17.771373
News, Blogs, Calendar, Insider Trades; 2023-03-14 14:59:02.486423
News, Blogs, Calendar, Insider Trades; 2023-03-14 15:59:03.223371
All Signal Screener; 2023-03-14 16:14:14.836472
News, Blogs, Calendar, Insider Trades; 2023-03-14 16:59:02.624200
News, Blogs, Calendar, Insider Trades; 2023-03-14 17:59:03.274756
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-14']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-14 18:14:01.732428
News, Blogs, Calendar, Insider Trades; 2023-03-14 18:59:03.381950
News, Blogs, Calendar, Insider Trades; 2023-03-14 19:59:03.045487
All Signal Screener; 2023-03-14 20:14:01.665051
Ticker Data; 2023-03-14 20:40:21.421897
News, Blogs, Calendar, Insider Trades; 2023-03-14 20:59:03.100029
News, Blogs, Calendar, Insider Trades; 2023-03-14 21:59:02.740464
All Signal Screener; 2023-03-14 22:14:08.156562
News, Blogs, Calendar, Insider Trades; 2023-03-14 22:59:02.733824
News, Blogs, Calendar, Insider Trades; 2023-03-14 23:59:03.796434
All Signal Screener; 2023-03-15 00:13:57.340254
News, Blogs, Calendar, Insider Trades; 2023-03-15 00:59:03.253867
News, Blogs, Calendar, Insider Trades; 2023-03-15 01:59:02.861431
All Signal Screener; 2023-03-15 02:13:47.870250
News, Blogs, Calendar, Insider Trades; 2023-03-15 02:59:02.477938
News, Blogs, Calendar, Insider Trades; 2023-03-15 03:59:03.122966
All Signal Screener; 2023-03-15 04:13:35.072613
News, Blogs, Calendar, Insider Trades; 2023-03-15 04:59:02.637739
News, Blogs, Calendar, Insider Trades; 2023-03-15 05:59:03.198058
All Signal Screener; 2023-03-15 06:13:32.502928
News, Blogs, Calendar, Insider Trades; 2023-03-15 06:59:03.108555
News, Blogs, Calendar, Insider Trades; 2023-03-15 07:59:02.720113
All Signal Screener; 2023-03-15 08:14:22.948869
News, Blogs, Calendar, Insider Trades; 2023-03-15 08:59:02.465204
News, Blogs, Calendar, Insider Trades; 2023-03-15 09:59:03.415386
All Signal Screener; 2023-03-15 10:12:59.719061
News, Blogs, Calendar, Insider Trades; 2023-03-15 10:59:02.734305
News, Blogs, Calendar, Insider Trades; 2023-03-15 11:59:02.691370
All Signal Screener; 2023-03-15 12:14:19.861885
News, Blogs, Calendar, Insider Trades; 2023-03-15 12:59:02.789075
News, Blogs, Calendar, Insider Trades; 2023-03-15 13:59:03.325775
All Signal Screener; 2023-03-15 14:13:39.250432
News, Blogs, Calendar, Insider Trades; 2023-03-15 14:59:03.355997
News, Blogs, Calendar, Insider Trades; 2023-03-15 15:59:03.570497
All Signal Screener; 2023-03-15 16:13:53.792303
News, Blogs, Calendar, Insider Trades; 2023-03-15 16:59:02.924491
News, Blogs, Calendar, Insider Trades; 2023-03-15 17:59:02.980914
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-15']
(Background on this error at: https://sqlalche.me/e/14/f405)
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 553, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1728, in to_sql
    table = self.prep_table(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1631, in prep_table
    table.create()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 827, in create
    if self.exists():
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 814, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1761, in has_table
    return insp.has_table(name, schema or self.meta.schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 283, in has_table
    return self.dialect.has_table(conn, table_name, schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/base.py", line 3496, in has_table
    cursor = connection.execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (psycopg2.errors.AdminShutdown) terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[SQL: select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s]
[parameters: {'name': 'all_signal_screener'}]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
News, Blogs, Calendar, Insider Trades; 2023-03-15 18:59:03.135897
News, Blogs, Calendar, Insider Trades; 2023-03-15 19:59:03.277702
All Signal Screener; 2023-03-15 20:14:10.226713
Ticker Data; 2023-03-15 20:40:25.500112
News, Blogs, Calendar, Insider Trades; 2023-03-15 20:59:03.616872
News, Blogs, Calendar, Insider Trades; 2023-03-15 21:59:03.410020
All Signal Screener; 2023-03-15 22:13:30.766385
News, Blogs, Calendar, Insider Trades; 2023-03-15 22:59:03.419060
News, Blogs, Calendar, Insider Trades; 2023-03-15 23:59:03.019670
All Signal Screener; 2023-03-16 00:13:17.850883
News, Blogs, Calendar, Insider Trades; 2023-03-16 00:59:02.367448
News, Blogs, Calendar, Insider Trades; 2023-03-16 01:59:03.415679
All Signal Screener; 2023-03-16 02:13:54.534474
News, Blogs, Calendar, Insider Trades; 2023-03-16 02:59:03.482201
News, Blogs, Calendar, Insider Trades; 2023-03-16 03:59:03.030398
All Signal Screener; 2023-03-16 04:13:45.958986
News, Blogs, Calendar, Insider Trades; 2023-03-16 04:59:02.573587
News, Blogs, Calendar, Insider Trades; 2023-03-16 05:59:03.183008
All Signal Screener; 2023-03-16 06:12:50.871368
News, Blogs, Calendar, Insider Trades; 2023-03-16 06:59:02.538957
News, Blogs, Calendar, Insider Trades; 2023-03-16 07:59:03.155320
All Signal Screener; 2023-03-16 08:13:04.329891
News, Blogs, Calendar, Insider Trades; 2023-03-16 08:59:02.946092
News, Blogs, Calendar, Insider Trades; 2023-03-16 09:59:02.546554
All Signal Screener; 2023-03-16 10:10:51.226407
News, Blogs, Calendar, Insider Trades; 2023-03-16 10:59:02.865454
News, Blogs, Calendar, Insider Trades; 2023-03-16 11:59:02.354445
All Signal Screener; 2023-03-16 12:12:22.102017
News, Blogs, Calendar, Insider Trades; 2023-03-16 12:59:02.588667
News, Blogs, Calendar, Insider Trades; 2023-03-16 13:59:03.075622
All Signal Screener; 2023-03-16 14:12:13.001903
News, Blogs, Calendar, Insider Trades; 2023-03-16 14:59:02.687747
News, Blogs, Calendar, Insider Trades; 2023-03-16 15:59:03.669782
News, Blogs, Calendar, Insider Trades; 2023-03-16 16:59:10.725408
News, Blogs, Calendar, Insider Trades; 2023-03-16 17:59:03.252334
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None, ADBE, ADBE,...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None, ADBE, ADBE,...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None, ADBE, ADBE, ADBE, ADBE, ADBE'WHERE request_date = '2023-03-16']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-16 18:13:36.690130
News, Blogs, Calendar, Insider Trades; 2023-03-16 18:59:03.672704
News, Blogs, Calendar, Insider Trades; 2023-03-16 19:59:02.902116
All Signal Screener; 2023-03-16 20:14:46.361033
Ticker Data; 2023-03-16 20:40:32.412276
News, Blogs, Calendar, Insider Trades; 2023-03-16 20:59:03.621467
News, Blogs, Calendar, Insider Trades; 2023-03-16 21:59:03.759222
All Signal Screener; 2023-03-16 22:14:33.493846
News, Blogs, Calendar, Insider Trades; 2023-03-16 22:59:03.045354
News, Blogs, Calendar, Insider Trades; 2023-03-16 23:59:03.042404
All Signal Screener; 2023-03-17 00:13:48.507321
News, Blogs, Calendar, Insider Trades; 2023-03-17 00:59:03.451238
News, Blogs, Calendar, Insider Trades; 2023-03-17 01:59:02.974331
All Signal Screener; 2023-03-17 02:13:23.908109
News, Blogs, Calendar, Insider Trades; 2023-03-17 02:59:02.554414
News, Blogs, Calendar, Insider Trades; 2023-03-17 03:59:03.163584
All Signal Screener; 2023-03-17 04:13:08.524097
News, Blogs, Calendar, Insider Trades; 2023-03-17 04:59:03.060192
News, Blogs, Calendar, Insider Trades; 2023-03-17 05:59:02.650864
All Signal Screener; 2023-03-17 06:13:10.418792
News, Blogs, Calendar, Insider Trades; 2023-03-17 06:59:02.975453
News, Blogs, Calendar, Insider Trades; 2023-03-17 07:59:02.571026
All Signal Screener; 2023-03-17 08:12:50.580272
News, Blogs, Calendar, Insider Trades; 2023-03-17 08:59:03.205913
News, Blogs, Calendar, Insider Trades; 2023-03-17 09:59:02.903477
All Signal Screener; 2023-03-17 10:11:17.086020
News, Blogs, Calendar, Insider Trades; 2023-03-17 10:59:02.741550
News, Blogs, Calendar, Insider Trades; 2023-03-17 11:59:03.403308
All Signal Screener; 2023-03-17 12:13:14.000539
News, Blogs, Calendar, Insider Trades; 2023-03-17 12:59:02.630426
News, Blogs, Calendar, Insider Trades; 2023-03-17 13:59:03.291402
All Signal Screener; 2023-03-17 14:13:05.569762
News, Blogs, Calendar, Insider Trades; 2023-03-17 14:59:03.342372
News, Blogs, Calendar, Insider Trades; 2023-03-17 15:59:02.943289
All Signal Screener; 2023-03-17 16:13:18.117444
News, Blogs, Calendar, Insider Trades; 2023-03-17 16:59:02.806315
News, Blogs, Calendar, Insider Trades; 2023-03-17 17:59:02.578473
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-17']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-17 18:13:27.437321
News, Blogs, Calendar, Insider Trades; 2023-03-17 18:59:03.018539
News, Blogs, Calendar, Insider Trades; 2023-03-17 19:59:02.728747
All Signal Screener; 2023-03-17 20:13:10.232164
Ticker Data; 2023-03-17 20:40:22.865009
News, Blogs, Calendar, Insider Trades; 2023-03-17 20:59:02.464921
News, Blogs, Calendar, Insider Trades; 2023-03-17 21:59:03.362614
All Signal Screener; 2023-03-17 22:13:44.444127
News, Blogs, Calendar, Insider Trades; 2023-03-17 22:59:03.581556
News, Blogs, Calendar, Insider Trades; 2023-03-17 23:59:03.607012
All Signal Screener; 2023-03-18 00:13:48.445030
News, Blogs, Calendar, Insider Trades; 2023-03-18 00:59:03.483601
News, Blogs, Calendar, Insider Trades; 2023-03-18 01:59:03.129652
All Signal Screener; 2023-03-18 02:12:45.945070
News, Blogs, Calendar, Insider Trades; 2023-03-18 02:59:02.475835
News, Blogs, Calendar, Insider Trades; 2023-03-18 03:59:03.063120
All Signal Screener; 2023-03-18 04:12:39.912224
News, Blogs, Calendar, Insider Trades; 2023-03-18 04:59:02.456202
News, Blogs, Calendar, Insider Trades; 2023-03-18 05:59:03.114883
All Signal Screener; 2023-03-18 06:12:57.806701
News, Blogs, Calendar, Insider Trades; 2023-03-18 06:59:02.479186
News, Blogs, Calendar, Insider Trades; 2023-03-18 07:59:03.044902
All Signal Screener; 2023-03-18 08:12:48.982735
News, Blogs, Calendar, Insider Trades; 2023-03-18 08:59:02.603076
News, Blogs, Calendar, Insider Trades; 2023-03-18 09:59:03.202129
All Signal Screener; 2023-03-18 10:12:56.555830
News, Blogs, Calendar, Insider Trades; 2023-03-18 10:59:03.216467
News, Blogs, Calendar, Insider Trades; 2023-03-18 11:59:03.214853
All Signal Screener; 2023-03-18 12:14:10.254100
News, Blogs, Calendar, Insider Trades; 2023-03-18 12:59:02.976920
News, Blogs, Calendar, Insider Trades; 2023-03-18 13:59:02.582821
All Signal Screener; 2023-03-18 14:13:11.948262
News, Blogs, Calendar, Insider Trades; 2023-03-18 14:59:02.536481
News, Blogs, Calendar, Insider Trades; 2023-03-18 15:59:03.145070
All Signal Screener; 2023-03-18 16:13:04.434705
News, Blogs, Calendar, Insider Trades; 2023-03-18 16:59:03.294576
News, Blogs, Calendar, Insider Trades; 2023-03-18 17:59:03.097114
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-18']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-18 18:13:13.610067
News, Blogs, Calendar, Insider Trades; 2023-03-18 18:59:03.428762
News, Blogs, Calendar, Insider Trades; 2023-03-18 19:59:03.043481
All Signal Screener; 2023-03-18 20:12:45.729334
News, Blogs, Calendar, Insider Trades; 2023-03-18 20:59:03.658777
News, Blogs, Calendar, Insider Trades; 2023-03-18 21:59:03.212108
All Signal Screener; 2023-03-18 22:12:49.311450
News, Blogs, Calendar, Insider Trades; 2023-03-18 22:59:02.870989
News, Blogs, Calendar, Insider Trades; 2023-03-18 23:59:02.407544
All Signal Screener; 2023-03-19 00:12:31.520805
News, Blogs, Calendar, Insider Trades; 2023-03-19 00:59:03.086408
News, Blogs, Calendar, Insider Trades; 2023-03-19 01:59:02.717961
All Signal Screener; 2023-03-19 02:13:23.931394
News, Blogs, Calendar, Insider Trades; 2023-03-19 02:59:02.861618
News, Blogs, Calendar, Insider Trades; 2023-03-19 03:59:02.576442
All Signal Screener; 2023-03-19 04:13:28.480575
News, Blogs, Calendar, Insider Trades; 2023-03-19 04:59:03.097123
News, Blogs, Calendar, Insider Trades; 2023-03-19 05:59:02.678303
All Signal Screener; 2023-03-19 06:13:36.662829
News, Blogs, Calendar, Insider Trades; 2023-03-19 06:59:03.311471
News, Blogs, Calendar, Insider Trades; 2023-03-19 07:59:03.002757
All Signal Screener; 2023-03-19 08:13:29.803523
News, Blogs, Calendar, Insider Trades; 2023-03-19 08:59:02.580041
News, Blogs, Calendar, Insider Trades; 2023-03-19 09:59:03.264652
All Signal Screener; 2023-03-19 10:13:05.567978
News, Blogs, Calendar, Insider Trades; 2023-03-19 10:59:03.202501
News, Blogs, Calendar, Insider Trades; 2023-03-19 11:59:02.793613
All Signal Screener; 2023-03-19 12:13:36.618062
News, Blogs, Calendar, Insider Trades; 2023-03-19 12:59:03.177515
News, Blogs, Calendar, Insider Trades; 2023-03-19 13:59:02.761784
All Signal Screener; 2023-03-19 14:13:11.886955
News, Blogs, Calendar, Insider Trades; 2023-03-19 14:59:02.458830
News, Blogs, Calendar, Insider Trades; 2023-03-19 15:59:03.031555
All Signal Screener; 2023-03-19 16:13:12.114896
News, Blogs, Calendar, Insider Trades; 2023-03-19 16:59:02.592945
News, Blogs, Calendar, Insider Trades; 2023-03-19 17:59:03.485821
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-19']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-19 18:13:35.556005
News, Blogs, Calendar, Insider Trades; 2023-03-19 18:59:03.558494
News, Blogs, Calendar, Insider Trades; 2023-03-19 19:59:03.708267
All Signal Screener; 2023-03-19 20:13:46.236128
News, Blogs, Calendar, Insider Trades; 2023-03-19 20:59:02.943385
News, Blogs, Calendar, Insider Trades; 2023-03-19 21:59:02.522270
All Signal Screener; 2023-03-19 22:13:38.142915
News, Blogs, Calendar, Insider Trades; 2023-03-19 22:59:03.071762
News, Blogs, Calendar, Insider Trades; 2023-03-19 23:59:02.750727
All Signal Screener; 2023-03-20 00:13:30.901662
News, Blogs, Calendar, Insider Trades; 2023-03-20 00:59:02.536807
News, Blogs, Calendar, Insider Trades; 2023-03-20 01:59:03.102653
All Signal Screener; 2023-03-20 02:13:01.134474
News, Blogs, Calendar, Insider Trades; 2023-03-20 02:59:02.977228
News, Blogs, Calendar, Insider Trades; 2023-03-20 03:59:02.604710
All Signal Screener; 2023-03-20 04:13:26.740851
News, Blogs, Calendar, Insider Trades; 2023-03-20 04:59:03.291442
News, Blogs, Calendar, Insider Trades; 2023-03-20 05:59:02.909041
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "-"
LINE 1: ..., 5.1, NULL, 62.16, 0.18, 16.38, NULL, 7.4, NULL, '-', 1.69,...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 553, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "-"
LINE 1: ..., 5.1, NULL, 62.16, 0.18, 16.38, NULL, 7.4, NULL, '-', 1.69,...
                                                             ^

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'ENZ', 'market_cap': 58010000.0, 'p_e': None, 'price': 2.25, 'change_percentage': 0.8908, 'volume': 36143744.0, 'signals': "['Most Active', 'Most Volatile', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 5, 'eps_ttm': -0.55, 'insider_own_percentage': 9.7, 'shs_outstand': 48720000.0, 'perf_week_percentage': 102.7, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 6.37, 'shs_float': 37770000.0, 'perf_month_percentage': 75.78, 'income': -26600000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 42.2, 'perf_quarter_percentage': 78.57, 'sales': 98800000.0, 'p_s': 0.59, 'eps_this_y_percentage': -330.6, 'inst_trans_percentage': -5.46, 'short_interest': 320000.0, 'perf_half_y_percentage': -0.44, 'book_sh': 0.92, 'p_b': 2.45, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -27.0, 'target_price': None, 'perf_year_percentage': -28.12, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': -46.9, 'range_from_52w': 1.0, 'range_to_52w': '3.19', 'perf_ytd_percentage': 57.34, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -47.4, 'roi_percentage': -25.5, 'high_52w_percentage': -29.47, 'beta': 0.85, 'dividend_percentage': None, 'quick_ratio': 1.2, 'sales_past_5y_percentage': 0.4, 'gross_margin_percentage': 34.7, 'low_52w_percentage': 125.0, 'atr': '0.18', 'employees': 465.0, 'current_ratio': 1.8, 'sales_q_q_percentage': -30.9, 'oper_margin_percentage': -23.4, 'rsi_14': 80.89, 'volatility_w_percentage': 14.17, 'volatility_m_percentage': 9.24, 'optionable': True, 'debt_eq': 0.1, 'eps_q_q_percentage': -356.3, 'profit_margin_percentage': -26.9, 'rel_volume': '324.03', 'prev_close': '1.19', 'shortable': True, 'lt_debt_eq': 0.09, 'payout_percentage': None, 'avg_volume': 701390.0, 'recom': None, 'sma20_percentage': 93.3, 'sma50_percentage': 70.61, 'sma200_percentage': 14.27, 'short_float_percentage': 0.85, 'short_float_ratio': 0.46, 'earnings_date': datetime.datetime(2022, 12, 12, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'BKKT', 'market_cap': 314190000.0, 'p_e': None, 'price': 1.72, 'change_percentage': 0.4454, 'volume': 7100894.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -7.51, 'insider_own_percentage': 1.5, 'shs_outstand': 76590000.0, 'perf_week_percentage': 57.8, 'forward_p_e': None, 'eps_next_y': -0.47, 'insider_trans_percentage': -23.32, 'shs_float': 60700000.0, 'perf_month_percentage': -1.15, 'income': -575700000.0, 'peg': None, 'eps_next_q': -0.18, 'inst_own_percentage': 30.8, 'perf_quarter_percentage': 13.16, 'sales': 54600000.0, 'p_s': 5.75, 'eps_this_y_percentage': 91.7, 'inst_trans_percentage': 3.06, 'short_interest': 13160000.0, 'perf_half_y_percentage': -36.3, 'book_sh': 2.42, 'p_b': 0.71, 'eps_next_y_percentage_percentage': 29.9, 'roa_percentage': -10.3, 'target_price': 2.02, 'perf_year_percentage': -66.8, 'cash_sh': 1.5, 'p_c': 1.15, 'eps_next_5y_percentage': None, 'roe_percentage': -48.4, 'range_from_52w': 1.08, 'range_to_52w': '7.76', 'perf_ytd_percentage': 44.54, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -48.2, 'high_52w_percentage': -77.84, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 2.5, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 59.26, 'atr': '0.18', 'employees': 579.0, 'current_ratio': 2.5, 'sales_q_q_percentage': 41.8, 'oper_margin_percentage': None, 'rsi_14': 60.97, 'volatility_w_percentage': 24.15, 'volatility_m_percentage': 11.71, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '2.17', 'prev_close': '1.19', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 3220000.0, 'recom': 3.2, 'sma20_percentage': 25.73, 'sma50_percentage': 9.68, 'sma200_percentage': -18.7, 'short_float_percentage': 21.68, 'short_float_ratio': 4.09, 'earnings_date': datetime.datetime(2023, 3, 9, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'HMPT', 'market_cap': 250510000.0, 'p_e': None, 'price': 2.55, 'change_percentage': 0.40880000000000005, 'volume': 231151.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -1.18, 'insider_own_percentage': 1.43, 'shs_outstand': 138400000.0, 'perf_week_percentage': 34.21, 'forward_p_e': 24.06, 'eps_next_y': 0.11, 'insider_trans_percentage': 0.0, 'shs_float': 136440000.0, 'perf_month_percentage': 34.92, 'income': -163500000.0, 'peg': None, 'eps_next_q': -0.07, 'inst_own_percentage': 94.0, 'perf_quarter_percentage': 109.02, 'sales': 465600000.0, 'p_s': 0.54, 'eps_this_y_percentage': -199.3, 'inst_trans_percentage': -0.1, 'short_interest': 170000.0, 'perf_half_y_percentage': 12.33, 'book_sh': 4.36, 'p_b': 0.58, 'eps_next_y_percentage_percentage': 173.3, 'roa_percentage': -4.4, 'target_price': 1.91, 'perf_year_percentage': -24.33, 'cash_sh': 0.99, 'p_c': 2.58, 'eps_next_5y_percentage': 2.0, 'roe_percentage': -23.7, 'range_from_52w': 0.99, 'range_to_52w': '4.65', 'perf_ytd_percentage': 86.13, 'dividend': 0.16, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -1.9, 'high_52w_percentage': -45.16, 'beta': None, 'dividend_percentage': 6.27, 'quick_ratio': 1.5, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 63.6, 'low_52w_percentage': 157.58, 'atr': '0.18', 'employees': 830.0, 'current_ratio': 1.5, 'sales_q_q_percentage': -67.3, 'oper_margin_percentage': -17.5, 'rsi_14': 74.2, 'volatility_w_percentage': 17.27, 'volatility_m_percentage': 8.89, 'optionable': True, 'debt_eq': 2.53, 'eps_q_q_percentage': -294.0, 'profit_margin_percentage': -35.1, 'rel_volume': '9.94', 'prev_close': '1.81', 'shortable': True, 'lt_debt_eq': 2.38, 'payout_percentage': None, 'avg_volume': 25960.0, 'recom': 3.2, 'sma20_percentage': 45.59, 'sma50_percentage': 43.36, 'sma200_percentage': 8.27, 'short_float_percentage': 0.12, 'short_float_ratio': 6.42, 'earnings_date': datetime.datetime(2023, 3, 9, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'DFLI', 'market_cap': 119020000.0, 'p_e': None, 'price': 3.6, 'change_percentage': 0.3091, 'volume': 224112.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -0.13, 'insider_own_percentage': 62.0, 'shs_outstand': 15810000.0, 'perf_week_percentage': -9.32, 'forward_p_e': None, 'eps_next_y': -0.18, 'insider_trans_percentage': 0.0, 'shs_float': 9300000.0, 'perf_month_percentage': -43.93, 'income': -2100000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 11.9, 'perf_quarter_percentage': -74.79, 'sales': 86220000.0, 'p_s': 1.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': -70.82, 'short_interest': 260000.0, 'perf_half_y_percentage': -65.01, 'book_sh': 1.83, 'p_b': 1.97, 'eps_next_y_percentage_percentage': 63.3, 'roa_percentage': -2.0, 'target_price': 12.33, 'perf_year_percentage': -64.0, 'cash_sh': 0.01, 'p_c': 396.72, 'eps_next_5y_percentage': None, 'roe_percentage': -2.0, 'range_from_52w': 2.62, 'range_to_52w': '28.75', 'perf_ytd_percentage': -69.75, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -87.48, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 0.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 37.16, 'atr': '0.58', 'employees': 168.0, 'current_ratio': 0.3, 'sales_q_q_percentage': 38.6, 'oper_margin_percentage': None, 'rsi_14': 35.33, 'volatility_w_percentage': 18.83, 'volatility_m_percentage': 12.88, 'optionable': True, 'debt_eq': 0.01, 'eps_q_q_percentage': -171.3, 'profit_margin_percentage': None, 'rel_volume': '1.46', 'prev_close': '2.75', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': 0.0, 'avg_volume': 152780.0, 'recom': 1.3, 'sma20_percentage': -14.58, 'sma50_percentage': -44.27, 'sma200_percentage': -61.66, 'short_float_percentage': 2.84, 'short_float_ratio': 1.73, 'earnings_date': datetime.datetime(2023, 3, 20, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'OPRT', 'market_cap': 94890000.0, 'p_e': None, 'price': 3.64, 'change_percentage': 0.2817, 'volume': 2556313.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.37, 'insider_own_percentage': 5.9, 'shs_outstand': 33240000.000000004, 'perf_week_percentage': -15.74, 'forward_p_e': 1.86, 'eps_next_y': 1.96, 'insider_trans_percentage': 6.29, 'shs_float': 30270000.0, 'perf_month_percentage': -48.59, 'income': -77700000.0, 'peg': None, 'eps_next_q': -0.41, 'inst_own_percentage': 72.1, 'perf_quarter_percentage': -33.82, 'sales': 640700000.0, 'p_s': 0.15, 'eps_this_y_percentage': -251.5, 'inst_trans_percentage': -4.65, 'short_interest': 990000.0, 'perf_half_y_percentage': -33.21, 'book_sh': 16.48, 'p_b': 0.22, 'eps_next_y_percentage_percentage': 160.51, 'roa_percentage': -2.3, 'target_price': 8.8, 'perf_year_percentage': -73.72, 'cash_sh': 3.79, 'p_c': 0.96, 'eps_next_5y_percentage': -3.8, 'roe_percentage': -13.0, 'range_from_52w': 2.19, 'range_to_52w': '14.91', 'perf_ytd_percentage': -33.94, 'dividend': None, 'p_fcf': 0.39, 'eps_past_5y_percentage': -44.0, 'roi_percentage': -2.2, 'high_52w_percentage': -75.59, 'beta': 1.77, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': 14.6, 'gross_margin_percentage': None, 'low_52w_percentage': 66.2, 'atr': '0.54', 'employees': 3000.0, 'current_ratio': None, 'sales_q_q_percentage': -10.7, 'oper_margin_percentage': -11.8, 'rsi_14': 33.75, 'volatility_w_percentage': 26.02, 'volatility_m_percentage': 11.33, 'optionable': True, 'debt_eq': 5.35, 'eps_q_q_percentage': -151.6, 'profit_margin_percentage': -12.1, 'rel_volume': '7.24', 'prev_close': '2.84', 'shortable': True, 'lt_debt_eq': 5.35, 'payout_percentage': None, 'avg_volume': 388380.0, 'recom': 2.0, 'sma20_percentage': -31.22, 'sma50_percentage': -39.63, 'sma200_percentage': -44.59, 'short_float_percentage': 3.27, 'short_float_ratio': 2.55, 'earnings_date': datetime.datetime(2023, 3, 13, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'PYXS', 'market_cap': 75790000.0, 'p_e': None, 'price': 2.76, 'change_percentage': 0.2778, 'volume': 507249.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -3.16, 'insider_own_percentage': 11.9, 'shs_outstand': 32560000.000000004, 'perf_week_percentage': 55.93, 'forward_p_e': None, 'eps_next_y': -3.09, 'insider_trans_percentage': 0.0, 'shs_float': 27750000.0, 'perf_month_percentage': 78.06, 'income': -101400000.0, 'peg': None, 'eps_next_q': -0.93, 'inst_own_percentage': 55.4, 'perf_quarter_percentage': 135.9, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -501.7, 'inst_trans_percentage': -3.76, 'short_interest': 170000.0, 'perf_half_y_percentage': 15.97, 'book_sh': 5.8, 'p_b': 0.48, 'eps_next_y_percentage_percentage': 15.6, 'roa_percentage': -40.6, 'target_price': 11.0, 'perf_year_percentage': -41.89, 'cash_sh': 7.23, 'p_c': 0.38, 'eps_next_5y_percentage': None, 'roe_percentage': -45.3, 'range_from_52w': 1.1, 'range_to_52w': '5.78', 'perf_ytd_percentage': 105.97, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -52.25, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 10.6, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 150.91, 'atr': '0.23', 'employees': 73.0, 'current_ratio': 10.6, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 70.46, 'volatility_w_percentage': 15.17, 'volatility_m_percentage': 12.13, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -96.3, 'profit_margin_percentage': None, 'rel_volume': '5.25', 'prev_close': '2.16', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 101630.0, 'recom': 1.8, 'sma20_percentage': 32.44, 'sma50_percentage': 57.36, 'sma200_percentage': 36.79, 'short_float_percentage': 0.6, 'short_float_ratio': 1.65, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'OMGA', 'market_cap': 375550000.0, 'p_e': None, 'price': 9.78, 'change_percentage': 0.2522, 'volume': 268588.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -2.14, 'insider_own_percentage': 1.6, 'shs_outstand': 48010000.0, 'perf_week_percentage': 51.63, 'forward_p_e': None, 'eps_next_y': -2.38, 'insider_trans_percentage': None, 'shs_float': 46280000.0, 'perf_month_percentage': 76.22, 'income': -102700000.0, 'peg': None, 'eps_next_q': -0.59, 'inst_own_percentage': 88.8, 'perf_quarter_percentage': 51.39, 'sales': 2100000.0, 'p_s': 178.83, 'eps_this_y_percentage': 29.6, 'inst_trans_percentage': 0.35, 'short_interest': 380000.0, 'perf_half_y_percentage': 58.51, 'book_sh': 2.21, 'p_b': 4.43, 'eps_next_y_percentage_percentage': -27.2, 'roa_percentage': -56.6, 'target_price': 12.71, 'perf_year_percentage': 30.57, 'cash_sh': 3.25, 'p_c': 3.01, 'eps_next_5y_percentage': None, 'roe_percentage': -71.0, 'range_from_52w': 1.98, 'range_to_52w': '11.98', 'perf_ytd_percentage': 71.28, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -81.6, 'high_52w_percentage': -18.36, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 6.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 395.19, 'atr': '0.80', 'employees': 116.0, 'current_ratio': 6.3, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 74.34, 'volatility_w_percentage': 16.47, 'volatility_m_percentage': 10.4, 'optionable': True, 'debt_eq': 0.19, 'eps_q_q_percentage': -47.1, 'profit_margin_percentage': None, 'rel_volume': '3.85', 'prev_close': '7.81', 'shortable': True, 'lt_debt_eq': 0.16, 'payout_percentage': None, 'avg_volume': 71600.0, 'recom': 1.8, 'sma20_percentage': 51.92, 'sma50_percentage': 40.62, 'sma200_percentage': 78.03, 'short_float_percentage': 0.81, 'short_float_ratio': 5.26, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'RPHM', 'market_cap': 111920000.0, 'p_e': None, 'price': 5.71, 'change_percentage': 0.2522, 'volume': 109461.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': -2.0, 'insider_own_percentage': 1.2, 'shs_outstand': 24500000.0, 'perf_week_percentage': 34.35, 'forward_p_e': None, 'eps_next_y': -2.29, 'insider_trans_percentage': 0.0, 'shs_float': 23730000.0, 'perf_month_percentage': 103.93, 'income': -49000000.0, 'peg': None, 'eps_next_q': -0.6, 'inst_own_percentage': 75.4, 'perf_quarter_percentage': 166.82, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -102.3, 'inst_trans_percentage': 0.53, 'short_interest': 100000.0, 'perf_half_y_percentage': 17.73, 'book_sh': 4.57, 'p_b': 1.25, 'eps_next_y_percentage_percentage': -5.0, 'roa_percentage': -35.3, 'target_price': 26.33, 'perf_year_percentage': 66.96, 'cash_sh': 5.92, 'p_c': 0.96, 'eps_next_5y_percentage': None, 'roe_percentage': -37.8, 'range_from_52w': 1.79, 'range_to_52w': '5.20', 'perf_ytd_percentage': 145.06, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 9.81, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 12.8, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 218.99, 'atr': '0.44', 'employees': 32.0, 'current_ratio': 12.8, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 75.25, 'volatility_w_percentage': 12.46, 'volatility_m_percentage': 11.32, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -1.7, 'profit_margin_percentage': None, 'rel_volume': '2.12', 'prev_close': '4.56', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 52570.0, 'recom': 1.3, 'sma20_percentage': 49.35, 'sma50_percentage': 80.88, 'sma200_percentage': 94.6, 'short_float_percentage': 0.4, 'short_float_ratio': 1.81, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 6, 12)}  ... displaying 10 of 1892 total bound parameter sets ...  {'ticker': 'AGZD', 'market_cap': None, 'p_e': None, 'price': 43.29, 'change_percentage': -0.0053, 'volume': 42273.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': -0.6, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': -1.57, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': -0.92, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': -0.11, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -0.63, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 42.62, 'range_to_52w': '44.17', 'perf_ytd_percentage': -0.38, 'dividend': 1.25, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.99, 'beta': None, 'dividend_percentage': 2.89, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 1.57, 'atr': '0.29', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 39.18, 'volatility_w_percentage': 1.18, 'volatility_m_percentage': 0.54, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.42', 'prev_close': '43.52', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 99690.0, 'recom': None, 'sma20_percentage': -1.18, 'sma50_percentage': -1.12, 'sma200_percentage': -0.24, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 6, 12)}, {'ticker': 'NYF', 'market_cap': None, 'p_e': None, 'price': 53.19, 'change_percentage': 0.0059, 'volume': 23944.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.95, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 0.45, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.38, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 2.6, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -3.36, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 49.91, 'range_to_52w': '55.22', 'perf_ytd_percentage': 1.51, 'dividend': 1.1, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -3.68, 'beta': None, 'dividend_percentage': 2.07, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 6.57, 'atr': '0.24', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 62.47, 'volatility_w_percentage': 0.49, 'volatility_m_percentage': 0.34, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.40', 'prev_close': '52.88', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 59720.0, 'recom': None, 'sma20_percentage': 1.41, 'sma50_percentage': 0.31, 'sma200_percentage': 1.51, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 6, 12)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
News, Blogs, Calendar, Insider Trades; 2023-03-20 06:59:02.755529
News, Blogs, Calendar, Insider Trades; 2023-03-20 07:59:03.312217
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "-"
LINE 1: ..., 5.1, NULL, 62.16, 0.18, 16.38, NULL, 7.4, NULL, '-', 1.69,...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 553, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "-"
LINE 1: ..., 5.1, NULL, 62.16, 0.18, 16.38, NULL, 7.4, NULL, '-', 1.69,...
                                                             ^

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'ENZ', 'market_cap': 58010000.0, 'p_e': None, 'price': 2.25, 'change_percentage': 0.8908, 'volume': 36143744.0, 'signals': "['Most Active', 'Most Volatile', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 5, 'eps_ttm': -0.55, 'insider_own_percentage': 9.7, 'shs_outstand': 48720000.0, 'perf_week_percentage': 102.7, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 6.37, 'shs_float': 37770000.0, 'perf_month_percentage': 75.78, 'income': -26600000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 42.2, 'perf_quarter_percentage': 78.57, 'sales': 98800000.0, 'p_s': 0.59, 'eps_this_y_percentage': -330.6, 'inst_trans_percentage': -5.46, 'short_interest': 320000.0, 'perf_half_y_percentage': -0.44, 'book_sh': 0.92, 'p_b': 2.45, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -27.0, 'target_price': None, 'perf_year_percentage': -28.12, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': -46.9, 'range_from_52w': 1.0, 'range_to_52w': '3.19', 'perf_ytd_percentage': 57.34, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -47.4, 'roi_percentage': -25.5, 'high_52w_percentage': -29.47, 'beta': 0.85, 'dividend_percentage': None, 'quick_ratio': 1.2, 'sales_past_5y_percentage': 0.4, 'gross_margin_percentage': 34.7, 'low_52w_percentage': 125.0, 'atr': '0.18', 'employees': 465.0, 'current_ratio': 1.8, 'sales_q_q_percentage': -30.9, 'oper_margin_percentage': -23.4, 'rsi_14': 80.89, 'volatility_w_percentage': 14.17, 'volatility_m_percentage': 9.24, 'optionable': True, 'debt_eq': 0.1, 'eps_q_q_percentage': -356.3, 'profit_margin_percentage': -26.9, 'rel_volume': '324.03', 'prev_close': '1.19', 'shortable': True, 'lt_debt_eq': 0.09, 'payout_percentage': None, 'avg_volume': 701390.0, 'recom': None, 'sma20_percentage': 93.3, 'sma50_percentage': 70.61, 'sma200_percentage': 14.27, 'short_float_percentage': 0.85, 'short_float_ratio': 0.46, 'earnings_date': datetime.datetime(2022, 12, 12, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'BKKT', 'market_cap': 314190000.0, 'p_e': None, 'price': 1.72, 'change_percentage': 0.4454, 'volume': 7100894.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -7.51, 'insider_own_percentage': 1.5, 'shs_outstand': 76590000.0, 'perf_week_percentage': 57.8, 'forward_p_e': None, 'eps_next_y': -0.47, 'insider_trans_percentage': -23.32, 'shs_float': 60700000.0, 'perf_month_percentage': -1.15, 'income': -575700000.0, 'peg': None, 'eps_next_q': -0.18, 'inst_own_percentage': 30.8, 'perf_quarter_percentage': 13.16, 'sales': 54600000.0, 'p_s': 5.75, 'eps_this_y_percentage': 91.7, 'inst_trans_percentage': 3.06, 'short_interest': 13160000.0, 'perf_half_y_percentage': -36.3, 'book_sh': 2.42, 'p_b': 0.71, 'eps_next_y_percentage_percentage': 29.9, 'roa_percentage': -10.3, 'target_price': 2.02, 'perf_year_percentage': -66.8, 'cash_sh': 1.5, 'p_c': 1.15, 'eps_next_5y_percentage': None, 'roe_percentage': -48.4, 'range_from_52w': 1.08, 'range_to_52w': '7.76', 'perf_ytd_percentage': 44.54, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -48.2, 'high_52w_percentage': -77.84, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 2.5, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 59.26, 'atr': '0.18', 'employees': 579.0, 'current_ratio': 2.5, 'sales_q_q_percentage': 41.8, 'oper_margin_percentage': None, 'rsi_14': 60.97, 'volatility_w_percentage': 24.15, 'volatility_m_percentage': 11.71, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '2.17', 'prev_close': '1.19', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 3220000.0, 'recom': 3.2, 'sma20_percentage': 25.73, 'sma50_percentage': 9.68, 'sma200_percentage': -18.7, 'short_float_percentage': 21.68, 'short_float_ratio': 4.09, 'earnings_date': datetime.datetime(2023, 3, 9, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'HMPT', 'market_cap': 250510000.0, 'p_e': None, 'price': 2.55, 'change_percentage': 0.40880000000000005, 'volume': 231151.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -1.18, 'insider_own_percentage': 1.43, 'shs_outstand': 138400000.0, 'perf_week_percentage': 34.21, 'forward_p_e': 24.06, 'eps_next_y': 0.11, 'insider_trans_percentage': 0.0, 'shs_float': 136440000.0, 'perf_month_percentage': 34.92, 'income': -163500000.0, 'peg': None, 'eps_next_q': -0.07, 'inst_own_percentage': 94.0, 'perf_quarter_percentage': 109.02, 'sales': 465600000.0, 'p_s': 0.54, 'eps_this_y_percentage': -199.3, 'inst_trans_percentage': -0.1, 'short_interest': 170000.0, 'perf_half_y_percentage': 12.33, 'book_sh': 4.36, 'p_b': 0.58, 'eps_next_y_percentage_percentage': 173.3, 'roa_percentage': -4.4, 'target_price': 1.91, 'perf_year_percentage': -24.33, 'cash_sh': 0.99, 'p_c': 2.58, 'eps_next_5y_percentage': 2.0, 'roe_percentage': -23.7, 'range_from_52w': 0.99, 'range_to_52w': '4.65', 'perf_ytd_percentage': 86.13, 'dividend': 0.16, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -1.9, 'high_52w_percentage': -45.16, 'beta': None, 'dividend_percentage': 6.27, 'quick_ratio': 1.5, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 63.6, 'low_52w_percentage': 157.58, 'atr': '0.18', 'employees': 830.0, 'current_ratio': 1.5, 'sales_q_q_percentage': -67.3, 'oper_margin_percentage': -17.5, 'rsi_14': 74.2, 'volatility_w_percentage': 17.27, 'volatility_m_percentage': 8.89, 'optionable': True, 'debt_eq': 2.53, 'eps_q_q_percentage': -294.0, 'profit_margin_percentage': -35.1, 'rel_volume': '9.94', 'prev_close': '1.81', 'shortable': True, 'lt_debt_eq': 2.38, 'payout_percentage': None, 'avg_volume': 25960.0, 'recom': 3.2, 'sma20_percentage': 45.59, 'sma50_percentage': 43.36, 'sma200_percentage': 8.27, 'short_float_percentage': 0.12, 'short_float_ratio': 6.42, 'earnings_date': datetime.datetime(2023, 3, 9, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'DFLI', 'market_cap': 119020000.0, 'p_e': None, 'price': 3.6, 'change_percentage': 0.3091, 'volume': 224112.0, 'signals': "['Earnings After', 'Most Volatile', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': -0.13, 'insider_own_percentage': 62.0, 'shs_outstand': 15810000.0, 'perf_week_percentage': -9.32, 'forward_p_e': None, 'eps_next_y': -0.18, 'insider_trans_percentage': 0.0, 'shs_float': 9300000.0, 'perf_month_percentage': -43.93, 'income': -2100000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 11.9, 'perf_quarter_percentage': -74.79, 'sales': 86220000.0, 'p_s': 1.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': -70.82, 'short_interest': 260000.0, 'perf_half_y_percentage': -65.01, 'book_sh': 1.83, 'p_b': 1.97, 'eps_next_y_percentage_percentage': 63.3, 'roa_percentage': -2.0, 'target_price': 12.33, 'perf_year_percentage': -64.0, 'cash_sh': 0.01, 'p_c': 396.72, 'eps_next_5y_percentage': None, 'roe_percentage': -2.0, 'range_from_52w': 2.62, 'range_to_52w': '28.75', 'perf_ytd_percentage': -69.75, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -87.48, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 0.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 37.16, 'atr': '0.58', 'employees': 168.0, 'current_ratio': 0.3, 'sales_q_q_percentage': 38.6, 'oper_margin_percentage': None, 'rsi_14': 35.33, 'volatility_w_percentage': 18.83, 'volatility_m_percentage': 12.88, 'optionable': True, 'debt_eq': 0.01, 'eps_q_q_percentage': -171.3, 'profit_margin_percentage': None, 'rel_volume': '1.46', 'prev_close': '2.75', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': 0.0, 'avg_volume': 152780.0, 'recom': 1.3, 'sma20_percentage': -14.58, 'sma50_percentage': -44.27, 'sma200_percentage': -61.66, 'short_float_percentage': 2.84, 'short_float_ratio': 1.73, 'earnings_date': datetime.datetime(2023, 3, 20, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'OPRT', 'market_cap': 94890000.0, 'p_e': None, 'price': 3.64, 'change_percentage': 0.2817, 'volume': 2556313.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.37, 'insider_own_percentage': 5.9, 'shs_outstand': 33240000.000000004, 'perf_week_percentage': -15.74, 'forward_p_e': 1.86, 'eps_next_y': 1.96, 'insider_trans_percentage': 6.29, 'shs_float': 30270000.0, 'perf_month_percentage': -48.59, 'income': -77700000.0, 'peg': None, 'eps_next_q': -0.41, 'inst_own_percentage': 72.1, 'perf_quarter_percentage': -33.82, 'sales': 640700000.0, 'p_s': 0.15, 'eps_this_y_percentage': -251.5, 'inst_trans_percentage': -4.65, 'short_interest': 990000.0, 'perf_half_y_percentage': -33.21, 'book_sh': 16.48, 'p_b': 0.22, 'eps_next_y_percentage_percentage': 160.51, 'roa_percentage': -2.3, 'target_price': 8.8, 'perf_year_percentage': -73.72, 'cash_sh': 3.79, 'p_c': 0.96, 'eps_next_5y_percentage': -3.8, 'roe_percentage': -13.0, 'range_from_52w': 2.19, 'range_to_52w': '14.91', 'perf_ytd_percentage': -33.94, 'dividend': None, 'p_fcf': 0.39, 'eps_past_5y_percentage': -44.0, 'roi_percentage': -2.2, 'high_52w_percentage': -75.59, 'beta': 1.77, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': 14.6, 'gross_margin_percentage': None, 'low_52w_percentage': 66.2, 'atr': '0.54', 'employees': 3000.0, 'current_ratio': None, 'sales_q_q_percentage': -10.7, 'oper_margin_percentage': -11.8, 'rsi_14': 33.75, 'volatility_w_percentage': 26.02, 'volatility_m_percentage': 11.33, 'optionable': True, 'debt_eq': 5.35, 'eps_q_q_percentage': -151.6, 'profit_margin_percentage': -12.1, 'rel_volume': '7.24', 'prev_close': '2.84', 'shortable': True, 'lt_debt_eq': 5.35, 'payout_percentage': None, 'avg_volume': 388380.0, 'recom': 2.0, 'sma20_percentage': -31.22, 'sma50_percentage': -39.63, 'sma200_percentage': -44.59, 'short_float_percentage': 3.27, 'short_float_ratio': 2.55, 'earnings_date': datetime.datetime(2023, 3, 13, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'PYXS', 'market_cap': 75790000.0, 'p_e': None, 'price': 2.76, 'change_percentage': 0.2778, 'volume': 507249.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -3.16, 'insider_own_percentage': 11.9, 'shs_outstand': 32560000.000000004, 'perf_week_percentage': 55.93, 'forward_p_e': None, 'eps_next_y': -3.09, 'insider_trans_percentage': 0.0, 'shs_float': 27750000.0, 'perf_month_percentage': 78.06, 'income': -101400000.0, 'peg': None, 'eps_next_q': -0.93, 'inst_own_percentage': 55.4, 'perf_quarter_percentage': 135.9, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -501.7, 'inst_trans_percentage': -3.76, 'short_interest': 170000.0, 'perf_half_y_percentage': 15.97, 'book_sh': 5.8, 'p_b': 0.48, 'eps_next_y_percentage_percentage': 15.6, 'roa_percentage': -40.6, 'target_price': 11.0, 'perf_year_percentage': -41.89, 'cash_sh': 7.23, 'p_c': 0.38, 'eps_next_5y_percentage': None, 'roe_percentage': -45.3, 'range_from_52w': 1.1, 'range_to_52w': '5.78', 'perf_ytd_percentage': 105.97, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -52.25, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 10.6, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 150.91, 'atr': '0.23', 'employees': 73.0, 'current_ratio': 10.6, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 70.46, 'volatility_w_percentage': 15.17, 'volatility_m_percentage': 12.13, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -96.3, 'profit_margin_percentage': None, 'rel_volume': '5.25', 'prev_close': '2.16', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 101630.0, 'recom': 1.8, 'sma20_percentage': 32.44, 'sma50_percentage': 57.36, 'sma200_percentage': 36.79, 'short_float_percentage': 0.6, 'short_float_ratio': 1.65, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'OMGA', 'market_cap': 375550000.0, 'p_e': None, 'price': 9.78, 'change_percentage': 0.2522, 'volume': 268588.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -2.14, 'insider_own_percentage': 1.6, 'shs_outstand': 48010000.0, 'perf_week_percentage': 51.63, 'forward_p_e': None, 'eps_next_y': -2.38, 'insider_trans_percentage': None, 'shs_float': 46280000.0, 'perf_month_percentage': 76.22, 'income': -102700000.0, 'peg': None, 'eps_next_q': -0.59, 'inst_own_percentage': 88.8, 'perf_quarter_percentage': 51.39, 'sales': 2100000.0, 'p_s': 178.83, 'eps_this_y_percentage': 29.6, 'inst_trans_percentage': 0.35, 'short_interest': 380000.0, 'perf_half_y_percentage': 58.51, 'book_sh': 2.21, 'p_b': 4.43, 'eps_next_y_percentage_percentage': -27.2, 'roa_percentage': -56.6, 'target_price': 12.71, 'perf_year_percentage': 30.57, 'cash_sh': 3.25, 'p_c': 3.01, 'eps_next_5y_percentage': None, 'roe_percentage': -71.0, 'range_from_52w': 1.98, 'range_to_52w': '11.98', 'perf_ytd_percentage': 71.28, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -81.6, 'high_52w_percentage': -18.36, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 6.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 395.19, 'atr': '0.80', 'employees': 116.0, 'current_ratio': 6.3, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 74.34, 'volatility_w_percentage': 16.47, 'volatility_m_percentage': 10.4, 'optionable': True, 'debt_eq': 0.19, 'eps_q_q_percentage': -47.1, 'profit_margin_percentage': None, 'rel_volume': '3.85', 'prev_close': '7.81', 'shortable': True, 'lt_debt_eq': 0.16, 'payout_percentage': None, 'avg_volume': 71600.0, 'recom': 1.8, 'sma20_percentage': 51.92, 'sma50_percentage': 40.62, 'sma200_percentage': 78.03, 'short_float_percentage': 0.81, 'short_float_ratio': 5.26, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'RPHM', 'market_cap': 111920000.0, 'p_e': None, 'price': 5.71, 'change_percentage': 0.2522, 'volume': 109461.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': -2.0, 'insider_own_percentage': 1.2, 'shs_outstand': 24500000.0, 'perf_week_percentage': 34.35, 'forward_p_e': None, 'eps_next_y': -2.29, 'insider_trans_percentage': 0.0, 'shs_float': 23730000.0, 'perf_month_percentage': 103.93, 'income': -49000000.0, 'peg': None, 'eps_next_q': -0.6, 'inst_own_percentage': 75.4, 'perf_quarter_percentage': 166.82, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -102.3, 'inst_trans_percentage': 0.53, 'short_interest': 100000.0, 'perf_half_y_percentage': 17.73, 'book_sh': 4.57, 'p_b': 1.25, 'eps_next_y_percentage_percentage': -5.0, 'roa_percentage': -35.3, 'target_price': 26.33, 'perf_year_percentage': 66.96, 'cash_sh': 5.92, 'p_c': 0.96, 'eps_next_5y_percentage': None, 'roe_percentage': -37.8, 'range_from_52w': 1.79, 'range_to_52w': '5.20', 'perf_ytd_percentage': 145.06, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 9.81, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 12.8, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 218.99, 'atr': '0.44', 'employees': 32.0, 'current_ratio': 12.8, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 75.25, 'volatility_w_percentage': 12.46, 'volatility_m_percentage': 11.32, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -1.7, 'profit_margin_percentage': None, 'rel_volume': '2.12', 'prev_close': '4.56', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 52570.0, 'recom': 1.3, 'sma20_percentage': 49.35, 'sma50_percentage': 80.88, 'sma200_percentage': 94.6, 'short_float_percentage': 0.4, 'short_float_ratio': 1.81, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 8, 13)}  ... displaying 10 of 1884 total bound parameter sets ...  {'ticker': 'AGZD', 'market_cap': None, 'p_e': None, 'price': 43.29, 'change_percentage': -0.0053, 'volume': 42273.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': -0.6, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': -1.57, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': -0.92, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': -0.11, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -0.63, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 42.62, 'range_to_52w': '44.17', 'perf_ytd_percentage': -0.38, 'dividend': 1.25, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.99, 'beta': None, 'dividend_percentage': 2.89, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 1.57, 'atr': '0.29', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 39.18, 'volatility_w_percentage': 1.18, 'volatility_m_percentage': 0.54, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.42', 'prev_close': '43.52', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 99690.0, 'recom': None, 'sma20_percentage': -1.18, 'sma50_percentage': -1.12, 'sma200_percentage': -0.24, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 8, 13)}, {'ticker': 'NYF', 'market_cap': None, 'p_e': None, 'price': 53.19, 'change_percentage': 0.0059, 'volume': 23944.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.95, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 0.45, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.38, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 2.6, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -3.36, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 49.91, 'range_to_52w': '55.22', 'perf_ytd_percentage': 1.51, 'dividend': 1.1, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -3.68, 'beta': None, 'dividend_percentage': 2.07, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 6.57, 'atr': '0.24', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 62.47, 'volatility_w_percentage': 0.49, 'volatility_m_percentage': 0.34, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.40', 'prev_close': '52.88', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 59720.0, 'recom': None, 'sma20_percentage': 1.41, 'sma50_percentage': 0.31, 'sma200_percentage': 1.51, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 20, 8, 13)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
News, Blogs, Calendar, Insider Trades; 2023-03-20 08:59:02.961627
News, Blogs, Calendar, Insider Trades; 2023-03-20 09:59:02.534142
All Signal Screener; 2023-03-20 10:10:42.050103
News, Blogs, Calendar, Insider Trades; 2023-03-20 10:59:02.754307
News, Blogs, Calendar, Insider Trades; 2023-03-20 11:59:03.403063
All Signal Screener; 2023-03-20 12:12:37.775572
News, Blogs, Calendar, Insider Trades; 2023-03-20 12:59:02.397003
News, Blogs, Calendar, Insider Trades; 2023-03-20 13:59:03.066438
All Signal Screener; 2023-03-20 14:12:59.672708
News, Blogs, Calendar, Insider Trades; 2023-03-20 14:59:03.228972
News, Blogs, Calendar, Insider Trades; 2023-03-20 15:59:02.841289
All Signal Screener; 2023-03-20 16:13:00.592836
News, Blogs, Calendar, Insider Trades; 2023-03-20 16:59:03.243365
News, Blogs, Calendar, Insider Trades; 2023-03-20 17:59:02.950565
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 59, in <module>
    database_connection.update_sql_table("UPDATE api_requests SET updated_tickers = '{}'WHERE request_date = '{}'".format(updated_tickers, today), conn=transform_load_conn)
  File "/home/naveen/code/financial_data_analysis/scripts/database_connection.py", line 79, in update_sql_table
    conn.execute(statement)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1291, in execute
    return self._exec_driver_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1595, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "updated_tickers" of relation "api_requests" does not exist
LINE 1: UPDATE api_requests SET updated_tickers = 'None'WHERE reques...
                                ^

[SQL: UPDATE api_requests SET updated_tickers = 'None'WHERE request_date = '2023-03-20']
(Background on this error at: https://sqlalche.me/e/14/f405)
All Signal Screener; 2023-03-20 18:13:02.980848
News, Blogs, Calendar, Insider Trades; 2023-03-20 18:59:02.896080
News, Blogs, Calendar, Insider Trades; 2023-03-20 19:59:02.967618
All Signal Screener; 2023-03-20 20:13:48.329936
Ticker Data; 2023-03-20 20:40:23.955514
News, Blogs, Calendar, Insider Trades; 2023-03-20 20:59:03.116497
News, Blogs, Calendar, Insider Trades; 2023-03-20 21:59:03.198032
All Signal Screener; 2023-03-20 22:13:59.380504
News, Blogs, Calendar, Insider Trades; 2023-03-20 22:59:03.477543
News, Blogs, Calendar, Insider Trades; 2023-03-20 23:59:03.506236
All Signal Screener; 2023-03-21 00:12:47.297545
News, Blogs, Calendar, Insider Trades; 2023-03-21 00:59:03.270425
News, Blogs, Calendar, Insider Trades; 2023-03-21 01:59:02.998240
All Signal Screener; 2023-03-21 02:12:41.117191
News, Blogs, Calendar, Insider Trades; 2023-03-21 02:59:02.929222
News, Blogs, Calendar, Insider Trades; 2023-03-21 03:59:02.481018
All Signal Screener; 2023-03-21 04:12:58.284245
News, Blogs, Calendar, Insider Trades; 2023-03-21 04:59:02.916936
News, Blogs, Calendar, Insider Trades; 2023-03-21 05:59:02.507811
All Signal Screener; 2023-03-21 06:12:50.219854
News, Blogs, Calendar, Insider Trades; 2023-03-21 06:59:02.822151
News, Blogs, Calendar, Insider Trades; 2023-03-21 07:59:02.450263
All Signal Screener; 2023-03-21 08:13:05.019779
News, Blogs, Calendar, Insider Trades; 2023-03-21 08:59:02.565419
News, Blogs, Calendar, Insider Trades; 2023-03-21 09:59:03.055250
All Signal Screener; 2023-03-21 10:10:04.020885
News, Blogs, Calendar, Insider Trades; 2023-03-21 10:59:02.561187
News, Blogs, Calendar, Insider Trades; 2023-03-21 11:59:03.167367
All Signal Screener; 2023-03-21 12:11:51.781203
News, Blogs, Calendar, Insider Trades; 2023-03-21 12:59:02.415095
News, Blogs, Calendar, Insider Trades; 2023-03-21 13:59:02.966091
All Signal Screener; 2023-03-21 14:11:36.532450
News, Blogs, Calendar, Insider Trades; 2023-03-21 14:59:03.177767
News, Blogs, Calendar, Insider Trades; 2023-03-21 15:59:02.745276
All Signal Screener; 2023-03-21 16:11:57.203201
News, Blogs, Calendar, Insider Trades; 2023-03-21 16:59:02.853810
News, Blogs, Calendar, Insider Trades; 2023-03-21 17:59:02.847316
Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_financialStatements.py", line 67, in <module>
    get_data.update_financial_statements(ticker=ticker)
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 154, in update_financial_statements
    self.transform_load.transform_load_balance_sheets(data=data, ticker=ticker)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 435, in transform_load_balance_sheets
    data = self.format_statements(data, ticker, table='dim_balance_sheets')
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 187, in format_statements
    quarter_reports = pd.DataFrame(data=data['quarterlyReports'])
KeyError: 'quarterlyReports'
All Signal Screener; 2023-03-21 18:12:57.838482
News, Blogs, Calendar, Insider Trades; 2023-03-21 18:59:03.354760
News, Blogs, Calendar, Insider Trades; 2023-03-21 19:59:03.539986
All Signal Screener; 2023-03-21 20:12:45.085382
Ticker Data; 2023-03-21 20:40:23.417804
News, Blogs, Calendar, Insider Trades; 2023-03-21 20:59:03.479420
News, Blogs, Calendar, Insider Trades; 2023-03-21 21:59:03.433421
All Signal Screener; 2023-03-21 22:12:57.223362
News, Blogs, Calendar, Insider Trades; 2023-03-21 22:59:03.287617
News, Blogs, Calendar, Insider Trades; 2023-03-21 23:59:02.994933
All Signal Screener; 2023-03-22 00:12:31.551730
News, Blogs, Calendar, Insider Trades; 2023-03-22 00:59:03.080352
News, Blogs, Calendar, Insider Trades; 2023-03-22 01:59:02.702835
All Signal Screener; 2023-03-22 02:12:10.068737
News, Blogs, Calendar, Insider Trades; 2023-03-22 02:59:03.068980
News, Blogs, Calendar, Insider Trades; 2023-03-22 03:59:02.722498
All Signal Screener; 2023-03-22 04:12:09.320932
News, Blogs, Calendar, Insider Trades; 2023-03-22 04:59:02.956828
News, Blogs, Calendar, Insider Trades; 2023-03-22 05:59:02.808759
All Signal Screener; 2023-03-22 06:12:24.847956
News, Blogs, Calendar, Insider Trades; 2023-03-22 06:59:02.598745
News, Blogs, Calendar, Insider Trades; 2023-03-22 07:59:03.259324
All Signal Screener; 2023-03-22 08:12:21.658710
News, Blogs, Calendar, Insider Trades; 2023-03-22 08:59:03.282255
News, Blogs, Calendar, Insider Trades; 2023-03-22 09:59:02.852142
All Signal Screener; 2023-03-22 10:08:55.032148
News, Blogs, Calendar, Insider Trades; 2023-03-22 10:59:02.648781
News, Blogs, Calendar, Insider Trades; 2023-03-22 11:59:03.262535
All Signal Screener; 2023-03-22 12:11:24.891575
News, Blogs, Calendar, Insider Trades; 2023-03-22 12:59:02.431072
News, Blogs, Calendar, Insider Trades; 2023-03-22 13:59:02.973361
All Signal Screener; 2023-03-22 14:11:43.298287
News, Blogs, Calendar, Insider Trades; 2023-03-22 14:59:02.802829
News, Blogs, Calendar, Insider Trades; 2023-03-22 15:59:02.590102
All Signal Screener; 2023-03-22 16:13:43.183398
News, Blogs, Calendar, Insider Trades; 2023-03-22 16:59:03.309552
News, Blogs, Calendar, Insider Trades; 2023-03-22 17:59:02.983622
['AAPL']
[]
['AAPL', 'CM', 'CRM', 'SHOP']
All Signal Screener; 2023-03-22 18:11:47.863255
News, Blogs, Calendar, Insider Trades; 2023-03-22 18:59:02.830290
News, Blogs, Calendar, Insider Trades; 2023-03-22 19:59:02.869250
All Signal Screener; 2023-03-22 20:12:49.046948
Ticker Data; 2023-03-22 20:40:29.593467
News, Blogs, Calendar, Insider Trades; 2023-03-22 20:59:02.981306
News, Blogs, Calendar, Insider Trades; 2023-03-22 21:59:04.933498
All Signal Screener; 2023-03-22 22:16:45.661214
News, Blogs, Calendar, Insider Trades; 2023-03-22 22:59:03.915609
News, Blogs, Calendar, Insider Trades; 2023-03-22 23:59:03.515782
All Signal Screener; 2023-03-23 00:23:06.145271
News, Blogs, Calendar, Insider Trades; 2023-03-23 00:59:04.258122
News, Blogs, Calendar, Insider Trades; 2023-03-23 01:59:04.012476
All Signal Screener; 2023-03-23 02:18:58.627022
News, Blogs, Calendar, Insider Trades; 2023-03-23 02:59:04.284933
News, Blogs, Calendar, Insider Trades; 2023-03-23 03:59:03.459908
All Signal Screener; 2023-03-23 04:21:24.221369
News, Blogs, Calendar, Insider Trades; 2023-03-23 04:59:05.524273
News, Blogs, Calendar, Insider Trades; 2023-03-23 05:59:04.276597
All Signal Screener; 2023-03-23 06:21:07.665491
News, Blogs, Calendar, Insider Trades; 2023-03-23 06:59:03.869821
News, Blogs, Calendar, Insider Trades; 2023-03-23 07:59:03.981457
All Signal Screener; 2023-03-23 08:21:20.686088
News, Blogs, Calendar, Insider Trades; 2023-03-23 08:59:03.258102
News, Blogs, Calendar, Insider Trades; 2023-03-23 09:59:02.898258
All Signal Screener; 2023-03-23 10:10:12.944792
News, Blogs, Calendar, Insider Trades; 2023-03-23 10:59:02.626188
News, Blogs, Calendar, Insider Trades; 2023-03-23 11:59:03.458822
All Signal Screener; 2023-03-23 12:13:01.246897
News, Blogs, Calendar, Insider Trades; 2023-03-23 12:59:03.249038
News, Blogs, Calendar, Insider Trades; 2023-03-23 13:59:02.861486
All Signal Screener; 2023-03-23 14:12:52.126655
News, Blogs, Calendar, Insider Trades; 2023-03-23 14:59:03.179228
News, Blogs, Calendar, Insider Trades; 2023-03-23 15:59:03.232600
All Signal Screener; 2023-03-23 16:14:26.557049
News, Blogs, Calendar, Insider Trades; 2023-03-23 16:59:03.229432
News, Blogs, Calendar, Insider Trades; 2023-03-23 17:59:03.060265
 AAPL financial statements and earnings; 2023-03-23 18:01:02.831262
 CM financial statements and earnings; 2023-03-23 18:02:05.539872
 CRM financial statements and earnings; 2023-03-23 18:03:07.486696
 SHOP financial statements and earnings; 2023-03-23 18:04:09.559964
All Signal Screener; 2023-03-23 18:13:22.881253
News, Blogs, Calendar, Insider Trades; 2023-03-23 18:59:02.491688
News, Blogs, Calendar, Insider Trades; 2023-03-23 19:59:03.189618
All Signal Screener; 2023-03-23 20:15:02.264896
Ticker Data; 2023-03-23 20:40:22.844441
News, Blogs, Calendar, Insider Trades; 2023-03-23 20:59:02.483937
News, Blogs, Calendar, Insider Trades; 2023-03-23 21:59:03.907231
All Signal Screener; 2023-03-23 22:18:01.806782
News, Blogs, Calendar, Insider Trades; 2023-03-23 22:59:02.592048
News, Blogs, Calendar, Insider Trades; 2023-03-23 23:59:03.245279
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 449, in _make_request
    six.raise_from(e, None)
  File "<string>", line 3, in raise_from
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 444, in _make_request
    httplib_response = conn.getresponse()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/http/client.py", line 1374, in getresponse
    response.begin()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/http/client.py", line 279, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/ssl.py", line 1274, in recv_into
    return self.read(nbytes, buffer)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/ssl.py", line 1130, in read
    return self._sslobj.read(len, buffer)
TimeoutError: The read operation timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/adapters.py", line 489, in send
    resp = conn.urlopen(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/util/retry.py", line 550, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 451, in _make_request
    self._raise_timeout(err=e, url=url, timeout_value=read_timeout)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/urllib3/connectionpool.py", line 340, in _raise_timeout
    raise ReadTimeoutError(
urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='finviz.com', port=443): Read timed out. (read timeout=10)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/util.py", line 96, in web_scrap
    website = session.get(url, headers=headers, timeout=10)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/sessions.py", line 600, in get
    return self.request("GET", url, **kwargs)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/sessions.py", line 587, in request
    resp = self.send(prep, **send_kwargs)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/sessions.py", line 701, in send
    r = adapter.send(request, **kwargs)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/adapters.py", line 578, in send
    raise ReadTimeout(e, request=request)
requests.exceptions.ReadTimeout: HTTPSConnectionPool(host='finviz.com', port=443): Read timed out. (read timeout=10)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 188, in update_screeners
    one_signal_df = screener.screener_view(verbose=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/screener/overview.py", line 303, in screener_view
    soup = web_scrap(url)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/util.py", line 102, in web_scrap
    raise Exception(err)
Exception: HTTPSConnectionPool(host='finviz.com', port=443): Read timed out. (read timeout=10)
News, Blogs, Calendar, Insider Trades; 2023-03-24 00:59:03.049751
News, Blogs, Calendar, Insider Trades; 2023-03-24 01:59:03.129808
All Signal Screener; 2023-03-24 02:18:46.032244
News, Blogs, Calendar, Insider Trades; 2023-03-24 02:59:02.764541
News, Blogs, Calendar, Insider Trades; 2023-03-24 03:59:03.589802
All Signal Screener; 2023-03-24 04:18:08.260223
News, Blogs, Calendar, Insider Trades; 2023-03-24 04:59:03.140755
News, Blogs, Calendar, Insider Trades; 2023-03-24 05:59:02.941558
All Signal Screener; 2023-03-24 06:18:19.133749
News, Blogs, Calendar, Insider Trades; 2023-03-24 06:59:02.879731
News, Blogs, Calendar, Insider Trades; 2023-03-24 07:59:03.678394
All Signal Screener; 2023-03-24 08:17:47.386158
News, Blogs, Calendar, Insider Trades; 2023-03-24 08:59:03.304296
News, Blogs, Calendar, Insider Trades; 2023-03-24 09:59:03.138607
All Signal Screener; 2023-03-24 10:13:23.765074
News, Blogs, Calendar, Insider Trades; 2023-03-24 10:59:11.677254
News, Blogs, Calendar, Insider Trades; 2023-03-24 11:59:03.155614
All Signal Screener; 2023-03-24 12:11:49.518875
News, Blogs, Calendar, Insider Trades; 2023-03-24 12:59:03.161415
News, Blogs, Calendar, Insider Trades; 2023-03-24 13:59:02.712535
All Signal Screener; 2023-03-24 14:11:53.528382
News, Blogs, Calendar, Insider Trades; 2023-03-24 14:59:03.395113
News, Blogs, Calendar, Insider Trades; 2023-03-24 15:59:03.348094
All Signal Screener; 2023-03-24 16:13:38.906311
News, Blogs, Calendar, Insider Trades; 2023-03-24 16:59:02.703307
News, Blogs, Calendar, Insider Trades; 2023-03-24 17:59:04.625113
All Signal Screener; 2023-03-24 18:12:45.786857
News, Blogs, Calendar, Insider Trades; 2023-03-24 18:59:02.970246
News, Blogs, Calendar, Insider Trades; 2023-03-24 19:59:02.952151
All Signal Screener; 2023-03-24 20:12:56.194661
Ticker Data; 2023-03-24 20:40:23.924714
News, Blogs, Calendar, Insider Trades; 2023-03-24 20:59:03.118038
News, Blogs, Calendar, Insider Trades; 2023-03-24 21:59:03.179953
News, Blogs, Calendar, Insider Trades; 2023-03-24 22:59:03.301944
News, Blogs, Calendar, Insider Trades; 2023-03-24 23:59:03.265546
All Signal Screener; 2023-03-25 00:13:01.191306
News, Blogs, Calendar, Insider Trades; 2023-03-25 00:59:03.413305
News, Blogs, Calendar, Insider Trades; 2023-03-25 01:59:03.153370
All Signal Screener; 2023-03-25 02:12:52.807769
News, Blogs, Calendar, Insider Trades; 2023-03-25 02:59:02.678944
News, Blogs, Calendar, Insider Trades; 2023-03-25 03:59:03.242325
All Signal Screener; 2023-03-25 04:12:30.988166
News, Blogs, Calendar, Insider Trades; 2023-03-25 04:59:02.861540
News, Blogs, Calendar, Insider Trades; 2023-03-25 05:59:02.411228
All Signal Screener; 2023-03-25 06:12:31.586946
News, Blogs, Calendar, Insider Trades; 2023-03-25 06:59:03.511035
News, Blogs, Calendar, Insider Trades; 2023-03-25 07:59:03.074898
All Signal Screener; 2023-03-25 08:12:53.261214
News, Blogs, Calendar, Insider Trades; 2023-03-25 08:59:02.845891
News, Blogs, Calendar, Insider Trades; 2023-03-25 09:59:02.437712
All Signal Screener; 2023-03-25 10:12:37.626299
News, Blogs, Calendar, Insider Trades; 2023-03-25 10:59:03.599054
News, Blogs, Calendar, Insider Trades; 2023-03-25 11:59:03.799576
All Signal Screener; 2023-03-25 12:12:48.413263
News, Blogs, Calendar, Insider Trades; 2023-03-25 12:59:02.956125
News, Blogs, Calendar, Insider Trades; 2023-03-25 13:59:02.734168
All Signal Screener; 2023-03-25 14:12:22.892282
News, Blogs, Calendar, Insider Trades; 2023-03-25 14:59:02.478658
News, Blogs, Calendar, Insider Trades; 2023-03-25 15:59:03.291785
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.AdminShutdown: terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 553, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1728, in to_sql
    table = self.prep_table(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1631, in prep_table
    table.create()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 827, in create
    if self.exists():
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 814, in exists
    return self.pd_sql.has_table(self.name, self.schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1761, in has_table
    return insp.has_table(name, schema or self.meta.schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/reflection.py", line 283, in has_table
    return self.dialect.has_table(conn, table_name, schema)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/base.py", line 3496, in has_table
    cursor = connection.execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1819, in _execute_context
    self.dialect.do_execute(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 732, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (psycopg2.errors.AdminShutdown) terminating connection due to administrator command
server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

[SQL: select relname from pg_class c join pg_namespace n on n.oid=c.relnamespace where pg_catalog.pg_table_is_visible(c.oid) and relname=%(name)s]
[parameters: {'name': 'all_signal_screener'}]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
News, Blogs, Calendar, Insider Trades; 2023-03-25 16:59:02.645807
News, Blogs, Calendar, Insider Trades; 2023-03-25 17:59:03.269883
All Signal Screener; 2023-03-25 18:12:47.145170
News, Blogs, Calendar, Insider Trades; 2023-03-25 18:59:10.338625
News, Blogs, Calendar, Insider Trades; 2023-03-25 19:59:03.485325
All Signal Screener; 2023-03-25 20:13:58.546733
News, Blogs, Calendar, Insider Trades; 2023-03-25 20:59:03.674604
News, Blogs, Calendar, Insider Trades; 2023-03-25 21:59:08.319709
All Signal Screener; 2023-03-25 22:13:33.733241
News, Blogs, Calendar, Insider Trades; 2023-03-25 22:59:02.741538
News, Blogs, Calendar, Insider Trades; 2023-03-25 23:59:02.796901
All Signal Screener; 2023-03-26 00:13:36.155628
News, Blogs, Calendar, Insider Trades; 2023-03-26 00:59:03.167542
News, Blogs, Calendar, Insider Trades; 2023-03-26 01:59:03.577528
All Signal Screener; 2023-03-26 02:13:14.191360
News, Blogs, Calendar, Insider Trades; 2023-03-26 02:59:03.271453
News, Blogs, Calendar, Insider Trades; 2023-03-26 12:59:02.573025
News, Blogs, Calendar, Insider Trades; 2023-03-26 14:59:03.235599
News, Blogs, Calendar, Insider Trades; 2023-03-26 15:59:02.726301
News, Blogs, Calendar, Insider Trades; 2023-03-26 16:59:03.265249
News, Blogs, Calendar, Insider Trades; 2023-03-26 17:59:02.757605
News, Blogs, Calendar, Insider Trades; 2023-03-26 18:59:03.008224
News, Blogs, Calendar, Insider Trades; 2023-03-26 19:59:02.624066
News, Blogs, Calendar, Insider Trades; 2023-03-26 20:59:03.260994
News, Blogs, Calendar, Insider Trades; 2023-03-26 21:59:02.923849
News, Blogs, Calendar, Insider Trades; 2023-03-26 22:59:03.225535
News, Blogs, Calendar, Insider Trades; 2023-03-26 23:59:03.051863
News, Blogs, Calendar, Insider Trades; 2023-03-27 00:59:02.799047
News, Blogs, Calendar, Insider Trades; 2023-03-27 01:59:02.742433
News, Blogs, Calendar, Insider Trades; 2023-03-27 02:59:03.351108
News, Blogs, Calendar, Insider Trades; 2023-03-27 03:59:03.023317
News, Blogs, Calendar, Insider Trades; 2023-03-27 04:59:02.983148
News, Blogs, Calendar, Insider Trades; 2023-03-27 05:59:02.651028
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "-"
LINE 1: ....2, 7.5,  -83.64, 1.32, 0.88, NULL,  -58.7, NULL, '-',  -56....
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 573, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "-"
LINE 1: ....2, 7.5,  -83.64, 1.32, 0.88, NULL,  -58.7, NULL, '-',  -56....
                                                             ^

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'SI', 'market_cap': 35790000.0, 'p_e': None, 'price': 1.72, 'change_percentage': 0.5221, 'volume': 141494864.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -29.96, 'insider_own_percentage': 0.2, 'shs_outstand': 31660000.0, 'perf_week_percentage': -16.1, 'forward_p_e': 1.72, 'eps_next_y': 1.0, 'insider_trans_percentage': 0.0, 'shs_float': 25710000.0, 'perf_month_percentage': -88.84, 'income': -948700000.0, 'peg': None, 'eps_next_q': -0.06, 'inst_own_percentage': 79.9, 'perf_quarter_percentage': -89.76, 'sales': 327300000.0, 'p_s': 0.11, 'eps_this_y_percentage': 114.5, 'inst_trans_percentage': -1.53, 'short_interest': 19890000.0, 'perf_half_y_percentage': -97.73, 'book_sh': 42.06, 'p_b': 0.04, 'eps_next_y_percentage_percentage': 233.0, 'roa_percentage': 0.6, 'target_price': 4.0, 'perf_year_percentage': -98.8, 'cash_sh': 100.98, 'p_c': 0.02, 'eps_next_5y_percentage': 33.8, 'roe_percentage': 6.9, 'range_from_52w': 1.12, 'range_to_52w': '162.65', 'perf_ytd_percentage': -90.11, 'dividend': None, 'p_fcf': 0.29, 'eps_past_5y_percentage': 50.6, 'roi_percentage': 7.5, 'high_52w_percentage': -98.94, 'beta': 2.53, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': 25.7, 'gross_margin_percentage': None, 'low_52w_percentage': 53.57, 'atr': '1.35', 'employees': 279.0, 'current_ratio': None, 'sales_q_q_percentage': 139.6, 'oper_margin_percentage': 60.9, 'rsi_14': 26.74, 'volatility_w_percentage': 39.85, 'volatility_m_percentage': 31.66, 'optionable': True, 'debt_eq': 0.01, 'eps_q_q_percentage': 45.6, 'profit_margin_percentage': 31.3, 'rel_volume': '9.49', 'prev_close': '1.13', 'shortable': True, 'lt_debt_eq': 0.01, 'payout_percentage': 0.0, 'avg_volume': 16930000.0, 'recom': 4.7, 'sma20_percentage': -67.14, 'sma50_percentage': -85.02, 'sma200_percentage': -96.46, 'short_float_percentage': 77.37, 'short_float_ratio': 1.18, 'earnings_date': datetime.datetime(2023, 1, 17, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'NAAS', 'market_cap': 895170000.0, 'p_e': 0.05, 'price': 5.8, 'change_percentage': 0.3876, 'volume': 2223997.0, 'signals': "['Double Bottom', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 108.69, 'insider_own_percentage': None, 'shs_outstand': 214160000.0, 'perf_week_percentage': 40.78, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 49400000.0, 'perf_month_percentage': 13.73, 'income': -47400000.0, 'peg': 0.0, 'eps_next_q': None, 'inst_own_percentage': 0.3, 'perf_quarter_percentage': 24.73, 'sales': 32580000.0, 'p_s': 27.48, 'eps_this_y_percentage': None, 'inst_trans_percentage': -7.58, 'short_interest': 70000.0, 'perf_half_y_percentage': 13.61, 'book_sh': 0.29, 'p_b': 20.0, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': 34.1, 'cash_sh': 0.39, 'p_c': 14.75, 'eps_next_5y_percentage': 24.57, 'roe_percentage': None, 'range_from_52w': 2.75, 'range_to_52w': '22.45', 'perf_ytd_percentage': 49.1, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 36.1, 'roi_percentage': None, 'high_52w_percentage': -74.16, 'beta': 1.12, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 110.91, 'atr': '0.44', 'employees': 3621.0, 'current_ratio': 3.5, 'sales_q_q_percentage': -95.9, 'oper_margin_percentage': None, 'rsi_14': 63.92, 'volatility_w_percentage': 12.76, 'volatility_m_percentage': 8.97, 'optionable': True, 'debt_eq': 0.02, 'eps_q_q_percentage': 95.2, 'profit_margin_percentage': None, 'rel_volume': '10.51', 'prev_close': '4.18', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 243900.0, 'recom': 3.0, 'sma20_percentage': 26.47, 'sma50_percentage': 15.55, 'sma200_percentage': 8.98, 'short_float_percentage': 0.15, 'short_float_ratio': 0.31, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'PHAR', 'market_cap': 692350000.0, 'p_e': 26.71, 'price': 14.96, 'change_percentage': 0.3274, 'volume': 697428.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 0.56, 'insider_own_percentage': None, 'shs_outstand': 65629999.99999999, 'perf_week_percentage': 38.91, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 65629999.99999999, 'perf_month_percentage': 26.78, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 0.05, 'perf_quarter_percentage': 35.34, 'sales': 205620000.0, 'p_s': 3.37, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': 0.0, 'perf_half_y_percentage': 32.98, 'book_sh': 3.25, 'p_b': 4.6, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': 7.84, 'perf_year_percentage': 87.0, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 6.1, 'range_to_52w': '15.00', 'perf_ytd_percentage': 35.63, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -0.27, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 145.25, 'atr': '1.48', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': -9.3, 'oper_margin_percentage': None, 'rsi_14': 67.34, 'volatility_w_percentage': 24.19, 'volatility_m_percentage': 10.78, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '105.38', 'prev_close': '11.27', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 18210.0, 'recom': None, 'sma20_percentage': 26.95, 'sma50_percentage': 18.69, 'sma200_percentage': 38.78, 'short_float_percentage': 0.0, 'short_float_ratio': 0.05, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'RBOT', 'market_cap': 188900000.0, 'p_e': 39.58, 'price': 1.9, 'change_percentage': 0.2667, 'volume': 2098924.0, 'signals': "['Most Volatile', 'Recent Insider Selling', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 0.05, 'insider_own_percentage': 6.1, 'shs_outstand': 123560000.0, 'perf_week_percentage': -20.5, 'forward_p_e': None, 'eps_next_y': -0.67, 'insider_trans_percentage': 2.68, 'shs_float': 60080000.0, 'perf_month_percentage': -34.26, 'income': 5200000.0, 'peg': None, 'eps_next_q': -0.14, 'inst_own_percentage': 39.0, 'perf_quarter_percentage': 0.53, 'sales': None, 'p_s': None, 'eps_this_y_percentage': 113.8, 'inst_trans_percentage': 0.3, 'short_interest': 5350000.0, 'perf_half_y_percentage': -49.06, 'book_sh': 0.9, 'p_b': 2.11, 'eps_next_y_percentage_percentage': -1750.0, 'roa_percentage': 3.2, 'target_price': 7.75, 'perf_year_percentage': -61.46, 'cash_sh': 1.17, 'p_c': 1.63, 'eps_next_5y_percentage': None, 'roe_percentage': 4.3, 'range_from_52w': 1.36, 'range_to_52w': '5.12', 'perf_ytd_percentage': -5.94, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -62.89, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 14.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 39.71, 'atr': '0.25', 'employees': 213.0, 'current_ratio': 14.3, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 38.15, 'volatility_w_percentage': 23.73, 'volatility_m_percentage': 10.68, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': -149.7, 'profit_margin_percentage': None, 'rel_volume': '5.27', 'prev_close': '1.50', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': 0.0, 'avg_volume': 423570.0, 'recom': 1.7, 'sma20_percentage': -22.78, 'sma50_percentage': -29.71, 'sma200_percentage': -41.54, 'short_float_percentage': 8.91, 'short_float_ratio': 12.63, 'earnings_date': datetime.datetime(2023, 2, 13, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'ECOR', 'market_cap': 20290000.0, 'p_e': None, 'price': 5.34, 'change_percentage': 0.2477, 'volume': 215529.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -4.69, 'insider_own_percentage': 8.9, 'shs_outstand': 4740000.0, 'perf_week_percentage': 62.31, 'forward_p_e': None, 'eps_next_y': -2.6, 'insider_trans_percentage': 260.94, 'shs_float': 220000.0, 'perf_month_percentage': 47.51, 'income': -22200000.0, 'peg': None, 'eps_next_q': -1.0, 'inst_own_percentage': 18.5, 'perf_quarter_percentage': 12.3, 'sales': 8600000.0, 'p_s': 2.36, 'eps_this_y_percentage': -7.4, 'inst_trans_percentage': -17.2, 'short_interest': 80000.0, 'perf_half_y_percentage': -24.4, 'book_sh': 3.6, 'p_b': 1.48, 'eps_next_y_percentage_percentage': 16.1, 'roa_percentage': -71.0, 'target_price': 23.67, 'perf_year_percentage': -43.44, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': -90.2, 'range_from_52w': 2.92, 'range_to_52w': '10.50', 'perf_ytd_percentage': 38.66, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 24.3, 'roi_percentage': -131.2, 'high_52w_percentage': -49.16, 'beta': 1.08, 'dividend_percentage': None, 'quick_ratio': 2.7, 'sales_past_5y_percentage': 60.3, 'gross_margin_percentage': 81.2, 'low_52w_percentage': 82.56, 'atr': '0.43', 'employees': 62.0, 'current_ratio': 3.0, 'sales_q_q_percentage': 73.3, 'oper_margin_percentage': None, 'rsi_14': 71.89, 'volatility_w_percentage': 15.73, 'volatility_m_percentage': 9.25, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -16.4, 'profit_margin_percentage': None, 'rel_volume': '9.81', 'prev_close': '4.28', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 25010.0, 'recom': 2.0, 'sma20_percentage': 52.01, 'sma50_percentage': 21.01, 'sma200_percentage': -11.76, 'short_float_percentage': 36.26, 'short_float_ratio': 3.22, 'earnings_date': datetime.datetime(2023, 3, 8, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'DNMR', 'market_cap': 211890000.0, 'p_e': None, 'price': 2.59, 'change_percentage': 0.23920000000000002, 'volume': 1969532.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -1.62, 'insider_own_percentage': 0.4, 'shs_outstand': 101390000.0, 'perf_week_percentage': 23.92, 'forward_p_e': None, 'eps_next_y': -0.92, 'insider_trans_percentage': -15.49, 'shs_float': 90450000.0, 'perf_month_percentage': 29.5, 'income': -164200000.0, 'peg': None, 'eps_next_q': -0.29, 'inst_own_percentage': 45.1, 'perf_quarter_percentage': 45.51, 'sales': 55600000.0, 'p_s': 3.81, 'eps_this_y_percentage': -516.6, 'inst_trans_percentage': -1.78, 'short_interest': 16710000.0, 'perf_half_y_percentage': -20.55, 'book_sh': 3.87, 'p_b': 0.67, 'eps_next_y_percentage_percentage': 31.3, 'roa_percentage': -20.7, 'target_price': 4.17, 'perf_year_percentage': -56.83, 'cash_sh': 1.21, 'p_c': 2.14, 'eps_next_5y_percentage': None, 'roe_percentage': -35.5, 'range_from_52w': 1.57, 'range_to_52w': '6.78', 'perf_ytd_percentage': 44.69, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -11.4, 'high_52w_percentage': -61.77, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 4.0, 'sales_past_5y_percentage': None, 'gross_margin_percentage': -9.1, 'low_52w_percentage': 64.97, 'atr': '0.24', 'employees': 282.0, 'current_ratio': 5.2, 'sales_q_q_percentage': -22.4, 'oper_margin_percentage': None, 'rsi_14': 59.28, 'volatility_w_percentage': 14.43, 'volatility_m_percentage': 11.56, 'optionable': True, 'debt_eq': 0.73, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '1.48', 'prev_close': '2.09', 'shortable': False, 'lt_debt_eq': 0.73, 'payout_percentage': None, 'avg_volume': 1320000.0, 'recom': 1.7, 'sma20_percentage': 15.65, 'sma50_percentage': 14.34, 'sma200_percentage': -18.24, 'short_float_percentage': 18.48, 'short_float_ratio': 12.63, 'earnings_date': datetime.datetime(2023, 3, 28, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'AGBA', 'market_cap': 118710000.0, 'p_e': None, 'price': 2.44, 'change_percentage': 0.2386, 'volume': 271368.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -0.08, 'insider_own_percentage': 91.3, 'shs_outstand': 4740000.0, 'perf_week_percentage': 50.62, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 3860000.0, 'perf_month_percentage': 16.19, 'income': -400000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 3.7, 'perf_quarter_percentage': 25.13, 'sales': 11430000.0, 'p_s': 10.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': 0.73, 'short_interest': 50000.0, 'perf_half_y_percentage': -78.54, 'book_sh': 6.39, 'p_b': 0.38, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -1.0, 'target_price': None, 'perf_year_percentage': -77.61, 'cash_sh': 0.0, 'p_c': 1187.06, 'eps_next_5y_percentage': None, 'roe_percentage': -1.3, 'range_from_52w': 1.31, 'range_to_52w': '11.81', 'perf_ytd_percentage': 58.44, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -79.34, 'beta': 0.31, 'dividend_percentage': None, 'quick_ratio': 0.0, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 86.25, 'atr': '0.33', 'employees': None, 'current_ratio': 0.0, 'sales_q_q_percentage': 43.4, 'oper_margin_percentage': None, 'rsi_14': 58.72, 'volatility_w_percentage': 22.36, 'volatility_m_percentage': 16.45, 'optionable': False, 'debt_eq': 0.17, 'eps_q_q_percentage': 330.6, 'profit_margin_percentage': None, 'rel_volume': '2.42', 'prev_close': '1.97', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 111110.0, 'recom': None, 'sma20_percentage': 20.26, 'sma50_percentage': 4.31, 'sma200_percentage': -66.76, 'short_float_percentage': 1.26, 'short_float_ratio': 0.44, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'CCM', 'market_cap': 47800000.0, 'p_e': None, 'price': 1.36, 'change_percentage': 0.2364, 'volume': 13751.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.99, 'insider_own_percentage': 18.0, 'shs_outstand': 43690000.0, 'perf_week_percentage': 11.48, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 23090000.0, 'perf_month_percentage': 16.24, 'income': -43400000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 0.4, 'perf_quarter_percentage': -8.11, 'sales': 64099999.99999999, 'p_s': 0.75, 'eps_this_y_percentage': 12.4, 'inst_trans_percentage': -10.79, 'short_interest': 0.0, 'perf_half_y_percentage': -32.67, 'book_sh': -5.15, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -4.9, 'target_price': None, 'perf_year_percentage': -32.0, 'cash_sh': 0.33, 'p_c': 4.16, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 26.2, 'range_from_52w': 1.03, 'range_to_52w': '2.20', 'perf_ytd_percentage': -17.07, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -0.7, 'roi_percentage': -40.8, 'high_52w_percentage': -38.18, 'beta': -0.21, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 1.3, 'gross_margin_percentage': -33.9, 'low_52w_percentage': 32.04, 'atr': '0.11', 'employees': 972.0, 'current_ratio': 0.7, 'sales_q_q_percentage': 73.9, 'oper_margin_percentage': None, 'rsi_14': 54.08, 'volatility_w_percentage': 5.17, 'volatility_m_percentage': 8.33, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': 11.5, 'profit_margin_percentage': -67.7, 'rel_volume': '5.90', 'prev_close': '1.10', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 2520.0, 'recom': None, 'sma20_percentage': 5.81, 'sma50_percentage': 0.9, 'sma200_percentage': -16.51, 'short_float_percentage': 0.01, 'short_float_ratio': 1.05, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 6, 12)}  ... displaying 10 of 1838 total bound parameter sets ...  {'ticker': 'NEXA', 'market_cap': 799900000.0, 'p_e': 16.15, 'price': 5.99, 'change_percentage': -0.0083, 'volume': 30357.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': 0.37, 'insider_own_percentage': 64.68, 'shs_outstand': 132440000.0, 'perf_week_percentage': 7.73, 'forward_p_e': 9.88, 'eps_next_y': 0.61, 'insider_trans_percentage': 0.0, 'shs_float': 46780000.0, 'perf_month_percentage': -0.5, 'income': 49100000.0, 'peg': None, 'eps_next_q': 0.12, 'inst_own_percentage': 24.2, 'perf_quarter_percentage': 10.52, 'sales': 3030000000.0, 'p_s': 0.26, 'eps_this_y_percentage': -57.1, 'inst_trans_percentage': -0.28, 'short_interest': 160000.0, 'perf_half_y_percentage': 6.02, 'book_sh': 10.89, 'p_b': 0.55, 'eps_next_y_percentage_percentage': -43.68, 'roa_percentage': 1.0, 'target_price': 7.83, 'perf_year_percentage': -33.74, 'cash_sh': 3.86, 'p_c': 1.55, 'eps_next_5y_percentage': None, 'roe_percentage': 3.2, 'range_from_52w': 4.27, 'range_to_52w': '10.54', 'perf_ytd_percentage': -0.66, 'dividend': 0.19, 'p_fcf': None, 'eps_past_5y_percentage': -17.2, 'roi_percentage': 6.7, 'high_52w_percentage': -43.17, 'beta': 1.53, 'dividend_percentage': 3.16, 'quick_ratio': 0.9, 'sales_past_5y_percentage': 4.4, 'gross_margin_percentage': 21.1, 'low_52w_percentage': 40.28, 'atr': '0.30', 'employees': 5625.0, 'current_ratio': 1.4, 'sales_q_q_percentage': 15.0, 'oper_margin_percentage': 11.8, 'rsi_14': 47.0, 'volatility_w_percentage': 4.47, 'volatility_m_percentage': 4.7, 'optionable': True, 'debt_eq': 1.16, 'eps_q_q_percentage': None, 'profit_margin_percentage': 1.6, 'rel_volume': '0.27', 'prev_close': '6.04', 'shortable': True, 'lt_debt_eq': 1.12, 'payout_percentage': 89.4, 'avg_volume': 112820.0, 'recom': 2.5, 'sma20_percentage': -0.13, 'sma50_percentage': -8.6, 'sma200_percentage': 0.6, 'short_float_percentage': 0.35, 'short_float_ratio': 1.45, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 6, 12)}, {'ticker': 'BL', 'market_cap': 3820000000.0, 'p_e': None, 'price': 62.83, 'change_percentage': -0.0132, 'volume': 320202.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': -5.87, 'forward_p_e': 54.02, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -11.29, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -4.92, 'sales': 522900000.0, 'p_s': 7.31, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 3.95, 'book_sh': 1.87, 'p_b': 33.6, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -15.23, 'cash_sh': 17.67, 'p_c': 3.56, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -6.6, 'dividend': None, 'p_fcf': 84.96, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -20.7, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 28.93, 'atr': '2.70', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 40.69, 'volatility_w_percentage': 3.78, 'volatility_m_percentage': 4.03, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.65', 'prev_close': '63.67', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -4.93, 'sma50_percentage': -9.6, 'sma200_percentage': -5.44, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 6, 12)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
News, Blogs, Calendar, Insider Trades; 2023-03-27 06:59:02.597490
News, Blogs, Calendar, Insider Trades; 2023-03-27 07:59:03.294796
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type double precision: "-"
LINE 1: ....2, 7.5,  -83.64, 1.32, 0.88, NULL,  -58.7, NULL, '-',  -56....
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 573, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type double precision: "-"
LINE 1: ....2, 7.5,  -83.64, 1.32, 0.88, NULL,  -58.7, NULL, '-',  -56....
                                                             ^

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'SI', 'market_cap': 35790000.0, 'p_e': None, 'price': 1.72, 'change_percentage': 0.5221, 'volume': 141494864.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -29.96, 'insider_own_percentage': 0.2, 'shs_outstand': 31660000.0, 'perf_week_percentage': -16.1, 'forward_p_e': 1.72, 'eps_next_y': 1.0, 'insider_trans_percentage': 0.0, 'shs_float': 25710000.0, 'perf_month_percentage': -88.84, 'income': -948700000.0, 'peg': None, 'eps_next_q': -0.06, 'inst_own_percentage': 79.9, 'perf_quarter_percentage': -89.76, 'sales': 327300000.0, 'p_s': 0.11, 'eps_this_y_percentage': 114.5, 'inst_trans_percentage': -1.53, 'short_interest': 19890000.0, 'perf_half_y_percentage': -97.73, 'book_sh': 42.06, 'p_b': 0.04, 'eps_next_y_percentage_percentage': 233.0, 'roa_percentage': 0.6, 'target_price': 4.0, 'perf_year_percentage': -98.8, 'cash_sh': 100.98, 'p_c': 0.02, 'eps_next_5y_percentage': 33.8, 'roe_percentage': 6.9, 'range_from_52w': 1.12, 'range_to_52w': '162.65', 'perf_ytd_percentage': -90.11, 'dividend': None, 'p_fcf': 0.29, 'eps_past_5y_percentage': 50.6, 'roi_percentage': 7.5, 'high_52w_percentage': -98.94, 'beta': 2.53, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': 25.7, 'gross_margin_percentage': None, 'low_52w_percentage': 53.57, 'atr': '1.35', 'employees': 279.0, 'current_ratio': None, 'sales_q_q_percentage': 139.6, 'oper_margin_percentage': 60.9, 'rsi_14': 26.74, 'volatility_w_percentage': 39.85, 'volatility_m_percentage': 31.66, 'optionable': True, 'debt_eq': 0.01, 'eps_q_q_percentage': 45.6, 'profit_margin_percentage': 31.3, 'rel_volume': '9.49', 'prev_close': '1.13', 'shortable': True, 'lt_debt_eq': 0.01, 'payout_percentage': 0.0, 'avg_volume': 16930000.0, 'recom': 4.7, 'sma20_percentage': -67.14, 'sma50_percentage': -85.02, 'sma200_percentage': -96.46, 'short_float_percentage': 77.37, 'short_float_ratio': 1.18, 'earnings_date': datetime.datetime(2023, 1, 17, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'NAAS', 'market_cap': 895170000.0, 'p_e': 0.05, 'price': 5.8, 'change_percentage': 0.3876, 'volume': 2223997.0, 'signals': "['Double Bottom', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 108.69, 'insider_own_percentage': None, 'shs_outstand': 214160000.0, 'perf_week_percentage': 40.78, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 49400000.0, 'perf_month_percentage': 13.73, 'income': -47400000.0, 'peg': 0.0, 'eps_next_q': None, 'inst_own_percentage': 0.3, 'perf_quarter_percentage': 24.73, 'sales': 32580000.0, 'p_s': 27.48, 'eps_this_y_percentage': None, 'inst_trans_percentage': -7.58, 'short_interest': 70000.0, 'perf_half_y_percentage': 13.61, 'book_sh': 0.29, 'p_b': 20.0, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': 34.1, 'cash_sh': 0.39, 'p_c': 14.75, 'eps_next_5y_percentage': 24.57, 'roe_percentage': None, 'range_from_52w': 2.75, 'range_to_52w': '22.45', 'perf_ytd_percentage': 49.1, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 36.1, 'roi_percentage': None, 'high_52w_percentage': -74.16, 'beta': 1.12, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 110.91, 'atr': '0.44', 'employees': 3621.0, 'current_ratio': 3.5, 'sales_q_q_percentage': -95.9, 'oper_margin_percentage': None, 'rsi_14': 63.92, 'volatility_w_percentage': 12.76, 'volatility_m_percentage': 8.97, 'optionable': True, 'debt_eq': 0.02, 'eps_q_q_percentage': 95.2, 'profit_margin_percentage': None, 'rel_volume': '10.51', 'prev_close': '4.18', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 243900.0, 'recom': 3.0, 'sma20_percentage': 26.47, 'sma50_percentage': 15.55, 'sma200_percentage': 8.98, 'short_float_percentage': 0.15, 'short_float_ratio': 0.31, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'PHAR', 'market_cap': 692350000.0, 'p_e': 26.71, 'price': 14.96, 'change_percentage': 0.3274, 'volume': 697428.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 0.56, 'insider_own_percentage': None, 'shs_outstand': 65629999.99999999, 'perf_week_percentage': 38.91, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 65629999.99999999, 'perf_month_percentage': 26.78, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 0.05, 'perf_quarter_percentage': 35.34, 'sales': 205620000.0, 'p_s': 3.37, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': 0.0, 'perf_half_y_percentage': 32.98, 'book_sh': 3.25, 'p_b': 4.6, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': 7.84, 'perf_year_percentage': 87.0, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 6.1, 'range_to_52w': '15.00', 'perf_ytd_percentage': 35.63, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -0.27, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 145.25, 'atr': '1.48', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': -9.3, 'oper_margin_percentage': None, 'rsi_14': 67.34, 'volatility_w_percentage': 24.19, 'volatility_m_percentage': 10.78, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '105.38', 'prev_close': '11.27', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 18210.0, 'recom': None, 'sma20_percentage': 26.95, 'sma50_percentage': 18.69, 'sma200_percentage': 38.78, 'short_float_percentage': 0.0, 'short_float_ratio': 0.05, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'RBOT', 'market_cap': 188900000.0, 'p_e': 39.58, 'price': 1.9, 'change_percentage': 0.2667, 'volume': 2098924.0, 'signals': "['Most Volatile', 'Recent Insider Selling', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 0.05, 'insider_own_percentage': 6.1, 'shs_outstand': 123560000.0, 'perf_week_percentage': -20.5, 'forward_p_e': None, 'eps_next_y': -0.67, 'insider_trans_percentage': 2.68, 'shs_float': 60080000.0, 'perf_month_percentage': -34.26, 'income': 5200000.0, 'peg': None, 'eps_next_q': -0.14, 'inst_own_percentage': 39.0, 'perf_quarter_percentage': 0.53, 'sales': None, 'p_s': None, 'eps_this_y_percentage': 113.8, 'inst_trans_percentage': 0.3, 'short_interest': 5350000.0, 'perf_half_y_percentage': -49.06, 'book_sh': 0.9, 'p_b': 2.11, 'eps_next_y_percentage_percentage': -1750.0, 'roa_percentage': 3.2, 'target_price': 7.75, 'perf_year_percentage': -61.46, 'cash_sh': 1.17, 'p_c': 1.63, 'eps_next_5y_percentage': None, 'roe_percentage': 4.3, 'range_from_52w': 1.36, 'range_to_52w': '5.12', 'perf_ytd_percentage': -5.94, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -62.89, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 14.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 39.71, 'atr': '0.25', 'employees': 213.0, 'current_ratio': 14.3, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 38.15, 'volatility_w_percentage': 23.73, 'volatility_m_percentage': 10.68, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': -149.7, 'profit_margin_percentage': None, 'rel_volume': '5.27', 'prev_close': '1.50', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': 0.0, 'avg_volume': 423570.0, 'recom': 1.7, 'sma20_percentage': -22.78, 'sma50_percentage': -29.71, 'sma200_percentage': -41.54, 'short_float_percentage': 8.91, 'short_float_ratio': 12.63, 'earnings_date': datetime.datetime(2023, 2, 13, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'ECOR', 'market_cap': 20290000.0, 'p_e': None, 'price': 5.34, 'change_percentage': 0.2477, 'volume': 215529.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -4.69, 'insider_own_percentage': 8.9, 'shs_outstand': 4740000.0, 'perf_week_percentage': 62.31, 'forward_p_e': None, 'eps_next_y': -2.6, 'insider_trans_percentage': 260.94, 'shs_float': 220000.0, 'perf_month_percentage': 47.51, 'income': -22200000.0, 'peg': None, 'eps_next_q': -1.0, 'inst_own_percentage': 18.5, 'perf_quarter_percentage': 12.3, 'sales': 8600000.0, 'p_s': 2.36, 'eps_this_y_percentage': -7.4, 'inst_trans_percentage': -17.2, 'short_interest': 80000.0, 'perf_half_y_percentage': -24.4, 'book_sh': 3.6, 'p_b': 1.48, 'eps_next_y_percentage_percentage': 16.1, 'roa_percentage': -71.0, 'target_price': 23.67, 'perf_year_percentage': -43.44, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': -90.2, 'range_from_52w': 2.92, 'range_to_52w': '10.50', 'perf_ytd_percentage': 38.66, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 24.3, 'roi_percentage': -131.2, 'high_52w_percentage': -49.16, 'beta': 1.08, 'dividend_percentage': None, 'quick_ratio': 2.7, 'sales_past_5y_percentage': 60.3, 'gross_margin_percentage': 81.2, 'low_52w_percentage': 82.56, 'atr': '0.43', 'employees': 62.0, 'current_ratio': 3.0, 'sales_q_q_percentage': 73.3, 'oper_margin_percentage': None, 'rsi_14': 71.89, 'volatility_w_percentage': 15.73, 'volatility_m_percentage': 9.25, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -16.4, 'profit_margin_percentage': None, 'rel_volume': '9.81', 'prev_close': '4.28', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 25010.0, 'recom': 2.0, 'sma20_percentage': 52.01, 'sma50_percentage': 21.01, 'sma200_percentage': -11.76, 'short_float_percentage': 36.26, 'short_float_ratio': 3.22, 'earnings_date': datetime.datetime(2023, 3, 8, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'DNMR', 'market_cap': 211890000.0, 'p_e': None, 'price': 2.59, 'change_percentage': 0.23920000000000002, 'volume': 1969532.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -1.62, 'insider_own_percentage': 0.4, 'shs_outstand': 101390000.0, 'perf_week_percentage': 23.92, 'forward_p_e': None, 'eps_next_y': -0.92, 'insider_trans_percentage': -15.49, 'shs_float': 90450000.0, 'perf_month_percentage': 29.5, 'income': -164200000.0, 'peg': None, 'eps_next_q': -0.29, 'inst_own_percentage': 45.1, 'perf_quarter_percentage': 45.51, 'sales': 55600000.0, 'p_s': 3.81, 'eps_this_y_percentage': -516.6, 'inst_trans_percentage': -1.78, 'short_interest': 16710000.0, 'perf_half_y_percentage': -20.55, 'book_sh': 3.87, 'p_b': 0.67, 'eps_next_y_percentage_percentage': 31.3, 'roa_percentage': -20.7, 'target_price': 4.17, 'perf_year_percentage': -56.83, 'cash_sh': 1.21, 'p_c': 2.14, 'eps_next_5y_percentage': None, 'roe_percentage': -35.5, 'range_from_52w': 1.57, 'range_to_52w': '6.78', 'perf_ytd_percentage': 44.69, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -11.4, 'high_52w_percentage': -61.77, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 4.0, 'sales_past_5y_percentage': None, 'gross_margin_percentage': -9.1, 'low_52w_percentage': 64.97, 'atr': '0.24', 'employees': 282.0, 'current_ratio': 5.2, 'sales_q_q_percentage': -22.4, 'oper_margin_percentage': None, 'rsi_14': 59.28, 'volatility_w_percentage': 14.43, 'volatility_m_percentage': 11.56, 'optionable': True, 'debt_eq': 0.73, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '1.48', 'prev_close': '2.09', 'shortable': False, 'lt_debt_eq': 0.73, 'payout_percentage': None, 'avg_volume': 1320000.0, 'recom': 1.7, 'sma20_percentage': 15.65, 'sma50_percentage': 14.34, 'sma200_percentage': -18.24, 'short_float_percentage': 18.48, 'short_float_ratio': 12.63, 'earnings_date': datetime.datetime(2023, 3, 28, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'AGBA', 'market_cap': 118710000.0, 'p_e': None, 'price': 2.44, 'change_percentage': 0.2386, 'volume': 271368.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': -0.08, 'insider_own_percentage': 91.3, 'shs_outstand': 4740000.0, 'perf_week_percentage': 50.62, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 3860000.0, 'perf_month_percentage': 16.19, 'income': -400000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 3.7, 'perf_quarter_percentage': 25.13, 'sales': 11430000.0, 'p_s': 10.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': 0.73, 'short_interest': 50000.0, 'perf_half_y_percentage': -78.54, 'book_sh': 6.39, 'p_b': 0.38, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -1.0, 'target_price': None, 'perf_year_percentage': -77.61, 'cash_sh': 0.0, 'p_c': 1187.06, 'eps_next_5y_percentage': None, 'roe_percentage': -1.3, 'range_from_52w': 1.31, 'range_to_52w': '11.81', 'perf_ytd_percentage': 58.44, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -79.34, 'beta': 0.31, 'dividend_percentage': None, 'quick_ratio': 0.0, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 86.25, 'atr': '0.33', 'employees': None, 'current_ratio': 0.0, 'sales_q_q_percentage': 43.4, 'oper_margin_percentage': None, 'rsi_14': 58.72, 'volatility_w_percentage': 22.36, 'volatility_m_percentage': 16.45, 'optionable': False, 'debt_eq': 0.17, 'eps_q_q_percentage': 330.6, 'profit_margin_percentage': None, 'rel_volume': '2.42', 'prev_close': '1.97', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 111110.0, 'recom': None, 'sma20_percentage': 20.26, 'sma50_percentage': 4.31, 'sma200_percentage': -66.76, 'short_float_percentage': 1.26, 'short_float_ratio': 0.44, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'CCM', 'market_cap': 47800000.0, 'p_e': None, 'price': 1.36, 'change_percentage': 0.2364, 'volume': 13751.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.99, 'insider_own_percentage': 18.0, 'shs_outstand': 43690000.0, 'perf_week_percentage': 11.48, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 23090000.0, 'perf_month_percentage': 16.24, 'income': -43400000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 0.4, 'perf_quarter_percentage': -8.11, 'sales': 64099999.99999999, 'p_s': 0.75, 'eps_this_y_percentage': 12.4, 'inst_trans_percentage': -10.79, 'short_interest': 0.0, 'perf_half_y_percentage': -32.67, 'book_sh': -5.15, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -4.9, 'target_price': None, 'perf_year_percentage': -32.0, 'cash_sh': 0.33, 'p_c': 4.16, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 26.2, 'range_from_52w': 1.03, 'range_to_52w': '2.20', 'perf_ytd_percentage': -17.07, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -0.7, 'roi_percentage': -40.8, 'high_52w_percentage': -38.18, 'beta': -0.21, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 1.3, 'gross_margin_percentage': -33.9, 'low_52w_percentage': 32.04, 'atr': '0.11', 'employees': 972.0, 'current_ratio': 0.7, 'sales_q_q_percentage': 73.9, 'oper_margin_percentage': None, 'rsi_14': 54.08, 'volatility_w_percentage': 5.17, 'volatility_m_percentage': 8.33, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': 11.5, 'profit_margin_percentage': -67.7, 'rel_volume': '5.90', 'prev_close': '1.10', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 2520.0, 'recom': None, 'sma20_percentage': 5.81, 'sma50_percentage': 0.9, 'sma200_percentage': -16.51, 'short_float_percentage': 0.01, 'short_float_ratio': 1.05, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 8, 13)}  ... displaying 10 of 1865 total bound parameter sets ...  {'ticker': 'NEXA', 'market_cap': 799900000.0, 'p_e': 16.15, 'price': 5.99, 'change_percentage': -0.0083, 'volume': 30357.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': 0.37, 'insider_own_percentage': 64.68, 'shs_outstand': 132440000.0, 'perf_week_percentage': 7.73, 'forward_p_e': 9.88, 'eps_next_y': 0.61, 'insider_trans_percentage': 0.0, 'shs_float': 46780000.0, 'perf_month_percentage': -0.5, 'income': 49100000.0, 'peg': None, 'eps_next_q': 0.12, 'inst_own_percentage': 24.2, 'perf_quarter_percentage': 10.52, 'sales': 3030000000.0, 'p_s': 0.26, 'eps_this_y_percentage': -57.1, 'inst_trans_percentage': -0.28, 'short_interest': 160000.0, 'perf_half_y_percentage': 6.02, 'book_sh': 10.89, 'p_b': 0.55, 'eps_next_y_percentage_percentage': -43.68, 'roa_percentage': 1.0, 'target_price': 7.83, 'perf_year_percentage': -33.74, 'cash_sh': 3.86, 'p_c': 1.55, 'eps_next_5y_percentage': None, 'roe_percentage': 3.2, 'range_from_52w': 4.27, 'range_to_52w': '10.54', 'perf_ytd_percentage': -0.66, 'dividend': 0.19, 'p_fcf': None, 'eps_past_5y_percentage': -17.2, 'roi_percentage': 6.7, 'high_52w_percentage': -43.17, 'beta': 1.53, 'dividend_percentage': 3.16, 'quick_ratio': 0.9, 'sales_past_5y_percentage': 4.4, 'gross_margin_percentage': 21.1, 'low_52w_percentage': 40.28, 'atr': '0.30', 'employees': 5625.0, 'current_ratio': 1.4, 'sales_q_q_percentage': 15.0, 'oper_margin_percentage': 11.8, 'rsi_14': 47.0, 'volatility_w_percentage': 4.47, 'volatility_m_percentage': 4.7, 'optionable': True, 'debt_eq': 1.16, 'eps_q_q_percentage': None, 'profit_margin_percentage': 1.6, 'rel_volume': '0.27', 'prev_close': '6.04', 'shortable': True, 'lt_debt_eq': 1.12, 'payout_percentage': 89.4, 'avg_volume': 112820.0, 'recom': 2.5, 'sma20_percentage': -0.13, 'sma50_percentage': -8.6, 'sma200_percentage': 0.6, 'short_float_percentage': 0.35, 'short_float_ratio': 1.45, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 8, 13)}, {'ticker': 'BL', 'market_cap': 3820000000.0, 'p_e': None, 'price': 62.83, 'change_percentage': -0.0132, 'volume': 320202.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': -5.87, 'forward_p_e': 54.02, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -11.29, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -4.92, 'sales': 522900000.0, 'p_s': 7.31, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 3.95, 'book_sh': 1.87, 'p_b': 33.6, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -15.23, 'cash_sh': 17.67, 'p_c': 3.56, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -6.6, 'dividend': None, 'p_fcf': 84.96, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -20.7, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 28.93, 'atr': '2.70', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 40.69, 'volatility_w_percentage': 3.78, 'volatility_m_percentage': 4.03, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.65', 'prev_close': '63.67', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -4.93, 'sma50_percentage': -9.6, 'sma200_percentage': -5.44, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 8, 13)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
News, Blogs, Calendar, Insider Trades; 2023-03-27 08:59:02.790010
News, Blogs, Calendar, Insider Trades; 2023-03-27 09:59:02.428657
All Signal Screener; 2023-03-27 10:09:46.099678
News, Blogs, Calendar, Insider Trades; 2023-03-27 10:59:02.701506
News, Blogs, Calendar, Insider Trades; 2023-03-27 11:59:03.286637
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 573, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'FCNCA', 'market_cap': 8500000000.0, 'p_e': 8.63, 'price': 859.39, 'change_percentage': 0.4752, 'volume': 921651.0, 'signals': "['Top Gainers', 'Unusual Volume']", 'no_of_signals': 2, 'eps_ttm': 67.48, 'insider_own_percentage': 1.1, 'shs_outstand': 14580000.0, 'perf_week_percentage': 53.0, 'forward_p_e': 6.0, 'eps_next_y': 97.1, 'insider_trans_percentage': 8.51, 'shs_float': 12220000.0, 'perf_month_percentage': 16.33, 'income': 1050000000.0, 'peg': None, 'eps_next_q': 20.61, 'inst_own_percentage': 66.1, 'perf_quarter_percentage': 15.89, 'sales': 3410000000.0, 'p_s': 2.49, 'eps_this_y_percentage': 25.1, 'inst_trans_percentage': -8.94, 'short_interest': 190000.0, 'perf_half_y_percentage': 6.34, 'book_sh': 602.26, 'p_b': 0.97, 'eps_next_y_percentage_percentage': 8.52, 'roa_percentage': 1.0, 'target_price': 832.6, 'perf_year_percentage': 25.77, 'cash_sh': 386.43, 'p_c': 1.51, 'eps_next_5y_percentage': None, 'roe_percentage': 11.3, 'range_from_52w': 505.84, 'range_to_52w': '885.38', 'perf_ytd_percentage': 13.45, 'dividend': 3.0, 'p_fcf': 3.33, 'eps_past_5y_percentage': 18.3, 'roi_percentage': 15.4, 'high_52w_percentage': -2.83, 'beta': 0.97, 'dividend_percentage': 0.51, 'quick_ratio': None, 'sales_past_5y_percentage': 25.3, 'gross_margin_percentage': None, 'low_52w_percentage': 70.08, 'atr': '50.40', 'employees': 10375.0, 'current_ratio': None, 'sales_q_q_percentage': 179.6, 'oper_margin_percentage': 67.4, 'rsi_14': 72.32, 'volatility_w_percentage': 5.87, 'volatility_m_percentage': 5.07, 'optionable': True, 'debt_eq': 0.51, 'eps_q_q_percentage': 37.7, 'profit_margin_percentage': 30.7, 'rel_volume': '19.15', 'prev_close': '582.55', 'shortable': True, 'lt_debt_eq': 0.51, 'payout_percentage': 2.8, 'avg_volume': 126890.0, 'recom': 2.4, 'sma20_percentage': 36.72, 'sma50_percentage': 19.7, 'sma200_percentage': 12.84, 'short_float_percentage': 1.55, 'short_float_ratio': 1.49, 'earnings_date': datetime.datetime(2023, 1, 26, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'WISA', 'market_cap': 3700000.0, 'p_e': None, 'price': 2.77, 'change_percentage': 0.4581, 'volume': 2821180.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -105.25, 'insider_own_percentage': 5.5, 'shs_outstand': 1970000.0, 'perf_week_percentage': 35.75, 'forward_p_e': None, 'eps_next_y': -8.36, 'insider_trans_percentage': -47.13, 'shs_float': 1960000.0, 'perf_month_percentage': -32.91, 'income': -15700000.0, 'peg': None, 'eps_next_q': -17.5, 'inst_own_percentage': 14.0, 'perf_quarter_percentage': -70.21, 'sales': 4400000.0, 'p_s': 0.84, 'eps_this_y_percentage': 21.2, 'inst_trans_percentage': -13.33, 'short_interest': 110000.0, 'perf_half_y_percentage': -94.62, 'book_sh': -6.04, 'p_b': None, 'eps_next_y_percentage_percentage': 90.9, 'roa_percentage': -123.8, 'target_price': 5.5, 'perf_year_percentage': -97.71, 'cash_sh': 1.49, 'p_c': 1.28, 'eps_next_5y_percentage': None, 'roe_percentage': -251.1, 'range_from_52w': 1.88, 'range_to_52w': '149.00', 'perf_ytd_percentage': -73.05, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 1203.1, 'high_52w_percentage': -98.05, 'beta': -0.03, 'dividend_percentage': None, 'quick_ratio': 1.1, 'sales_past_5y_percentage': 24.8, 'gross_margin_percentage': 22.1, 'low_52w_percentage': 54.52, 'atr': '0.63', 'employees': 49.0, 'current_ratio': 3.0, 'sales_q_q_percentage': -55.0, 'oper_margin_percentage': None, 'rsi_14': 38.16, 'volatility_w_percentage': 13.39, 'volatility_m_percentage': 12.22, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': 49.0, 'profit_margin_percentage': None, 'rel_volume': '17.60', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 476540.0, 'recom': 2.0, 'sma20_percentage': -20.76, 'sma50_percentage': -56.57, 'sma200_percentage': -92.28, 'short_float_percentage': 5.59, 'short_float_ratio': 0.23, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'SI', 'market_cap': 35790000.0, 'p_e': None, 'price': 2.38, 'change_percentage': 0.3826, 'volume': 84046062.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -29.96, 'insider_own_percentage': 0.2, 'shs_outstand': 31660000.0, 'perf_week_percentage': 35.72, 'forward_p_e': 1.72, 'eps_next_y': 1.0, 'insider_trans_percentage': 0.0, 'shs_float': 25710000.0, 'perf_month_percentage': -84.09, 'income': -948700000.0, 'peg': None, 'eps_next_q': -0.06, 'inst_own_percentage': 79.9, 'perf_quarter_percentage': -86.3, 'sales': 327300000.0, 'p_s': 0.11, 'eps_this_y_percentage': 114.5, 'inst_trans_percentage': -1.53, 'short_interest': 19890000.0, 'perf_half_y_percentage': -96.92, 'book_sh': 42.06, 'p_b': 0.04, 'eps_next_y_percentage_percentage': 233.0, 'roa_percentage': 0.6, 'target_price': 4.0, 'perf_year_percentage': -98.51, 'cash_sh': 100.98, 'p_c': 0.02, 'eps_next_5y_percentage': 33.8, 'roe_percentage': 6.9, 'range_from_52w': 1.1, 'range_to_52w': '162.65', 'perf_ytd_percentage': -86.9, 'dividend': None, 'p_fcf': 0.29, 'eps_past_5y_percentage': 50.6, 'roi_percentage': 7.5, 'high_52w_percentage': -98.6, 'beta': 2.53, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': 25.7, 'gross_margin_percentage': None, 'low_52w_percentage': 107.28, 'atr': '1.31', 'employees': 279.0, 'current_ratio': None, 'sales_q_q_percentage': 139.6, 'oper_margin_percentage': 60.9, 'rsi_14': 30.65, 'volatility_w_percentage': 39.85, 'volatility_m_percentage': 31.66, 'optionable': True, 'debt_eq': 0.01, 'eps_q_q_percentage': 45.6, 'profit_margin_percentage': 31.3, 'rel_volume': '13.18', 'prev_close': '1.72', 'shortable': True, 'lt_debt_eq': 0.01, 'payout_percentage': 0.0, 'avg_volume': 16930000.0, 'recom': 4.7, 'sma20_percentage': -50.48, 'sma50_percentage': -79.77, 'sma200_percentage': -95.26, 'short_float_percentage': 77.37, 'short_float_ratio': 1.18, 'earnings_date': datetime.datetime(2023, 1, 17, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'ALIM', 'market_cap': 10000000.0, 'p_e': None, 'price': 1.76, 'change_percentage': 0.3024, 'volume': 212897.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.64, 'insider_own_percentage': 3.0, 'shs_outstand': 7000000.0, 'perf_week_percentage': 6.71, 'forward_p_e': None, 'eps_next_y': -0.66, 'insider_trans_percentage': 0.0, 'shs_float': 5620000.0, 'perf_month_percentage': -22.39, 'income': -18400000.0, 'peg': None, 'eps_next_q': -0.34, 'inst_own_percentage': 30.6, 'perf_quarter_percentage': -17.27, 'sales': 54100000.0, 'p_s': 0.18, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': 3.28, 'short_interest': 20000.0, 'perf_half_y_percentage': -66.98, 'book_sh': -5.33, 'p_b': None, 'eps_next_y_percentage_percentage': 72.3, 'roa_percentage': -37.0, 'target_price': 6.75, 'perf_year_percentage': -69.93, 'cash_sh': 0.74, 'p_c': 1.82, 'eps_next_5y_percentage': None, 'roe_percentage': 62.2, 'range_from_52w': 1.3, 'range_to_52w': '7.92', 'perf_ytd_percentage': -35.42, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -1.1, 'roi_percentage': 5.3, 'high_52w_percentage': -77.9, 'beta': 1.42, 'dividend_percentage': None, 'quick_ratio': 0.8, 'sales_past_5y_percentage': 11.4, 'gross_margin_percentage': 85.5, 'low_52w_percentage': 34.62, 'atr': '0.23', 'employees': 145.0, 'current_ratio': 0.9, 'sales_q_q_percentage': 11.5, 'oper_margin_percentage': -22.6, 'rsi_14': 45.05, 'volatility_w_percentage': 18.04, 'volatility_m_percentage': 10.13, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.4, 'profit_margin_percentage': -34.1, 'rel_volume': '46.02', 'prev_close': '1.35', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 12140.0, 'recom': 2.3, 'sma20_percentage': -4.29, 'sma50_percentage': -23.96, 'sma200_percentage': -60.24, 'short_float_percentage': 0.4, 'short_float_ratio': 1.85, 'earnings_date': datetime.datetime(2023, 3, 31, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'CMPR', 'market_cap': 817440000.0, 'p_e': None, 'price': 39.71, 'change_percentage': 0.2728, 'volume': 367585.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -10.23, 'insider_own_percentage': 0.4, 'shs_outstand': 26230000.0, 'perf_week_percentage': 20.84, 'forward_p_e': 48.37, 'eps_next_y': 0.65, 'insider_trans_percentage': -37.32, 'shs_float': 22190000.0, 'perf_month_percentage': 21.62, 'income': -267899999.99999997, 'peg': None, 'eps_next_q': -1.12, 'inst_own_percentage': 80.3, 'perf_quarter_percentage': 55.73, 'sales': 2930000000.0, 'p_s': 0.28, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': -0.59, 'short_interest': 1300000.0, 'perf_half_y_percentage': 58.38, 'book_sh': -23.38, 'p_b': None, 'eps_next_y_percentage_percentage': 108.3, 'roa_percentage': -12.8, 'target_price': 51.0, 'perf_year_percentage': -37.24, 'cash_sh': 7.5, 'p_c': 4.16, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 51.5, 'range_from_52w': 18.0, 'range_to_52w': '67.31', 'perf_ytd_percentage': 44.78, 'dividend': None, 'p_fcf': 21.86, 'eps_past_5y_percentage': 1.9, 'roi_percentage': -1.0, 'high_52w_percentage': -40.61, 'beta': 1.64, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 6.2, 'gross_margin_percentage': 46.6, 'low_52w_percentage': 122.08, 'atr': '2.65', 'employees': 15000.0, 'current_ratio': 0.8, 'sales_q_q_percentage': -0.5, 'oper_margin_percentage': -1.4, 'rsi_14': 64.24, 'volatility_w_percentage': 5.45, 'volatility_m_percentage': 5.83, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': -357.2, 'profit_margin_percentage': -9.1, 'rel_volume': '7.61', 'prev_close': '31.20', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 127880.0, 'recom': 1.5, 'sma20_percentage': 15.99, 'sma50_percentage': 16.36, 'sma200_percentage': 25.6, 'short_float_percentage': 5.84, 'short_float_ratio': 10.13, 'earnings_date': datetime.datetime(2023, 1, 25, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'GRRR', 'market_cap': 590470000.0, 'p_e': None, 'price': 10.43, 'change_percentage': 0.24760000000000001, 'volume': 217545.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.16, 'insider_own_percentage': 35.38, 'shs_outstand': 72720000.0, 'perf_week_percentage': 28.59, 'forward_p_e': None, 'eps_next_y': -0.1, 'insider_trans_percentage': 0.0, 'shs_float': 46990000.0, 'perf_month_percentage': 49.71, 'income': -11400000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 14.6, 'perf_quarter_percentage': 165.31, 'sales': 40900000.0, 'p_s': 14.44, 'eps_this_y_percentage': -44.4, 'inst_trans_percentage': -17.2, 'short_interest': 120000.0, 'perf_half_y_percentage': -11.79, 'book_sh': 0.42, 'p_b': 19.9, 'eps_next_y_percentage_percentage': 68.8, 'roa_percentage': None, 'target_price': 13.0, 'perf_year_percentage': 4.38, 'cash_sh': 0.18, 'p_c': 47.62, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 2.62, 'range_to_52w': '51.00', 'perf_ytd_percentage': 29.22, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -10.4, 'high_52w_percentage': -79.45, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 37.9, 'low_52w_percentage': 300.0, 'atr': '0.64', 'employees': 153.0, 'current_ratio': 1.3, 'sales_q_q_percentage': -8.6, 'oper_margin_percentage': None, 'rsi_14': 78.47, 'volatility_w_percentage': 3.36, 'volatility_m_percentage': 5.27, 'optionable': False, 'debt_eq': 1.11, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '3.21', 'prev_close': '8.36', 'shortable': False, 'lt_debt_eq': 0.33, 'payout_percentage': 0.0, 'avg_volume': 177540.0, 'recom': 2.0, 'sma20_percentage': 31.39, 'sma50_percentage': 42.68, 'sma200_percentage': 5.0, 'short_float_percentage': 0.26, 'short_float_ratio': 0.69, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'LOOP', 'market_cap': 96410000.0, 'p_e': None, 'price': 2.37, 'change_percentage': 0.24739999999999998, 'volume': 275690.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.86, 'insider_own_percentage': 0.6, 'shs_outstand': 47420000.0, 'perf_week_percentage': 11.17, 'forward_p_e': None, 'eps_next_y': -0.35, 'insider_trans_percentage': 0.0, 'shs_float': 19710000.0, 'perf_month_percentage': -4.13, 'income': -41000000.0, 'peg': None, 'eps_next_q': -0.15, 'inst_own_percentage': 12.2, 'perf_quarter_percentage': 2.51, 'sales': 200000.0, 'p_s': 482.03, 'eps_this_y_percentage': -11.9, 'inst_trans_percentage': -4.67, 'short_interest': 1370000.0, 'perf_half_y_percentage': -48.86, 'book_sh': 0.6, 'p_b': 3.17, 'eps_next_y_percentage_percentage': 57.8, 'roa_percentage': -88.3, 'target_price': 7.03, 'perf_year_percentage': -74.32, 'cash_sh': 0.42, 'p_c': 4.48, 'eps_next_5y_percentage': None, 'roe_percentage': -117.3, 'range_from_52w': 1.85, 'range_to_52w': '10.69', 'perf_ytd_percentage': -0.92, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -49.6, 'roi_percentage': None, 'high_52w_percentage': -77.85, 'beta': 1.47, 'dividend_percentage': None, 'quick_ratio': 4.4, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 28.35, 'atr': '0.18', 'employees': 81.0, 'current_ratio': 4.4, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 51.12, 'volatility_w_percentage': 7.9, 'volatility_m_percentage': 7.17, 'optionable': True, 'debt_eq': 0.11, 'eps_q_q_percentage': 90.0, 'profit_margin_percentage': None, 'rel_volume': '6.15', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': 0.11, 'payout_percentage': None, 'avg_volume': 117650.0, 'recom': 2.0, 'sma20_percentage': -2.5, 'sma50_percentage': -1.81, 'sma200_percentage': -37.46, 'short_float_percentage': 6.95, 'short_float_ratio': 11.64, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'JNCE', 'market_cap': 79310000.0, 'p_e': None, 'price': 1.86, 'change_percentage': 0.2285, 'volume': 6677260.0, 'signals': "['Most Active', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.99, 'insider_own_percentage': 0.3, 'shs_outstand': 51690000.0, 'perf_week_percentage': 10.78, 'forward_p_e': None, 'eps_next_y': -1.03, 'insider_trans_percentage': 0.58, 'shs_float': 41320000.0, 'perf_month_percentage': 60.87, 'income': -50900000.0, 'peg': None, 'eps_next_q': -0.72, 'inst_own_percentage': 82.5, 'perf_quarter_percentage': 126.13, 'sales': 82000000.0, 'p_s': 0.97, 'eps_this_y_percentage': 45.9, 'inst_trans_percentage': -0.32, 'short_interest': 3180000.0, 'perf_half_y_percentage': -32.23, 'book_sh': 3.54, 'p_b': 0.43, 'eps_next_y_percentage_percentage': 39.8, 'roa_percentage': -26.3, 'target_price': 3.33, 'perf_year_percentage': -72.91, 'cash_sh': 3.61, 'p_c': 0.42, 'eps_next_5y_percentage': None, 'roe_percentage': -30.9, 'range_from_52w': 0.58, 'range_to_52w': '7.94', 'perf_ytd_percentage': 66.67, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -11.4, 'roi_percentage': -28.6, 'high_52w_percentage': -76.7, 'beta': 0.62, 'dividend_percentage': None, 'quick_ratio': 8.4, 'sales_past_5y_percentage': 2.7, 'gross_margin_percentage': None, 'low_52w_percentage': 220.46, 'atr': '0.16', 'employees': 141.0, 'current_ratio': 8.4, 'sales_q_q_percentage': None, 'oper_margin_percentage': -63.7, 'rsi_14': 73.06, 'volatility_w_percentage': 7.07, 'volatility_m_percentage': 10.68, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': 267.1, 'profit_margin_percentage': -62.1, 'rel_volume': '5.71', 'prev_close': '1.51', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 3070000.0, 'recom': 2.7, 'sma20_percentage': 46.57, 'sma50_percentage': 55.61, 'sma200_percentage': -14.66, 'short_float_percentage': 7.7, 'short_float_ratio': 1.04, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 12, 11)}  ... displaying 10 of 1663 total bound parameter sets ...  {'ticker': 'BL', 'market_cap': 3820000000.0, 'p_e': None, 'price': 63.0, 'change_percentage': 0.0027, 'volume': 62558.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': -1.38, 'forward_p_e': 54.02, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -11.52, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -4.77, 'sales': 522900000.0, 'p_s': 7.31, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 8.13, 'book_sh': 1.87, 'p_b': 33.6, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -14.63, 'cash_sh': 17.67, 'p_c': 3.56, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -6.53, 'dividend': None, 'p_fcf': 84.96, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -20.64, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 29.04, 'atr': '2.63', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 40.84, 'volatility_w_percentage': 3.78, 'volatility_m_percentage': 4.03, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.33', 'prev_close': '62.83', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -4.26, 'sma50_percentage': -9.3, 'sma200_percentage': -5.25, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 12, 11)}, {'ticker': 'SMB', 'market_cap': None, 'p_e': None, 'price': 16.91, 'change_percentage': -0.0003, 'volume': 10504.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.24, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 1.14, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.18, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 1.87, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -1.28, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 16.49, 'range_to_52w': '17.18', 'perf_ytd_percentage': 0.3, 'dividend': 0.24, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.46, 'beta': None, 'dividend_percentage': 1.39, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 2.67, 'atr': '0.05', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 61.52, 'volatility_w_percentage': 0.29, 'volatility_m_percentage': 0.24, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.17', 'prev_close': '16.92', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 163340.0, 'recom': None, 'sma20_percentage': 0.72, 'sma50_percentage': 0.18, 'sma200_percentage': 0.32, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 12, 11)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
News, Blogs, Calendar, Insider Trades; 2023-03-27 12:59:03.439051
News, Blogs, Calendar, Insider Trades; 2023-03-27 13:59:03.206502
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 573, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'WISA', 'market_cap': 3700000.0, 'p_e': None, 'price': 3.92, 'change_percentage': 1.0631, 'volume': 31978058.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -105.25, 'insider_own_percentage': 5.5, 'shs_outstand': 1970000.0, 'perf_week_percentage': 76.17, 'forward_p_e': None, 'eps_next_y': -8.36, 'insider_trans_percentage': -47.13, 'shs_float': 1960000.0, 'perf_month_percentage': -12.93, 'income': -15700000.0, 'peg': None, 'eps_next_q': -17.5, 'inst_own_percentage': 14.0, 'perf_quarter_percentage': -61.33, 'sales': 4400000.0, 'p_s': 0.84, 'eps_this_y_percentage': 21.2, 'inst_trans_percentage': -13.33, 'short_interest': 110000.0, 'perf_half_y_percentage': -93.02, 'book_sh': -6.04, 'p_b': None, 'eps_next_y_percentage_percentage': 90.9, 'roa_percentage': -123.8, 'target_price': 5.5, 'perf_year_percentage': -97.03, 'cash_sh': 1.49, 'p_c': 1.28, 'eps_next_5y_percentage': None, 'roe_percentage': -251.1, 'range_from_52w': 1.88, 'range_to_52w': '149.00', 'perf_ytd_percentage': -65.03, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 1203.1, 'high_52w_percentage': -97.47, 'beta': -0.03, 'dividend_percentage': None, 'quick_ratio': 1.1, 'sales_past_5y_percentage': 24.8, 'gross_margin_percentage': 22.1, 'low_52w_percentage': 100.53, 'atr': '0.73', 'employees': 49.0, 'current_ratio': 3.0, 'sales_q_q_percentage': -55.0, 'oper_margin_percentage': None, 'rsi_14': 46.55, 'volatility_w_percentage': 13.39, 'volatility_m_percentage': 12.22, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': 49.0, 'profit_margin_percentage': None, 'rel_volume': '101.36', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 476540.0, 'recom': 2.0, 'sma20_percentage': 2.84, 'sma50_percentage': -43.63, 'sma200_percentage': -89.98, 'short_float_percentage': 5.59, 'short_float_ratio': 0.23, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'COMS', 'market_cap': 5110000.0, 'p_e': None, 'price': 2.96, 'change_percentage': 0.6001, 'volume': 3326139.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -191.84, 'insider_own_percentage': 9.11, 'shs_outstand': 2680000.0, 'perf_week_percentage': 40.31, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': 0.0, 'shs_float': 2560000.0, 'perf_month_percentage': -20.0, 'income': -156600000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 3.1, 'perf_quarter_percentage': -63.19, 'sales': 10800000.0, 'p_s': 0.47, 'eps_this_y_percentage': 10.6, 'inst_trans_percentage': None, 'short_interest': 90000.0, 'perf_half_y_percentage': -69.2, 'book_sh': 14.89, 'p_b': 0.12, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -213.0, 'target_price': None, 'perf_year_percentage': -96.65, 'cash_sh': 0.18, 'p_c': 10.21, 'eps_next_5y_percentage': None, 'roe_percentage': -490.6, 'range_from_52w': 1.78, 'range_to_52w': '95.00', 'perf_ytd_percentage': -62.52, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 9.9, 'roi_percentage': -202.6, 'high_52w_percentage': -97.18, 'beta': 2.16, 'dividend_percentage': None, 'quick_ratio': 0.3, 'sales_past_5y_percentage': 53.8, 'gross_margin_percentage': 25.2, 'low_52w_percentage': 50.56, 'atr': '0.48', 'employees': 144.0, 'current_ratio': 0.6, 'sales_q_q_percentage': 15.2, 'oper_margin_percentage': None, 'rsi_14': 44.79, 'volatility_w_percentage': 6.92, 'volatility_m_percentage': 12.12, 'optionable': True, 'debt_eq': 1.15, 'eps_q_q_percentage': 84.8, 'profit_margin_percentage': None, 'rel_volume': '7.64', 'prev_close': '1.85', 'shortable': False, 'lt_debt_eq': 0.38, 'payout_percentage': None, 'avg_volume': 822920.0, 'recom': 2.0, 'sma20_percentage': 1.32, 'sma50_percentage': -43.23, 'sma200_percentage': -71.7, 'short_float_percentage': 3.61, 'short_float_ratio': 0.11, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'FCNCA', 'market_cap': 8500000000.0, 'p_e': 8.63, 'price': 883.81, 'change_percentage': 0.5171, 'volume': 1194468.0, 'signals': "['New High', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': 67.48, 'insider_own_percentage': 1.1, 'shs_outstand': 14580000.0, 'perf_week_percentage': 57.82, 'forward_p_e': 6.0, 'eps_next_y': 97.1, 'insider_trans_percentage': 8.51, 'shs_float': 12220000.0, 'perf_month_percentage': 20.0, 'income': 1050000000.0, 'peg': None, 'eps_next_q': 20.61, 'inst_own_percentage': 66.1, 'perf_quarter_percentage': 19.54, 'sales': 3410000000.0, 'p_s': 2.49, 'eps_this_y_percentage': 25.1, 'inst_trans_percentage': -8.94, 'short_interest': 190000.0, 'perf_half_y_percentage': 9.69, 'book_sh': 602.26, 'p_b': 0.97, 'eps_next_y_percentage_percentage': 8.52, 'roa_percentage': 1.0, 'target_price': 832.6, 'perf_year_percentage': 29.74, 'cash_sh': 386.43, 'p_c': 1.51, 'eps_next_5y_percentage': None, 'roe_percentage': 11.3, 'range_from_52w': 505.84, 'range_to_52w': '885.38', 'perf_ytd_percentage': 17.03, 'dividend': 3.0, 'p_fcf': 3.33, 'eps_past_5y_percentage': 18.3, 'roi_percentage': 15.4, 'high_52w_percentage': 0.24, 'beta': 0.97, 'dividend_percentage': 0.51, 'quick_ratio': None, 'sales_past_5y_percentage': 25.3, 'gross_margin_percentage': None, 'low_52w_percentage': 75.45, 'atr': '51.66', 'employees': 10375.0, 'current_ratio': None, 'sales_q_q_percentage': 179.6, 'oper_margin_percentage': 67.4, 'rsi_14': 73.78, 'volatility_w_percentage': 5.87, 'volatility_m_percentage': 5.07, 'optionable': True, 'debt_eq': 0.51, 'eps_q_q_percentage': 37.7, 'profit_margin_percentage': 30.7, 'rel_volume': '14.12', 'prev_close': '582.55', 'shortable': True, 'lt_debt_eq': 0.51, 'payout_percentage': 2.8, 'avg_volume': 126890.0, 'recom': 2.4, 'sma20_percentage': 41.03, 'sma50_percentage': 23.48, 'sma200_percentage': 16.4, 'short_float_percentage': 1.55, 'short_float_ratio': 1.49, 'earnings_date': datetime.datetime(2023, 1, 26, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'GRRR', 'market_cap': 590470000.0, 'p_e': None, 'price': 11.58, 'change_percentage': 0.38520000000000004, 'volume': 529625.0, 'signals': "['Most Volatile', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -0.16, 'insider_own_percentage': 35.38, 'shs_outstand': 72720000.0, 'perf_week_percentage': 40.61, 'forward_p_e': None, 'eps_next_y': -0.1, 'insider_trans_percentage': 0.0, 'shs_float': 46990000.0, 'perf_month_percentage': 63.71, 'income': -11400000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 14.6, 'perf_quarter_percentage': 190.13, 'sales': 40900000.0, 'p_s': 14.44, 'eps_this_y_percentage': -44.4, 'inst_trans_percentage': -17.2, 'short_interest': 120000.0, 'perf_half_y_percentage': -3.54, 'book_sh': 0.42, 'p_b': 19.9, 'eps_next_y_percentage_percentage': 68.8, 'roa_percentage': None, 'target_price': 13.0, 'perf_year_percentage': 14.14, 'cash_sh': 0.18, 'p_c': 47.62, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 2.62, 'range_to_52w': '51.00', 'perf_ytd_percentage': 41.31, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -10.4, 'high_52w_percentage': -77.53, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 37.9, 'low_52w_percentage': 337.4, 'atr': '0.70', 'employees': 153.0, 'current_ratio': 1.3, 'sales_q_q_percentage': -8.6, 'oper_margin_percentage': None, 'rsi_14': 82.19, 'volatility_w_percentage': 3.36, 'volatility_m_percentage': 5.27, 'optionable': False, 'debt_eq': 1.11, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '4.50', 'prev_close': '8.36', 'shortable': False, 'lt_debt_eq': 0.33, 'payout_percentage': 0.0, 'avg_volume': 177540.0, 'recom': 2.0, 'sma20_percentage': 43.68, 'sma50_percentage': 56.02, 'sma200_percentage': 14.82, 'short_float_percentage': 0.26, 'short_float_ratio': 0.69, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'CMPR', 'market_cap': 817440000.0, 'p_e': None, 'price': 41.72, 'change_percentage': 0.3373, 'volume': 649474.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -10.23, 'insider_own_percentage': 0.4, 'shs_outstand': 26230000.0, 'perf_week_percentage': 26.75, 'forward_p_e': 48.37, 'eps_next_y': 0.65, 'insider_trans_percentage': -37.32, 'shs_float': 22190000.0, 'perf_month_percentage': 27.56, 'income': -267899999.99999997, 'peg': None, 'eps_next_q': -1.12, 'inst_own_percentage': 80.3, 'perf_quarter_percentage': 63.34, 'sales': 2930000000.0, 'p_s': 0.28, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': -0.59, 'short_interest': 1300000.0, 'perf_half_y_percentage': 66.13, 'book_sh': -23.38, 'p_b': None, 'eps_next_y_percentage_percentage': 108.3, 'roa_percentage': -12.8, 'target_price': 51.0, 'perf_year_percentage': -34.18, 'cash_sh': 7.5, 'p_c': 4.16, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 51.5, 'range_from_52w': 18.0, 'range_to_52w': '67.31', 'perf_ytd_percentage': 51.87, 'dividend': None, 'p_fcf': 21.86, 'eps_past_5y_percentage': 1.9, 'roi_percentage': -1.0, 'high_52w_percentage': -37.71, 'beta': 1.64, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 6.2, 'gross_margin_percentage': 46.6, 'low_52w_percentage': 132.94, 'atr': '2.75', 'employees': 15000.0, 'current_ratio': 0.8, 'sales_q_q_percentage': -0.5, 'oper_margin_percentage': -1.4, 'rsi_14': 67.28, 'volatility_w_percentage': 5.45, 'volatility_m_percentage': 5.83, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': -357.2, 'profit_margin_percentage': -9.1, 'rel_volume': '7.62', 'prev_close': '31.20', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 127880.0, 'recom': 1.5, 'sma20_percentage': 21.66, 'sma50_percentage': 22.05, 'sma200_percentage': 31.74, 'short_float_percentage': 5.84, 'short_float_ratio': 10.13, 'earnings_date': datetime.datetime(2023, 1, 25, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'ALIM', 'market_cap': 10000000.0, 'p_e': None, 'price': 1.78, 'change_percentage': 0.3173, 'volume': 420131.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.64, 'insider_own_percentage': 3.0, 'shs_outstand': 7000000.0, 'perf_week_percentage': 8.54, 'forward_p_e': None, 'eps_next_y': -0.66, 'insider_trans_percentage': 0.0, 'shs_float': 5620000.0, 'perf_month_percentage': -21.06, 'income': -18400000.0, 'peg': None, 'eps_next_q': -0.34, 'inst_own_percentage': 30.6, 'perf_quarter_percentage': -15.85, 'sales': 54100000.0, 'p_s': 0.18, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': 3.28, 'short_interest': 20000.0, 'perf_half_y_percentage': -66.42, 'book_sh': -5.33, 'p_b': None, 'eps_next_y_percentage_percentage': 72.3, 'roa_percentage': -37.0, 'target_price': 6.75, 'perf_year_percentage': -69.42, 'cash_sh': 0.74, 'p_c': 1.82, 'eps_next_5y_percentage': None, 'roe_percentage': 62.2, 'range_from_52w': 1.3, 'range_to_52w': '7.92', 'perf_ytd_percentage': -34.32, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -1.1, 'roi_percentage': 5.3, 'high_52w_percentage': -77.53, 'beta': 1.42, 'dividend_percentage': None, 'quick_ratio': 0.8, 'sales_past_5y_percentage': 11.4, 'gross_margin_percentage': 85.5, 'low_52w_percentage': 36.92, 'atr': '0.24', 'employees': 145.0, 'current_ratio': 0.9, 'sales_q_q_percentage': 11.5, 'oper_margin_percentage': -22.6, 'rsi_14': 46.07, 'volatility_w_percentage': 18.04, 'volatility_m_percentage': 10.13, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.4, 'profit_margin_percentage': -34.1, 'rel_volume': '51.57', 'prev_close': '1.35', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 12140.0, 'recom': 2.3, 'sma20_percentage': -2.65, 'sma50_percentage': -22.65, 'sma200_percentage': -59.56, 'short_float_percentage': 0.4, 'short_float_ratio': 1.85, 'earnings_date': datetime.datetime(2023, 3, 31, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'BANL', 'market_cap': 110580000.0, 'p_e': None, 'price': 5.6, 'change_percentage': 0.2698, 'volume': 388758.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': 25070000.0, 'perf_week_percentage': None, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 3820000.0, 'perf_month_percentage': None, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': None, 'sales': 402850000.0, 'p_s': 0.27, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': None, 'book_sh': 0.45, 'p_b': 9.84, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': None, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 4.17, 'range_to_52w': '4.55', 'perf_ytd_percentage': 23.98, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 20.44, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 31.42, 'atr': '0.60', 'employees': 29.0, 'current_ratio': None, 'sales_q_q_percentage': 47.9, 'oper_margin_percentage': None, 'rsi_14': None, 'volatility_w_percentage': None, 'volatility_m_percentage': None, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.5, 'profit_margin_percentage': None, 'rel_volume': '0.79', 'prev_close': '4.41', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 741590.0, 'recom': None, 'sma20_percentage': 24.12, 'sma50_percentage': 24.12, 'sma200_percentage': 24.12, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'PYXS', 'market_cap': 67690000.0, 'p_e': None, 'price': 2.77, 'change_percentage': 0.2522, 'volume': 29690689.0, 'signals': "['Most Active', 'Most Volatile', 'Recent Insider Buying', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 5, 'eps_ttm': -3.65, 'insider_own_percentage': 11.9, 'shs_outstand': 34800000.0, 'perf_week_percentage': 17.8, 'forward_p_e': None, 'eps_next_y': -2.02, 'insider_trans_percentage': 98.81, 'shs_float': 25860000.0, 'perf_month_percentage': 23.01, 'income': -120700000.0, 'peg': None, 'eps_next_q': -0.89, 'inst_own_percentage': 55.4, 'perf_quarter_percentage': 129.75, 'sales': None, 'p_s': None, 'eps_this_y_percentage': -55.0, 'inst_trans_percentage': -3.39, 'short_interest': 80000.0, 'perf_half_y_percentage': 44.04, 'book_sh': 4.62, 'p_b': 0.48, 'eps_next_y_percentage_percentage': 15.6, 'roa_percentage': -51.9, 'target_price': 10.75, 'perf_year_percentage': -41.23, 'cash_sh': 5.85, 'p_c': 0.38, 'eps_next_5y_percentage': None, 'roe_percentage': -60.7, 'range_from_52w': 1.1, 'range_to_52w': '5.00', 'perf_ytd_percentage': 107.46, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -44.4, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 5.9, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 152.73, 'atr': '0.34', 'employees': 75.0, 'current_ratio': 5.9, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 63.18, 'volatility_w_percentage': 15.77, 'volatility_m_percentage': 12.9, 'optionable': False, 'debt_eq': 0.0, 'eps_q_q_percentage': -89.2, 'profit_margin_percentage': None, 'rel_volume': '292.01', 'prev_close': '2.21', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 151590.0, 'recom': 1.8, 'sma20_percentage': 27.32, 'sma50_percentage': 49.86, 'sma200_percentage': 38.13, 'short_float_percentage': 0.31, 'short_float_ratio': 0.53, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 14, 12)}  ... displaying 10 of 1758 total bound parameter sets ...  {'ticker': 'BL', 'market_cap': 3820000000.0, 'p_e': None, 'price': 63.71, 'change_percentage': 0.013999999999999999, 'volume': 120577.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': -0.1, 'forward_p_e': 54.02, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -10.38, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -3.54, 'sales': 522900000.0, 'p_s': 7.31, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 9.54, 'book_sh': 1.87, 'p_b': 33.6, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -13.53, 'cash_sh': 17.67, 'p_c': 3.56, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -5.31, 'dividend': None, 'p_fcf': 84.96, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -19.61, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 30.71, 'atr': '2.63', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 43.22, 'volatility_w_percentage': 3.78, 'volatility_m_percentage': 4.03, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.36', 'prev_close': '62.83', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -3.02, 'sma50_percentage': -8.13, 'sma200_percentage': -4.02, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 14, 12)}, {'ticker': 'SMB', 'market_cap': None, 'p_e': None, 'price': 16.91, 'change_percentage': -0.0006, 'volume': 27728.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.09, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 0.99, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.03, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 1.71, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -1.43, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 16.49, 'range_to_52w': '17.18', 'perf_ytd_percentage': 0.15, 'dividend': 0.24, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.6, 'beta': None, 'dividend_percentage': 1.39, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 2.52, 'atr': '0.05', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 57.94, 'volatility_w_percentage': 0.29, 'volatility_m_percentage': 0.24, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.24', 'prev_close': '16.92', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 163340.0, 'recom': None, 'sma20_percentage': 0.57, 'sma50_percentage': 0.03, 'sma200_percentage': 0.17, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 14, 12)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
News, Blogs, Calendar, Insider Trades; 2023-03-27 14:59:02.806280
News, Blogs, Calendar, Insider Trades; 2023-03-27 15:59:02.468947
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 573, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(ASGI) is not present in table "ticker_info".

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'WISA', 'market_cap': 3700000.0, 'p_e': None, 'price': 3.62, 'change_percentage': 0.9053, 'volume': 44993733.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -105.25, 'insider_own_percentage': 5.5, 'shs_outstand': 1970000.0, 'perf_week_percentage': 70.56, 'forward_p_e': None, 'eps_next_y': -8.36, 'insider_trans_percentage': -47.13, 'shs_float': 1960000.0, 'perf_month_percentage': -15.7, 'income': -15700000.0, 'peg': None, 'eps_next_q': -17.5, 'inst_own_percentage': 14.0, 'perf_quarter_percentage': -62.56, 'sales': 4400000.0, 'p_s': 0.84, 'eps_this_y_percentage': 21.2, 'inst_trans_percentage': -13.33, 'short_interest': 110000.0, 'perf_half_y_percentage': -93.24, 'book_sh': -6.04, 'p_b': None, 'eps_next_y_percentage_percentage': 90.9, 'roa_percentage': -123.8, 'target_price': 5.5, 'perf_year_percentage': -97.13, 'cash_sh': 1.49, 'p_c': 1.28, 'eps_next_5y_percentage': None, 'roe_percentage': -251.1, 'range_from_52w': 1.88, 'range_to_52w': '149.00', 'perf_ytd_percentage': -66.14, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 1203.1, 'high_52w_percentage': -97.55, 'beta': -0.03, 'dividend_percentage': None, 'quick_ratio': 1.1, 'sales_past_5y_percentage': 24.8, 'gross_margin_percentage': 22.1, 'low_52w_percentage': 94.15, 'atr': '0.73', 'employees': 49.0, 'current_ratio': 3.0, 'sales_q_q_percentage': -55.0, 'oper_margin_percentage': None, 'rsi_14': 45.53, 'volatility_w_percentage': 13.39, 'volatility_m_percentage': 12.22, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': 49.0, 'profit_margin_percentage': None, 'rel_volume': '98.15', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 476540.0, 'recom': 2.0, 'sma20_percentage': -0.44, 'sma50_percentage': -45.43, 'sma200_percentage': -90.3, 'short_float_percentage': 5.59, 'short_float_ratio': 0.23, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'FCNCA', 'market_cap': 8500000000.0, 'p_e': 8.63, 'price': 907.07, 'change_percentage': 0.5571, 'volume': 1565255.0, 'signals': "['Major News', 'New High', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 67.48, 'insider_own_percentage': 1.1, 'shs_outstand': 14580000.0, 'perf_week_percentage': 60.98, 'forward_p_e': 6.0, 'eps_next_y': 97.1, 'insider_trans_percentage': 8.51, 'shs_float': 12220000.0, 'perf_month_percentage': 22.41, 'income': 1050000000.0, 'peg': None, 'eps_next_q': 20.61, 'inst_own_percentage': 66.1, 'perf_quarter_percentage': 21.94, 'sales': 3410000000.0, 'p_s': 2.49, 'eps_this_y_percentage': 25.1, 'inst_trans_percentage': -8.94, 'short_interest': 190000.0, 'perf_half_y_percentage': 11.89, 'book_sh': 602.26, 'p_b': 0.97, 'eps_next_y_percentage_percentage': 8.52, 'roa_percentage': 1.0, 'target_price': 832.6, 'perf_year_percentage': 32.34, 'cash_sh': 386.43, 'p_c': 1.51, 'eps_next_5y_percentage': None, 'roe_percentage': 11.3, 'range_from_52w': 505.84, 'range_to_52w': '885.38', 'perf_ytd_percentage': 19.37, 'dividend': 3.0, 'p_fcf': 3.33, 'eps_past_5y_percentage': 18.3, 'roi_percentage': 15.4, 'high_52w_percentage': 2.25, 'beta': 0.97, 'dividend_percentage': 0.51, 'quick_ratio': None, 'sales_past_5y_percentage': 25.3, 'gross_margin_percentage': None, 'low_52w_percentage': 78.96, 'atr': '53.25', 'employees': 10375.0, 'current_ratio': None, 'sales_q_q_percentage': 179.6, 'oper_margin_percentage': 67.4, 'rsi_14': 74.65, 'volatility_w_percentage': 5.87, 'volatility_m_percentage': 5.07, 'optionable': True, 'debt_eq': 0.51, 'eps_q_q_percentage': 37.7, 'profit_margin_percentage': 30.7, 'rel_volume': '12.91', 'prev_close': '582.55', 'shortable': True, 'lt_debt_eq': 0.51, 'payout_percentage': 2.8, 'avg_volume': 126890.0, 'recom': 2.4, 'sma20_percentage': 43.85, 'sma50_percentage': 25.95, 'sma200_percentage': 18.73, 'short_float_percentage': 1.55, 'short_float_ratio': 1.49, 'earnings_date': datetime.datetime(2023, 1, 26, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'BANL', 'market_cap': 110580000.0, 'p_e': None, 'price': 6.1, 'change_percentage': 0.3832, 'volume': 732820.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': 25070000.0, 'perf_week_percentage': None, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 3820000.0, 'perf_month_percentage': None, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': None, 'sales': 402850000.0, 'p_s': 0.27, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': None, 'book_sh': 0.45, 'p_b': 9.84, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': None, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 4.17, 'range_to_52w': '4.55', 'perf_ytd_percentage': 41.4, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 37.36, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 49.88, 'atr': '1.04', 'employees': 29.0, 'current_ratio': None, 'sales_q_q_percentage': 47.9, 'oper_margin_percentage': None, 'rsi_14': None, 'volatility_w_percentage': None, 'volatility_m_percentage': None, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.5, 'profit_margin_percentage': None, 'rel_volume': '1.03', 'prev_close': '4.41', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 741590.0, 'recom': None, 'sma20_percentage': 41.56, 'sma50_percentage': 41.56, 'sma200_percentage': 41.56, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'CMPR', 'market_cap': 817440000.0, 'p_e': None, 'price': 42.61, 'change_percentage': 0.36579999999999996, 'volume': 941026.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -10.23, 'insider_own_percentage': 0.4, 'shs_outstand': 26230000.0, 'perf_week_percentage': 26.96, 'forward_p_e': 48.37, 'eps_next_y': 0.65, 'insider_trans_percentage': -37.32, 'shs_float': 22190000.0, 'perf_month_percentage': 27.78, 'income': -267899999.99999997, 'peg': None, 'eps_next_q': -1.12, 'inst_own_percentage': 80.3, 'perf_quarter_percentage': 63.62, 'sales': 2930000000.0, 'p_s': 0.28, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': -0.59, 'short_interest': 1300000.0, 'perf_half_y_percentage': 66.4, 'book_sh': -23.38, 'p_b': None, 'eps_next_y_percentage_percentage': 108.3, 'roa_percentage': -12.8, 'target_price': 51.0, 'perf_year_percentage': -34.07, 'cash_sh': 7.5, 'p_c': 4.16, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 51.5, 'range_from_52w': 18.0, 'range_to_52w': '67.31', 'perf_ytd_percentage': 52.12, 'dividend': None, 'p_fcf': 21.86, 'eps_past_5y_percentage': 1.9, 'roi_percentage': -1.0, 'high_52w_percentage': -37.6, 'beta': 1.64, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 6.2, 'gross_margin_percentage': 46.6, 'low_52w_percentage': 133.33, 'atr': '2.87', 'employees': 15000.0, 'current_ratio': 0.8, 'sales_q_q_percentage': -0.5, 'oper_margin_percentage': -1.4, 'rsi_14': 67.38, 'volatility_w_percentage': 5.45, 'volatility_m_percentage': 5.83, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': -357.2, 'profit_margin_percentage': -9.1, 'rel_volume': '7.76', 'prev_close': '31.20', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 127880.0, 'recom': 1.5, 'sma20_percentage': 21.87, 'sma50_percentage': 22.25, 'sma200_percentage': 31.96, 'short_float_percentage': 5.84, 'short_float_ratio': 10.13, 'earnings_date': datetime.datetime(2023, 1, 25, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'ALIM', 'market_cap': 10000000.0, 'p_e': None, 'price': 1.83, 'change_percentage': 0.3543, 'volume': 501280.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.64, 'insider_own_percentage': 3.0, 'shs_outstand': 7000000.0, 'perf_week_percentage': 12.2, 'forward_p_e': None, 'eps_next_y': -0.66, 'insider_trans_percentage': 0.0, 'shs_float': 5620000.0, 'perf_month_percentage': -18.4, 'income': -18400000.0, 'peg': None, 'eps_next_q': -0.34, 'inst_own_percentage': 30.6, 'perf_quarter_percentage': -13.01, 'sales': 54100000.0, 'p_s': 0.18, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': 3.28, 'short_interest': 20000.0, 'perf_half_y_percentage': -65.28, 'book_sh': -5.33, 'p_b': None, 'eps_next_y_percentage_percentage': 72.3, 'roa_percentage': -37.0, 'target_price': 6.75, 'perf_year_percentage': -68.38, 'cash_sh': 0.74, 'p_c': 1.82, 'eps_next_5y_percentage': None, 'roe_percentage': 62.2, 'range_from_52w': 1.3, 'range_to_52w': '7.92', 'perf_ytd_percentage': -32.1, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -1.1, 'roi_percentage': 5.3, 'high_52w_percentage': -76.77, 'beta': 1.42, 'dividend_percentage': None, 'quick_ratio': 0.8, 'sales_past_5y_percentage': 11.4, 'gross_margin_percentage': 85.5, 'low_52w_percentage': 41.54, 'atr': '0.24', 'employees': 145.0, 'current_ratio': 0.9, 'sales_q_q_percentage': 11.5, 'oper_margin_percentage': -22.6, 'rsi_14': 48.01, 'volatility_w_percentage': 18.04, 'volatility_m_percentage': 10.13, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.4, 'profit_margin_percentage': -34.1, 'rel_volume': '43.15', 'prev_close': '1.35', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 12140.0, 'recom': 2.3, 'sma20_percentage': 0.63, 'sma50_percentage': -20.05, 'sma200_percentage': -58.2, 'short_float_percentage': 0.4, 'short_float_ratio': 1.85, 'earnings_date': datetime.datetime(2023, 3, 31, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'GRRR', 'market_cap': 590470000.0, 'p_e': None, 'price': 11.29, 'change_percentage': 0.3508, 'volume': 584965.0, 'signals': "['Most Volatile', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -0.16, 'insider_own_percentage': 35.38, 'shs_outstand': 72720000.0, 'perf_week_percentage': 39.26, 'forward_p_e': None, 'eps_next_y': -0.1, 'insider_trans_percentage': 0.0, 'shs_float': 46990000.0, 'perf_month_percentage': 62.14, 'income': -11400000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 14.6, 'perf_quarter_percentage': 187.34, 'sales': 40900000.0, 'p_s': 14.44, 'eps_this_y_percentage': -44.4, 'inst_trans_percentage': -17.2, 'short_interest': 120000.0, 'perf_half_y_percentage': -4.46, 'book_sh': 0.42, 'p_b': 19.9, 'eps_next_y_percentage_percentage': 68.8, 'roa_percentage': None, 'target_price': 13.0, 'perf_year_percentage': 13.05, 'cash_sh': 0.18, 'p_c': 47.62, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 2.62, 'range_to_52w': '51.00', 'perf_ytd_percentage': 39.95, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -10.4, 'high_52w_percentage': -77.75, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 37.9, 'low_52w_percentage': 333.21, 'atr': '0.70', 'employees': 153.0, 'current_ratio': 1.3, 'sales_q_q_percentage': -8.6, 'oper_margin_percentage': None, 'rsi_14': 81.83, 'volatility_w_percentage': 3.36, 'volatility_m_percentage': 5.27, 'optionable': False, 'debt_eq': 1.11, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '3.43', 'prev_close': '8.36', 'shortable': False, 'lt_debt_eq': 0.33, 'payout_percentage': 0.0, 'avg_volume': 177540.0, 'recom': 2.0, 'sma20_percentage': 42.3, 'sma50_percentage': 54.52, 'sma200_percentage': 13.72, 'short_float_percentage': 0.26, 'short_float_ratio': 0.69, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'BXRX', 'market_cap': 4000000.0, 'p_e': None, 'price': 2.08, 'change_percentage': 0.3387, 'volume': 5454604.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -279.85, 'insider_own_percentage': 0.3, 'shs_outstand': 750000.0, 'perf_week_percentage': 23.46, 'forward_p_e': None, 'eps_next_y': -2.49, 'insider_trans_percentage': 18.35, 'shs_float': 500000.0, 'perf_month_percentage': -10.71, 'income': -58800000.0, 'peg': None, 'eps_next_q': -1.84, 'inst_own_percentage': 7.3, 'perf_quarter_percentage': -27.27, 'sales': 1300000.0, 'p_s': 3.08, 'eps_this_y_percentage': 56.3, 'inst_trans_percentage': 2.17, 'short_interest': 40000.0, 'perf_half_y_percentage': -80.77, 'book_sh': -32.32, 'p_b': None, 'eps_next_y_percentage_percentage': 44.7, 'roa_percentage': -200.7, 'target_price': 24.0, 'perf_year_percentage': -97.5, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': 789.0, 'range_from_52w': 1.25, 'range_to_52w': '80.74', 'perf_ytd_percentage': -37.11, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 332.2, 'high_52w_percentage': -97.52, 'beta': 1.6, 'dividend_percentage': None, 'quick_ratio': 0.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 60.0, 'atr': '0.28', 'employees': 9.0, 'current_ratio': 0.3, 'sales_q_q_percentage': -25.0, 'oper_margin_percentage': None, 'rsi_14': 51.52, 'volatility_w_percentage': 10.09, 'volatility_m_percentage': 12.76, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -102.8, 'profit_margin_percentage': None, 'rel_volume': '3.22', 'prev_close': '1.55', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 1790000.0, 'recom': 3.0, 'sma20_percentage': 17.72, 'sma50_percentage': -20.21, 'sma200_percentage': -84.04, 'short_float_percentage': 8.75, 'short_float_ratio': 0.02, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'LOOP', 'market_cap': 96410000.0, 'p_e': None, 'price': 2.54, 'change_percentage': 0.3368, 'volume': 371047.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.86, 'insider_own_percentage': 0.6, 'shs_outstand': 47420000.0, 'perf_week_percentage': 18.78, 'forward_p_e': None, 'eps_next_y': -0.35, 'insider_trans_percentage': 0.0, 'shs_float': 19710000.0, 'perf_month_percentage': 2.43, 'income': -41000000.0, 'peg': None, 'eps_next_q': -0.15, 'inst_own_percentage': 12.2, 'perf_quarter_percentage': 9.52, 'sales': 200000.0, 'p_s': 482.03, 'eps_this_y_percentage': -11.9, 'inst_trans_percentage': -4.67, 'short_interest': 1370000.0, 'perf_half_y_percentage': -45.36, 'book_sh': 0.6, 'p_b': 3.17, 'eps_next_y_percentage_percentage': 57.8, 'roa_percentage': -88.3, 'target_price': 7.03, 'perf_year_percentage': -72.56, 'cash_sh': 0.42, 'p_c': 4.48, 'eps_next_5y_percentage': None, 'roe_percentage': -117.3, 'range_from_52w': 1.85, 'range_to_52w': '10.69', 'perf_ytd_percentage': 5.86, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -49.6, 'roi_percentage': None, 'high_52w_percentage': -76.33, 'beta': 1.47, 'dividend_percentage': None, 'quick_ratio': 4.4, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 37.13, 'atr': '0.19', 'employees': 81.0, 'current_ratio': 4.4, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 56.01, 'volatility_w_percentage': 7.9, 'volatility_m_percentage': 7.17, 'optionable': True, 'debt_eq': 0.11, 'eps_q_q_percentage': 90.0, 'profit_margin_percentage': None, 'rel_volume': '3.31', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': 0.11, 'payout_percentage': None, 'avg_volume': 117650.0, 'recom': 2.0, 'sma20_percentage': 4.17, 'sma50_percentage': 4.91, 'sma200_percentage': -33.19, 'short_float_percentage': 6.95, 'short_float_ratio': 11.64, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 16, 12)}  ... displaying 10 of 1784 total bound parameter sets ...  {'ticker': 'BL', 'market_cap': 3820000000.0, 'p_e': None, 'price': 63.82, 'change_percentage': 0.0158, 'volume': 170370.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': 0.04, 'forward_p_e': 54.02, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -10.25, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -3.4, 'sales': 522900000.0, 'p_s': 7.31, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 9.69, 'book_sh': 1.87, 'p_b': 33.6, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -13.41, 'cash_sh': 17.67, 'p_c': 3.56, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -5.18, 'dividend': None, 'p_fcf': 84.96, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -19.49, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 30.89, 'atr': '2.63', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 43.48, 'volatility_w_percentage': 3.78, 'volatility_m_percentage': 4.03, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.41', 'prev_close': '62.83', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -2.88, 'sma50_percentage': -8.0, 'sma200_percentage': -3.89, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 16, 12)}, {'ticker': 'SMB', 'market_cap': None, 'p_e': None, 'price': 16.9, 'change_percentage': -0.0006, 'volume': 30362.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.03, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 0.93, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': -0.03, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 1.65, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -1.49, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 16.49, 'range_to_52w': '17.18', 'perf_ytd_percentage': 0.09, 'dividend': 0.24, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.66, 'beta': None, 'dividend_percentage': 1.39, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 2.46, 'atr': '0.05', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 56.26, 'volatility_w_percentage': 0.29, 'volatility_m_percentage': 0.24, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.21', 'prev_close': '16.92', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 163340.0, 'recom': None, 'sma20_percentage': 0.51, 'sma50_percentage': -0.03, 'sma200_percentage': 0.11, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 16, 12)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
News, Blogs, Calendar, Insider Trades; 2023-03-27 16:59:03.107091
News, Blogs, Calendar, Insider Trades; 2023-03-27 17:59:02.709877
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.ForeignKeyViolation: insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(IBLC) is not present in table "ticker_info".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_screeners.py", line 11, in <module>
    get_data.update_screeners()
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 196, in update_screeners
    self.transform_load.transform_load_screener_data(df=signals_df)
  File "/home/naveen/code/financial_data_analysis/scripts/transform_load_data.py", line 576, in transform_load_screener_data
    signals_df.to_sql('all_signal_screener', self.conn, if_exists='append', index=False)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/core/generic.py", line 2987, in to_sql
    return sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 695, in to_sql
    return pandas_sql.to_sql(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1738, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1335, in insert_records
    raise err
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 1325, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 946, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/pandas/io/sql.py", line 853, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1306, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/sql/elements.py", line 332, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 208, in raise_
    raise exception
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 953, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table "all_signal_screener" violates foreign key constraint "all_signal_screener_ticker_fkey"
DETAIL:  Key (ticker)=(IBLC) is not present in table "ticker_info".

[SQL: INSERT INTO all_signal_screener (ticker, market_cap, p_e, price, change_percentage, volume, signals, no_of_signals, eps_ttm, insider_own_percentage, shs_outstand, perf_week_percentage, forward_p_e, eps_next_y, insider_trans_percentage, shs_float, perf_month_percentage, income, peg, eps_next_q, inst_own_percentage, perf_quarter_percentage, sales, p_s, eps_this_y_percentage, inst_trans_percentage, short_interest, perf_half_y_percentage, book_sh, p_b, eps_next_y_percentage_percentage, roa_percentage, target_price, perf_year_percentage, cash_sh, p_c, eps_next_5y_percentage, roe_percentage, range_from_52w, range_to_52w, perf_ytd_percentage, dividend, p_fcf, eps_past_5y_percentage, roi_percentage, high_52w_percentage, beta, dividend_percentage, quick_ratio, sales_past_5y_percentage, gross_margin_percentage, low_52w_percentage, atr, employees, current_ratio, sales_q_q_percentage, oper_margin_percentage, rsi_14, volatility_w_percentage, volatility_m_percentage, optionable, debt_eq, eps_q_q_percentage, profit_margin_percentage, rel_volume, prev_close, shortable, lt_debt_eq, payout_percentage, avg_volume, recom, sma20_percentage, sma50_percentage, sma200_percentage, short_float_percentage, short_float_ratio, earnings_date, earnings_timing, date) VALUES (%(ticker)s, %(market_cap)s, %(p_e)s, %(price)s, %(change_percentage)s, %(volume)s, %(signals)s, %(no_of_signals)s, %(eps_ttm)s, %(insider_own_percentage)s, %(shs_outstand)s, %(perf_week_percentage)s, %(forward_p_e)s, %(eps_next_y)s, %(insider_trans_percentage)s, %(shs_float)s, %(perf_month_percentage)s, %(income)s, %(peg)s, %(eps_next_q)s, %(inst_own_percentage)s, %(perf_quarter_percentage)s, %(sales)s, %(p_s)s, %(eps_this_y_percentage)s, %(inst_trans_percentage)s, %(short_interest)s, %(perf_half_y_percentage)s, %(book_sh)s, %(p_b)s, %(eps_next_y_percentage_percentage)s, %(roa_percentage)s, %(target_price)s, %(perf_year_percentage)s, %(cash_sh)s, %(p_c)s, %(eps_next_5y_percentage)s, %(roe_percentage)s, %(range_from_52w)s, %(range_to_52w)s, %(perf_ytd_percentage)s, %(dividend)s, %(p_fcf)s, %(eps_past_5y_percentage)s, %(roi_percentage)s, %(high_52w_percentage)s, %(beta)s, %(dividend_percentage)s, %(quick_ratio)s, %(sales_past_5y_percentage)s, %(gross_margin_percentage)s, %(low_52w_percentage)s, %(atr)s, %(employees)s, %(current_ratio)s, %(sales_q_q_percentage)s, %(oper_margin_percentage)s, %(rsi_14)s, %(volatility_w_percentage)s, %(volatility_m_percentage)s, %(optionable)s, %(debt_eq)s, %(eps_q_q_percentage)s, %(profit_margin_percentage)s, %(rel_volume)s, %(prev_close)s, %(shortable)s, %(lt_debt_eq)s, %(payout_percentage)s, %(avg_volume)s, %(recom)s, %(sma20_percentage)s, %(sma50_percentage)s, %(sma200_percentage)s, %(short_float_percentage)s, %(short_float_ratio)s, %(earnings_date)s, %(earnings_timing)s, %(date)s)]
[parameters: ({'ticker': 'WISA', 'market_cap': 7020000.0, 'p_e': None, 'price': 3.6, 'change_percentage': 0.8946999999999999, 'volume': 46560910.0, 'signals': "['Most Active', 'Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -105.25, 'insider_own_percentage': 5.5, 'shs_outstand': 1970000.0, 'perf_week_percentage': 68.22, 'forward_p_e': None, 'eps_next_y': -8.36, 'insider_trans_percentage': -47.13, 'shs_float': 1960000.0, 'perf_month_percentage': -16.86, 'income': -15700000.0, 'peg': None, 'eps_next_q': -17.5, 'inst_own_percentage': 14.0, 'perf_quarter_percentage': -63.08, 'sales': 4400000.0, 'p_s': 1.6, 'eps_this_y_percentage': 21.2, 'inst_trans_percentage': -13.33, 'short_interest': 110000.0, 'perf_half_y_percentage': -93.33, 'book_sh': -6.04, 'p_b': None, 'eps_next_y_percentage_percentage': 90.9, 'roa_percentage': -123.8, 'target_price': 5.5, 'perf_year_percentage': -97.17, 'cash_sh': 1.49, 'p_c': 2.42, 'eps_next_5y_percentage': None, 'roe_percentage': -251.1, 'range_from_52w': 1.88, 'range_to_52w': '149.00', 'perf_ytd_percentage': -66.6, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': 1203.1, 'high_52w_percentage': -97.58, 'beta': -0.03, 'dividend_percentage': None, 'quick_ratio': 1.1, 'sales_past_5y_percentage': 24.8, 'gross_margin_percentage': 22.1, 'low_52w_percentage': 91.49, 'atr': '0.73', 'employees': 49.0, 'current_ratio': 3.0, 'sales_q_q_percentage': -55.0, 'oper_margin_percentage': None, 'rsi_14': 45.09, 'volatility_w_percentage': 36.26, 'volatility_m_percentage': 18.05, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': 49.0, 'profit_margin_percentage': None, 'rel_volume': '97.71', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 476540.0, 'recom': 2.0, 'sma20_percentage': -1.8, 'sma50_percentage': -46.18, 'sma200_percentage': -90.43, 'short_float_percentage': 5.59, 'short_float_ratio': 0.23, 'earnings_date': datetime.datetime(2023, 3, 16, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'FCNCA', 'market_cap': 13070000000.0, 'p_e': 13.27, 'price': 895.61, 'change_percentage': 0.5374, 'volume': 1713690.0, 'signals': "['Major News', 'New High', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': 67.48, 'insider_own_percentage': 1.1, 'shs_outstand': 14580000.0, 'perf_week_percentage': 59.26, 'forward_p_e': 9.22, 'eps_next_y': 97.1, 'insider_trans_percentage': 8.51, 'shs_float': 12220000.0, 'perf_month_percentage': 21.1, 'income': 1050000000.0, 'peg': None, 'eps_next_q': 20.61, 'inst_own_percentage': 66.1, 'perf_quarter_percentage': 20.64, 'sales': 3410000000.0, 'p_s': 3.83, 'eps_this_y_percentage': 25.1, 'inst_trans_percentage': -8.94, 'short_interest': 190000.0, 'perf_half_y_percentage': 10.69, 'book_sh': 602.26, 'p_b': 1.49, 'eps_next_y_percentage_percentage': 8.52, 'roa_percentage': 1.0, 'target_price': 832.6, 'perf_year_percentage': 30.92, 'cash_sh': 386.43, 'p_c': 2.32, 'eps_next_5y_percentage': None, 'roe_percentage': 11.3, 'range_from_52w': 505.84, 'range_to_52w': '885.38', 'perf_ytd_percentage': 18.1, 'dividend': 3.0, 'p_fcf': 5.12, 'eps_past_5y_percentage': 18.3, 'roi_percentage': 15.4, 'high_52w_percentage': 1.16, 'beta': 0.97, 'dividend_percentage': 0.33, 'quick_ratio': None, 'sales_past_5y_percentage': 25.3, 'gross_margin_percentage': None, 'low_52w_percentage': 77.05, 'atr': '53.25', 'employees': 10375.0, 'current_ratio': None, 'sales_q_q_percentage': 179.6, 'oper_margin_percentage': 67.4, 'rsi_14': 74.19, 'volatility_w_percentage': 6.0, 'volatility_m_percentage': 5.5, 'optionable': True, 'debt_eq': 0.51, 'eps_q_q_percentage': 37.7, 'profit_margin_percentage': 30.7, 'rel_volume': '13.51', 'prev_close': '582.55', 'shortable': True, 'lt_debt_eq': 0.51, 'payout_percentage': 2.8, 'avg_volume': 126890.0, 'recom': 2.4, 'sma20_percentage': 42.32, 'sma50_percentage': 24.61, 'sma200_percentage': 17.46, 'short_float_percentage': 1.55, 'short_float_ratio': 1.49, 'earnings_date': datetime.datetime(2023, 1, 26, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'GRRR', 'market_cap': 833430000.0, 'p_e': None, 'price': 11.8, 'change_percentage': 0.4115, 'volume': 680744.0, 'signals': "['Most Volatile', 'Overbought', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 4, 'eps_ttm': -0.16, 'insider_own_percentage': 35.38, 'shs_outstand': 72720000.0, 'perf_week_percentage': 44.79, 'forward_p_e': None, 'eps_next_y': -0.1, 'insider_trans_percentage': 0.0, 'shs_float': 46990000.0, 'perf_month_percentage': 68.57, 'income': -11400000.0, 'peg': None, 'eps_next_q': -0.2, 'inst_own_percentage': 14.6, 'perf_quarter_percentage': 198.73, 'sales': 40900000.0, 'p_s': 20.38, 'eps_this_y_percentage': -44.4, 'inst_trans_percentage': -17.2, 'short_interest': 120000.0, 'perf_half_y_percentage': -0.67, 'book_sh': 0.42, 'p_b': 28.1, 'eps_next_y_percentage_percentage': 68.8, 'roa_percentage': None, 'target_price': 13.0, 'perf_year_percentage': 17.53, 'cash_sh': 0.18, 'p_c': 67.21, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 2.62, 'range_to_52w': '51.00', 'perf_ytd_percentage': 45.5, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': -10.4, 'high_52w_percentage': -76.86, 'beta': None, 'dividend_percentage': None, 'quick_ratio': 1.3, 'sales_past_5y_percentage': None, 'gross_margin_percentage': 37.9, 'low_52w_percentage': 350.38, 'atr': '0.70', 'employees': 153.0, 'current_ratio': 1.3, 'sales_q_q_percentage': -8.6, 'oper_margin_percentage': None, 'rsi_14': 83.19, 'volatility_w_percentage': 8.04, 'volatility_m_percentage': 6.51, 'optionable': False, 'debt_eq': 1.11, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '3.83', 'prev_close': '8.36', 'shortable': False, 'lt_debt_eq': 0.33, 'payout_percentage': 0.0, 'avg_volume': 177540.0, 'recom': 2.0, 'sma20_percentage': 47.94, 'sma50_percentage': 60.65, 'sma200_percentage': 18.23, 'short_float_percentage': 0.26, 'short_float_ratio': 0.69, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'BANL', 'market_cap': 153700000.0, 'p_e': None, 'price': 6.13, 'change_percentage': 0.39, 'volume': 826493.0, 'signals': "['Most Volatile', 'New High', 'Top Gainers']", 'no_of_signals': 3, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': 25070000.0, 'perf_week_percentage': None, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 3820000.0, 'perf_month_percentage': None, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': None, 'sales': 402850000.0, 'p_s': 0.38, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': None, 'book_sh': 0.45, 'p_b': 13.68, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': None, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 4.17, 'range_to_52w': '4.55', 'perf_ytd_percentage': 38.69, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': 34.73, 'beta': None, 'dividend_percentage': None, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 47.0, 'atr': '1.04', 'employees': 29.0, 'current_ratio': None, 'sales_q_q_percentage': 47.9, 'oper_margin_percentage': None, 'rsi_14': None, 'volatility_w_percentage': None, 'volatility_m_percentage': None, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.5, 'profit_margin_percentage': None, 'rel_volume': '1.11', 'prev_close': '4.41', 'shortable': False, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 741590.0, 'recom': None, 'sma20_percentage': 38.84, 'sma50_percentage': 38.84, 'sma200_percentage': 38.84, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'ALIM', 'market_cap': 13690000.0, 'p_e': None, 'price': 1.85, 'change_percentage': 0.3691, 'volume': 523287.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -2.64, 'insider_own_percentage': 3.0, 'shs_outstand': 7000000.0, 'perf_week_percentage': 12.8, 'forward_p_e': None, 'eps_next_y': -0.66, 'insider_trans_percentage': 0.0, 'shs_float': 5620000.0, 'perf_month_percentage': -17.96, 'income': -18400000.0, 'peg': None, 'eps_next_q': -0.34, 'inst_own_percentage': 30.6, 'perf_quarter_percentage': -12.54, 'sales': 54100000.0, 'p_s': 0.25, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': 3.28, 'short_interest': 20000.0, 'perf_half_y_percentage': -65.09, 'book_sh': -5.33, 'p_b': None, 'eps_next_y_percentage_percentage': 72.3, 'roa_percentage': -37.0, 'target_price': 6.75, 'perf_year_percentage': -68.21, 'cash_sh': 0.74, 'p_c': 2.49, 'eps_next_5y_percentage': None, 'roe_percentage': 62.2, 'range_from_52w': 1.3, 'range_to_52w': '7.92', 'perf_ytd_percentage': -31.73, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -1.1, 'roi_percentage': 5.3, 'high_52w_percentage': -76.64, 'beta': 1.42, 'dividend_percentage': None, 'quick_ratio': 0.8, 'sales_past_5y_percentage': 11.4, 'gross_margin_percentage': 85.5, 'low_52w_percentage': 42.31, 'atr': '0.24', 'employees': 145.0, 'current_ratio': 0.9, 'sales_q_q_percentage': 11.5, 'oper_margin_percentage': -22.6, 'rsi_14': 48.32, 'volatility_w_percentage': 25.04, 'volatility_m_percentage': 11.58, 'optionable': False, 'debt_eq': None, 'eps_q_q_percentage': -24.4, 'profit_margin_percentage': -34.1, 'rel_volume': '43.11', 'prev_close': '1.35', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 12140.0, 'recom': 2.3, 'sma20_percentage': 1.17, 'sma50_percentage': -19.61, 'sma200_percentage': -57.97, 'short_float_percentage': 0.4, 'short_float_ratio': 1.85, 'earnings_date': datetime.datetime(2023, 3, 31, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'CMPR', 'market_cap': 1100000000.0, 'p_e': None, 'price': 41.8, 'change_percentage': 0.3397, 'volume': 1117840.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -10.23, 'insider_own_percentage': 0.4, 'shs_outstand': 26230000.0, 'perf_week_percentage': 26.36, 'forward_p_e': 64.81, 'eps_next_y': 0.65, 'insider_trans_percentage': -37.32, 'shs_float': 22190000.0, 'perf_month_percentage': 27.17, 'income': -267899999.99999997, 'peg': None, 'eps_next_q': -1.12, 'inst_own_percentage': 80.3, 'perf_quarter_percentage': 62.84, 'sales': 2930000000.0, 'p_s': 0.37, 'eps_this_y_percentage': 36.5, 'inst_trans_percentage': -0.59, 'short_interest': 1300000.0, 'perf_half_y_percentage': 65.61, 'book_sh': -23.38, 'p_b': None, 'eps_next_y_percentage_percentage': 108.3, 'roa_percentage': -12.8, 'target_price': 51.0, 'perf_year_percentage': -34.38, 'cash_sh': 7.5, 'p_c': 5.58, 'eps_next_5y_percentage': 20.0, 'roe_percentage': 51.5, 'range_from_52w': 18.0, 'range_to_52w': '67.31', 'perf_ytd_percentage': 51.39, 'dividend': None, 'p_fcf': 29.28, 'eps_past_5y_percentage': 1.9, 'roi_percentage': -1.0, 'high_52w_percentage': -37.9, 'beta': 1.64, 'dividend_percentage': None, 'quick_ratio': 0.6, 'sales_past_5y_percentage': 6.2, 'gross_margin_percentage': 46.6, 'low_52w_percentage': 132.22, 'atr': '2.87', 'employees': 15000.0, 'current_ratio': 0.8, 'sales_q_q_percentage': -0.5, 'oper_margin_percentage': -1.4, 'rsi_14': 67.1, 'volatility_w_percentage': 11.72, 'volatility_m_percentage': 7.07, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': -357.2, 'profit_margin_percentage': -9.1, 'rel_volume': '8.74', 'prev_close': '31.20', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 127880.0, 'recom': 1.5, 'sma20_percentage': 21.29, 'sma50_percentage': 21.67, 'sma200_percentage': 31.33, 'short_float_percentage': 5.84, 'short_float_ratio': 10.13, 'earnings_date': datetime.datetime(2023, 1, 25, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'LOOP', 'market_cap': 127860000.0, 'p_e': None, 'price': 2.52, 'change_percentage': 0.32630000000000003, 'volume': 419645.0, 'signals': "['Most Volatile', 'Top Gainers', 'Unusual Volume']", 'no_of_signals': 3, 'eps_ttm': -0.86, 'insider_own_percentage': 0.6, 'shs_outstand': 47420000.0, 'perf_week_percentage': 18.31, 'forward_p_e': None, 'eps_next_y': -0.35, 'insider_trans_percentage': 0.0, 'shs_float': 19710000.0, 'perf_month_percentage': 2.02, 'income': -41000000.0, 'peg': None, 'eps_next_q': -0.15, 'inst_own_percentage': 12.2, 'perf_quarter_percentage': 9.09, 'sales': 200000.0, 'p_s': 639.32, 'eps_this_y_percentage': -11.9, 'inst_trans_percentage': -4.67, 'short_interest': 1370000.0, 'perf_half_y_percentage': -45.57, 'book_sh': 0.6, 'p_b': 4.2, 'eps_next_y_percentage_percentage': 57.8, 'roa_percentage': -88.3, 'target_price': 7.03, 'perf_year_percentage': -72.67, 'cash_sh': 0.42, 'p_c': 5.95, 'eps_next_5y_percentage': None, 'roe_percentage': -117.3, 'range_from_52w': 1.85, 'range_to_52w': '10.69', 'perf_ytd_percentage': 5.44, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': -49.6, 'roi_percentage': None, 'high_52w_percentage': -76.43, 'beta': 1.47, 'dividend_percentage': None, 'quick_ratio': 4.4, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 36.59, 'atr': '0.19', 'employees': 81.0, 'current_ratio': 4.4, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 55.73, 'volatility_w_percentage': 12.38, 'volatility_m_percentage': 8.29, 'optionable': True, 'debt_eq': 0.11, 'eps_q_q_percentage': 90.0, 'profit_margin_percentage': None, 'rel_volume': '3.57', 'prev_close': '1.90', 'shortable': True, 'lt_debt_eq': 0.11, 'payout_percentage': None, 'avg_volume': 117650.0, 'recom': 2.0, 'sma20_percentage': 3.76, 'sma50_percentage': 4.49, 'sma200_percentage': -33.45, 'short_float_percentage': 6.95, 'short_float_ratio': 11.64, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'MFH', 'market_cap': 18680000.0, 'p_e': None, 'price': 1.38, 'change_percentage': 0.3066, 'volume': 287429.0, 'signals': "['Most Volatile', 'Top Gainers']", 'no_of_signals': 2, 'eps_ttm': 0.0, 'insider_own_percentage': None, 'shs_outstand': 12860000.0, 'perf_week_percentage': 34.47, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': 12860000.0, 'perf_month_percentage': 63.98, 'income': -7800000.0, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': 0.5, 'perf_quarter_percentage': 83.83, 'sales': 1400000.0, 'p_s': 13.35, 'eps_this_y_percentage': None, 'inst_trans_percentage': -68.4, 'short_interest': 90000.0, 'perf_half_y_percentage': 40.47, 'book_sh': 0.0, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': -118.2, 'target_price': None, 'perf_year_percentage': -39.79, 'cash_sh': 0.01, 'p_c': 93.42, 'eps_next_5y_percentage': None, 'roe_percentage': -134.4, 'range_from_52w': 0.53, 'range_to_52w': '3.24', 'perf_ytd_percentage': 11.54, 'dividend': None, 'p_fcf': None, 'eps_past_5y_percentage': 36.9, 'roi_percentage': -145.4, 'high_52w_percentage': -57.32, 'beta': 1.54, 'dividend_percentage': None, 'quick_ratio': 0.2, 'sales_past_5y_percentage': -60.9, 'gross_margin_percentage': -37.8, 'low_52w_percentage': 159.67, 'atr': '0.21', 'employees': 13.0, 'current_ratio': 0.2, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 62.69, 'volatility_w_percentage': 14.05, 'volatility_m_percentage': 26.57, 'optionable': True, 'debt_eq': 0.0, 'eps_q_q_percentage': 0.0, 'profit_margin_percentage': None, 'rel_volume': '2.37', 'prev_close': '1.06', 'shortable': True, 'lt_debt_eq': 0.0, 'payout_percentage': None, 'avg_volume': 121200.0, 'recom': None, 'sma20_percentage': 28.57, 'sma50_percentage': 30.75, 'sma200_percentage': 43.16, 'short_float_percentage': 0.72, 'short_float_ratio': 0.76, 'earnings_date': datetime.datetime(2022, 12, 29, 0, 0), 'earnings_timing': 'BMO', 'date': datetime.datetime(2023, 3, 27, 18, 11)}  ... displaying 10 of 1789 total bound parameter sets ...  {'ticker': 'BL', 'market_cap': 3880000000.0, 'p_e': None, 'price': 63.81, 'change_percentage': 0.015600000000000001, 'volume': 250024.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': -0.49, 'insider_own_percentage': 1.1, 'shs_outstand': 59890000.0, 'perf_week_percentage': 0.08, 'forward_p_e': 54.87, 'eps_next_y': 1.16, 'insider_trans_percentage': -10.04, 'shs_float': 55090000.0, 'perf_month_percentage': -10.22, 'income': -29400000.0, 'peg': None, 'eps_next_q': 0.16, 'inst_own_percentage': None, 'perf_quarter_percentage': -3.36, 'sales': 522900000.0, 'p_s': 7.43, 'eps_this_y_percentage': 75.0, 'inst_trans_percentage': -3.26, 'short_interest': 4580000.0, 'perf_half_y_percentage': 9.73, 'book_sh': 1.87, 'p_b': 34.12, 'eps_next_y_percentage_percentage': 26.83, 'roa_percentage': -1.6, 'target_price': 68.07, 'perf_year_percentage': -13.37, 'cash_sh': 17.67, 'p_c': 3.61, 'eps_next_5y_percentage': 5.97, 'roe_percentage': -35.1, 'range_from_52w': 48.73, 'range_to_52w': '79.23', 'perf_ytd_percentage': -5.14, 'dividend': None, 'p_fcf': 86.29, 'eps_past_5y_percentage': 4.9, 'roi_percentage': -2.8, 'high_52w_percentage': -19.46, 'beta': 0.89, 'dividend_percentage': None, 'quick_ratio': 3.4, 'sales_past_5y_percentage': 24.4, 'gross_margin_percentage': 75.3, 'low_52w_percentage': 30.95, 'atr': '2.63', 'employees': 1814.0, 'current_ratio': 3.4, 'sales_q_q_percentage': 21.4, 'oper_margin_percentage': -10.7, 'rsi_14': 43.54, 'volatility_w_percentage': 3.26, 'volatility_m_percentage': 4.01, 'optionable': True, 'debt_eq': 12.39, 'eps_q_q_percentage': 130.0, 'profit_margin_percentage': -5.6, 'rel_volume': '0.51', 'prev_close': '62.83', 'shortable': True, 'lt_debt_eq': 12.38, 'payout_percentage': None, 'avg_volume': 487990.0, 'recom': 2.9, 'sma20_percentage': -2.85, 'sma50_percentage': -7.96, 'sma200_percentage': -3.85, 'short_float_percentage': 8.31, 'short_float_ratio': 9.38, 'earnings_date': datetime.datetime(2023, 2, 14, 0, 0), 'earnings_timing': 'AMC', 'date': datetime.datetime(2023, 3, 27, 18, 11)}, {'ticker': 'SMB', 'market_cap': None, 'p_e': None, 'price': 16.9, 'change_percentage': -0.0009, 'volume': 35725.0, 'signals': 'Head & Shoulders Inverse', 'no_of_signals': 1, 'eps_ttm': None, 'insider_own_percentage': None, 'shs_outstand': None, 'perf_week_percentage': 0.06, 'forward_p_e': None, 'eps_next_y': None, 'insider_trans_percentage': None, 'shs_float': None, 'perf_month_percentage': 0.96, 'income': None, 'peg': None, 'eps_next_q': None, 'inst_own_percentage': None, 'perf_quarter_percentage': 0.0, 'sales': None, 'p_s': None, 'eps_this_y_percentage': None, 'inst_trans_percentage': None, 'short_interest': None, 'perf_half_y_percentage': 1.68, 'book_sh': None, 'p_b': None, 'eps_next_y_percentage_percentage': None, 'roa_percentage': None, 'target_price': None, 'perf_year_percentage': -1.46, 'cash_sh': None, 'p_c': None, 'eps_next_5y_percentage': None, 'roe_percentage': None, 'range_from_52w': 16.49, 'range_to_52w': '17.18', 'perf_ytd_percentage': 0.12, 'dividend': 0.24, 'p_fcf': None, 'eps_past_5y_percentage': None, 'roi_percentage': None, 'high_52w_percentage': -1.63, 'beta': None, 'dividend_percentage': 1.39, 'quick_ratio': None, 'sales_past_5y_percentage': None, 'gross_margin_percentage': None, 'low_52w_percentage': 2.49, 'atr': '0.05', 'employees': None, 'current_ratio': None, 'sales_q_q_percentage': None, 'oper_margin_percentage': None, 'rsi_14': 57.09, 'volatility_w_percentage': 0.26, 'volatility_m_percentage': 0.24, 'optionable': True, 'debt_eq': None, 'eps_q_q_percentage': None, 'profit_margin_percentage': None, 'rel_volume': '0.22', 'prev_close': '16.92', 'shortable': True, 'lt_debt_eq': None, 'payout_percentage': None, 'avg_volume': 163340.0, 'recom': None, 'sma20_percentage': 0.54, 'sma50_percentage': 0.0, 'sma200_percentage': 0.14, 'short_float_percentage': None, 'short_float_ratio': None, 'earnings_date': None, 'earnings_timing': None, 'date': datetime.datetime(2023, 3, 27, 18, 11)})]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
News, Blogs, Calendar, Insider Trades; 2023-03-27 18:59:02.762095
News, Blogs, Calendar, Insider Trades; 2023-03-27 19:59:02.363748
Traceback (most recent call last):
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/util.py", line 97, in web_scrap
    website.raise_for_status()
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/requests/models.py", line 1021, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 429 Client Error: Too Many Requests for url: https://finviz.com/quote.ashx?t=TSLA

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/naveen/code/financial_data_analysis/scripts/update_tickerData.py", line 22, in <module>
    get_data.update_ticker_data(ticker=ticker)
  File "/home/naveen/code/financial_data_analysis/scripts/get_data.py", line 50, in update_ticker_data
    tick = quote.finvizfinance(ticker=ticker)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/quote.py", line 61, in __init__
    self.soup = web_scrap(self.quote_url)
  File "/home/naveen/miniconda3/envs/stock_data/lib/python3.10/site-packages/finvizfinance/util.py", line 100, in web_scrap
    raise Exception(err)
Exception: 429 Client Error: Too Many Requests for url: https://finviz.com/quote.ashx?t=TSLA
News, Blogs, Calendar, Insider Trades; 2023-03-27 20:59:03.150892
News, Blogs, Calendar, Insider Trades; 2023-03-27 21:59:03.188134
News, Blogs, Calendar, Insider Trades; 2023-03-27 22:59:03.411750
News, Blogs, Calendar, Insider Trades; 2023-03-27 23:59:03.212857
News, Blogs, Calendar, Insider Trades; 2023-03-28 00:59:02.873592
News, Blogs, Calendar, Insider Trades; 2023-03-28 01:59:02.407788
News, Blogs, Calendar, Insider Trades; 2023-03-28 02:59:03.085227
News, Blogs, Calendar, Insider Trades; 2023-03-28 03:59:02.782516
News, Blogs, Calendar, Insider Trades; 2023-03-28 04:59:02.453226
News, Blogs, Calendar, Insider Trades; 2023-03-28 05:59:03.115084
All Signal Screener; 2023-03-28 06:12:34.404132
News, Blogs, Calendar, Insider Trades; 2023-03-28 06:59:03.093392
News, Blogs, Calendar, Insider Trades; 2023-03-28 07:59:02.823984
All Signal Screener; 2023-03-28 08:12:37.737108
News, Blogs, Calendar, Insider Trades; 2023-03-28 08:59:03.431437
News, Blogs, Calendar, Insider Trades; 2023-03-28 09:59:03.149658
All Signal Screener; 2023-03-28 10:09:20.051789
News, Blogs, Calendar, Insider Trades; 2023-03-28 10:59:02.745019
News, Blogs, Calendar, Insider Trades; 2023-03-28 11:59:02.430499
All Signal Screener; 2023-03-28 12:11:40.776631
News, Blogs, Calendar, Insider Trades; 2023-03-28 12:59:02.428301
News, Blogs, Calendar, Insider Trades; 2023-03-28 13:59:08.010780
News, Blogs, Calendar, Insider Trades; 2023-03-28 14:59:03.128629
News, Blogs, Calendar, Insider Trades; 2023-03-28 15:59:02.617480
All Signal Screener; 2023-03-28 16:28:29.466983
News, Blogs, Calendar, Insider Trades; 2023-03-28 16:59:03.093397
News, Blogs, Calendar, Insider Trades; 2023-03-28 17:59:02.771255
News, Blogs, Calendar, Insider Trades; 2023-03-28 18:59:03.202880
News, Blogs, Calendar, Insider Trades; 2023-03-28 19:59:03.387693
Ticker Data; 2023-03-28 20:40:20.767293
News, Blogs, Calendar, Insider Trades; 2023-03-28 20:59:03.307273
News, Blogs, Calendar, Insider Trades; 2023-03-28 21:59:02.975492
